kiosk_mode:
  mobile_settings:
    hide_header: true
    hide_sidebar: true
views:
  - title: Overview
    path: overview
    type: sections
    style: |
      :host {
        --view-padding: 0 16px !important;   /* left/right margin */
        --lovelace-view-margin: 0 16px !important;  /* fallback for older builds */
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
      }
      bubble-card {
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
        --bubble-icon-opacity: 1 !important;
        --bubble-icon-opacity-active: 1 !important;
        --bubble-icon-opacity-disabled: 1 !important;
      }
      bubble-card .bubble-icon,
      bubble-card .bubble-main-icon-container,
      bubble-card .bubble-main-icon-container ha-icon,
      bubble-card ha-icon,
      bubble-card .is-off .bubble-main-icon,
      bubble-card .is-off .bubble-main-icon-container,
      bubble-card .is-off ha-icon {
        color: white !important;
        fill: white !important;
        opacity: 1 !important;
        filter: none !important;
      }
      bubble-card .is-off .bubble-background,
      bubble-card .is-off .bubble-icon-container {
        background: rgba(255, 255, 255, 0.35) !important;
      }
      hui-view-header,
      hui-section-heading-row,
      hui-section-heading-tile {
        display: none !important;
      }
    sections:
      - type: grid
        cards:
          - type: markdown
            content: '# Home'
            text_only: true
            grid_options:
              columns: full
              rows: 1.25
            card_mod:
              style: |
                ha-card {
                  display: flex;
                  align-items: center;
                  justify-content: flex-end;   /* vertical */
                  padding-bottom: 0;           /* optional */
                  --card-mod-script: |
                    if (window.__bubbleForceWhiteInit) {
                      return;
                    }
                    window.__bubbleForceWhiteInit = true;
                    const styleId = 'bubble-force-white-style';
                    const cssLines = [
                      '.bubble-icon,',
                      '.bubble-main-icon,',
                      '.bubble-main-icon-container,',
                      '.bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.is-off .bubble-icon,',
                      '.is-off .bubble-main-icon,',
                      '.is-off .bubble-main-icon-container,',
                      '.is-off .bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.ha-markdown-element {',
                      '  color: white !important',
                      '}',
                    ];
                    const css = cssLines.join('\n');
                    const touchIcons = (root) => {
                      if (!root) {
                        return;
                      }
                      root.querySelectorAll('.bubble-icon, .bubble-main-icon, .bubble-main-icon-container ha-icon').forEach((icon) => {
                        icon.style.setProperty('color', 'white', 'important');
                        icon.style.setProperty('fill', 'white', 'important');
                        icon.style.setProperty('opacity', '1', 'important');
                        icon.style.removeProperty('filter');
                      });
                    };
                    const applyStyles = (card) => {
                      if (!card) {
                        return;
                      }
                      const root = card.shadowRoot || card;
                      if (!root) {
                        return;
                      }
                      if (!root.getElementById(styleId)) {
                        const style = document.createElement('style');
                        style.id = styleId;
                        style.textContent = css;
                        root.appendChild(style);
                      }
                      touchIcons(root);
                    };
                    const registeredRoots = new Set();
                    const registerRoot = (root) => {
                      if (
                        root &&
                        typeof root.querySelectorAll === 'function' &&
                        !registeredRoots.has(root)
                      ) {
                        registeredRoots.add(root);
                      }
                    };
                    const scan = () => {
                      registeredRoots.forEach((root) => {
                        root.querySelectorAll('bubble-card').forEach(applyStyles);
                        root.querySelectorAll('*').forEach((el) => {
                          if (el.shadowRoot) {
                            registerRoot(el.shadowRoot);
                          }
                        });
                      });
                    };
                    registerRoot(document);
                    registerRoot(document.body);
                    registerRoot(document.documentElement);
                    scan();
                    window.__bubbleForceWhiteInterval = window.setInterval(() => {
                      scan();
                    }, 750);
                }
                ha-markdown {
                  width: 100%;
                  margin: 0;
                   color: white !important;
                }
          - type: custom:swipe-card
            grid_options:
              columns: full
              rows: 1
            parameters:
              slidesPerView: auto
              spaceBetween: 12
              freeMode: true
              freeModeSticky: false
              mousewheel: true
            style: |
              margin-bottom: 10px !important;
            cards:
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: light.lights
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    --lights-color: ${(() => {
                      const light = hass.states[entity];
                      if (!light) {
                        return 'rgba(255, 255, 255, 0.35)';
                      }
                      const state = light.state;
                      if (state === 'off') {
                        return '#1e88e5';
                      }
                      if (state === 'unavailable') {
                        return 'rgba(120, 120, 120, 0.6)';
                      }
                      const attrs = light.attributes || {};
                      const rgb = attrs.rgb_color;
                      if (Array.isArray(rgb) && rgb.length === 3) {
                        const [r, g, b] = rgb;
                        return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                      }
                      const hs = attrs.hs_color;
                      if (Array.isArray(hs) && hs.length === 2) {
                        const hue = hs[0];
                        const sat = (hs[1] || 0) / 100;
                        const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                        const c = brightness * sat;
                        const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                        const m = brightness - c;
                        let r1 = 0;
                        let g1 = 0;
                        let b1 = 0;
                        if (hue >= 0 && hue < 60) {
                          r1 = c;
                          g1 = x;
                        } else if (hue < 120) {
                          r1 = x;
                          g1 = c;
                        } else if (hue < 180) {
                          g1 = c;
                          b1 = x;
                        } else if (hue < 240) {
                          g1 = x;
                          b1 = c;
                        } else if (hue < 300) {
                          r1 = x;
                          b1 = c;
                        } else {
                          r1 = c;
                          b1 = x;
                        }
                        const r = Math.round((r1 + m) * 255);
                        const g = Math.round((g1 + m) * 255);
                        const b = Math.round((b1 + m) * 255);
                        return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                      }
                      const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                      if (temp) {
                        const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                        const kelvin = clamp(temp, 2000, 6500);
                        const t = kelvin / 100;
                        let r;
                        let g;
                        let b;
                        if (t <= 66) {
                          r = 255;
                          g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                        } else {
                          r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                          g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                        }
                        if (t >= 66) {
                          b = 255;
                        } else if (t <= 19) {
                          b = 0;
                        } else {
                          b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                        }
                        return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                      }
                      return 'rgba(255, 255, 255, 0.35)';
                    })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--lights-color) !important;
                  }
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#lights-overview'
                  hold_action:
                    action: none
                icon_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#lights-overview'
                  hold_action:
                    action: none
                show_state: true
                card_mod:
                  style: >
                    :host {
                      width: auto;
                      max-width: 130px;
                      flex: 0 0 auto;
                      margin-bottom: 10px !important;
                      --bubble-icon-color: white;          # primary icon color
                      --bubble-icon-color-active: white;   # when entity is "on"
                      --bubble-icon-color-disabled: white;
                      --bubble-button-spacing: 0px;   /* no gap between icon and text */
                    }

                    .bubble-main-icon-container {
                      background: none !important;
                      box-shadow: none !important;
                      padding: 0 !important;
                      width: auto !important;
                      height: auto !important;
                      pointer-events: none !important;
                    }

                    .bubble-main-icon-container ha-icon {
                      width: 24px;   /* or any size you need */
                      height: 24px;
                      color: white !important;
                    }

                    .bubble-main-icon-container ha-ripple,

                    .bubble-main-icon-container .bubble-icon-feedback-container
                    {
                      display: none !important;   /* remove ripple/feedback layers */
                    }
              - type: custom:bubble-card
                card_type: button
                button_type: state
                entity: alarm_control_panel.aqara_hub_m3_0056_security_system_2
                name: Security
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    --security-color: ${(() => {
                        const colors = {
                          disarmed: '#43a047',
                          armed_home: '#1e88e5',
                          armed_night: '#8e24aa',
                          armed_away: '#e53935',
                          triggered: '#e53935',
                        };
                        return colors[hass.states[entity]?.state] ?? '#546e7a';
                      })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--security-color) !important;
                  }
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: /at-a-glance/security
                icon_action:
                  tap_action:
                    action: navigate
                    navigation_path: /at-a-glance/security
                card_mod:
                  style: >
                    :host {
                      width: auto;
                      max-width: 160px;
                      flex: 0 0 auto;
                      margin-bottom: 10px !important;
                    }

                    .bubble-main-icon-container {
                      background: none !important;
                      box-shadow: none !important;
                      padding: 0 !important;
                      width: auto !important;
                      height: auto !important;
                      pointer-events: none !important;
                    }

                    .bubble-main-icon-container ha-icon {
                      width: 24px;   /* or any size you need */
                      height: 24px;
                      color: white !important;
                    }

                    .bubble-main-icon-container ha-ripple,

                    .bubble-main-icon-container .bubble-icon-feedback-container
                    {
                      display: none !important;   /* remove ripple/feedback layers */
                    }
                show_state: true
              - type: custom:bubble-card
                card_type: button
                button_type: state
                entity: input_text.all_climate_range
                icon: mdi:thermometer
                name: Climate
                show_state: true
                modules:
                  - frosted_glass
                  - get_state_attribute
                get_state_attribute:
                  - entity: input_text.all_climate_range
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    width: auto;
                    max-width: 180px;
                    flex: 0 0 auto;
                    margin-bottom: 10px !important;
                    --climate-color: ${(() => {
                        return hass.states['input_text.all_climate_color']?.state?.trim();
                      })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--climate-color) !important;
                  }

                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#climate-overview'
                  hold_action:
                    action: none
                icon_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#climate-overview'
                  hold_action:
                    action: none
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: binary_sensor.living_room_presence_sensor_occupancy
                name: Occupancy
                icon: mdi:motion-sensor
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    --occupancy-color: ${(() => {
                        const securityEntity = 'alarm_control_panel.aqara_hub_m3_0056_security_system_2';
                        const occState = hass.states[entity]?.state;
                        const securityState = hass.states[securityEntity]?.state;
                        const occupiedStates = ['on', 'detected', 'occupied'];
                        const clearStates = ['off', 'clear', 'standby'];
                        if (clearStates.includes(occState)) {
                          return '#43a047';
                        }
                        if (occupiedStates.includes(occState) && securityState === 'armed_away') {
                          return '#e53935';
                        }
                        if (occupiedStates.includes(occState)) {
                          return '#1e88e5';
                        }
                        if (occState === 'unavailable') {
                          return 'rgba(120, 120, 120, 0.6)';
                        }
                        return '#546e7a';
                      })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--occupancy-color) !important;
                  }
                show_state: true
                card_mod:
                  style: >
                    :host {
                      width: auto;
                      max-width: 150px;
                      flex: 0 0 auto;
                      margin-bottom: 10px !important;
                      --bubble-icon-color: white;          # primary icon color
                      --bubble-icon-color-active: white;   # when entity is "on"
                      --bubble-icon-color-disabled: white;    # when unavailable
                    }

                    .bubble-main-icon-container {
                      background: none !important;
                      box-shadow: none !important;
                      padding: 0 !important;
                      width: auto !important;
                      height: auto !important;
                      pointer-events: none !important;
                    }

                    .bubble-main-icon-container ha-icon {
                      width: 24px;   /* or any size you need */
                      height: 24px;
                      color: white !important;
                    }

                    .bubble-main-icon-container ha-ripple,

                    .bubble-main-icon-container .bubble-icon-feedback-container
                    {
                      display: none !important;   /* remove ripple/feedback layers */
                    }
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: binary_sensor.door_contact_sensors
                name: Doors
                show_state: true
                icon: mdi:motion-sensor
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  ${(() => {
                      const ids = entity?.attributes?.entity_id ?? [];
                      const openCount = ids.filter((id) => hass.states[id]?.state === 'on').length;
                      const subtitle = openCount > 0 ? `${openCount} Open` : 'All Closed';

                      card.querySelector('.bubble-state')?.replaceChildren(subtitle);
                      icon.setAttribute('icon', openCount > 0 ? 'mdi:door-open' : 'mdi:door');
                  })()}
                card_mod:
                  style: >
                    :host {
                      width: auto;
                      max-width: 150px;
                      flex: 0 0 auto;
                      margin-bottom: 10px !important;
                      --bubble-icon-color: white;
                      --bubble-icon-color-active: white;
                      --bubble-icon-color-disabled: white;
                    }

                    .bubble-main-icon-container {
                      background: none !important;
                      box-shadow: none !important;
                      padding: 0 !important;
                      width: auto !important;
                      height: auto !important;
                      pointer-events: none !important;
                    }

                    .bubble-main-icon-container ha-icon {
                      width: 24px;
                      height: 24px;
                      color: white !important;
                    }

                    .bubble-main-icon-container ha-ripple,

                    .bubble-main-icon-container .bubble-icon-feedback-container
                    {
                      display: none !important;
                    }
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: binary_sensor.window_contact_sensors
                name: Windows
                show_state: true
                icon: mdi:motion-sensor
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  ${(() => {
                      const ids = entity?.attributes?.entity_id ?? [];
                      const openCount = ids.filter((id) => hass.states[id]?.state === 'on').length;
                      const subtitle = openCount > 0 ? `${openCount} Open` : 'All Closed';

                      card.querySelector('.bubble-state')?.replaceChildren(subtitle);
                      icon.setAttribute('icon', openCount > 0 ? 'mdi:window-open' : 'mdi:window-closed');
                  })()}
                card_mod:
                  style: >
                    :host {
                      width: auto;
                      max-width: 150px;
                      flex: 0 0 auto;
                      margin-bottom: 10px !important;
                      --bubble-icon-color: white;
                      --bubble-icon-color-active: white;
                      --bubble-icon-color-disabled: white;
                    }

                    .bubble-main-icon-container {
                      background: none !important;
                      box-shadow: none !important;
                      padding: 0 !important;
                      width: auto !important;
                      height: auto !important;
                      pointer-events: none !important;
                    }

                    .bubble-main-icon-container ha-icon {
                      width: 24px;
                      height: 24px;
                      color: white !important;
                    }

                    .bubble-main-icon-container ha-ripple,

                    .bubble-main-icon-container .bubble-icon-feedback-container
                    {
                      display: none !important;
                    }
        column_span: 4
      - type: grid
        cards:
          - type: vertical-stack
            grid_options:
              columns: full
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#lights-overview'
                button_type: name
                show_icon: false
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                  .bubble-pop-up-background {
                    background-color: rgba(25, 36, 54, 0.55) !important;
                    filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.18);
                    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.15),
                        0 15px 40px rgba(0, 0, 0, 0.35);
                  }
              - type: custom:bubble-card
                card_type: separator
                name: House Lights
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button:
                  - entity: light.lights
                    icon: mdi:lightbulb-group
                    name: Toggle All
                    tap_action:
                      action: toggle
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: switch
                    entity: light.important_lights
                    name: Important Lights
                    icon: mdi:lightbulb-group
                    show_state: false
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                    grid_options:
                      columns: 6
                      rows: auto
                  - type: custom:bubble-card
                    card_type: button
                    button_type: switch
                    entity: light.lights
                    name: All Lights
                    icon: mdi:lightbulb-group
                    show_state: true
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                    grid_options:
                      columns: 6
                      rows: auto
                columns: 2
                grid_options:
                  columns: full
              - type: custom:bubble-card
                card_type: separator
                name: Living Room Lights
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button:
                  - entity: light.living_room
                    tap_action:
                      action: toggle
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_11
                    name: Front Left Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_23
                    name: Front Right Light
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_14
                    name: Back Left Light
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_12
                    name: Back Right Light
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                columns: 2
              - type: custom:bubble-card
                card_type: separator
                name: Guest Room Lights
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button:
                  - entity: light.guest_room
                    tap_action:
                      action: toggle
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_8
                    name: TV Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_9
                    name: Bed Light
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                columns: 2
              - type: custom:bubble-card
                card_type: separator
                name: Master Bedroom Lights
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button:
                  - entity: light.master_bedroom
                    tap_action:
                      action: toggle
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_1
                    name: Window Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_3
                    name: Bathroom Light
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_2
                    name: Door Light
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                columns: 2
              - type: custom:bubble-card
                card_type: separator
                name: Gym Light
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button:
                  - entity: light.spare_room
                    tap_action:
                      action: toggle
                    icon: mdi:lightbulb
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_24
                    name: Gym Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                columns: 2
              - type: custom:bubble-card
                card_type: separator
                name: Hallway Lights
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button:
                  - entity: light.hallway
                    tap_action:
                      action: toggle
                    icon: ''
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_19
                    name: Entry Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_1_2
                    name: Gym Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_22
                    name: Guest Room Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_21
                    name: Office Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                columns: 2
              - type: custom:bubble-card
                card_type: separator
                name: Office Light
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button:
                  - entity: light.office
                    tap_action:
                      action: toggle
                    icon: mdi:lightbulb
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_10
                    name: Office Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                columns: 2
              - type: custom:bubble-card
                card_type: separator
                name: Kitchen Lights
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button:
                  - entity: light.kitchen
                    tap_action:
                      action: toggle
                    icon: ''
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_16
                    name: Table Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_18
                    name: Door Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_17
                    name: Counter Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_32
                    name: Sink Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                columns: 2
              - type: custom:bubble-card
                card_type: separator
                name: Dining Room Light
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button:
                  - entity: light.aqara_dimmer_switch_h2_2
                    tap_action:
                      action: toggle
                    icon: ''
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.aqara_dimmer_switch_h2_2
                    name: Dining Room Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                columns: 2
              - type: custom:bubble-card
                card_type: separator
                name: Back Deck Lights
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button:
                  - entity: light.back_deck
                    tap_action:
                      action: toggle
                    icon: ''
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.grill_light_3
                    name: Grill Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.outdoor_dining_room_3
                    name: Couches Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                columns: 2
              - type: custom:bubble-card
                card_type: separator
                name: Music Room Lights
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button:
                  - entity: light.music_room
                    tap_action:
                      action: toggle
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_color_downlight_2
                    name: Fireplace Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_color_downlight_4
                    name: Window Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_color_downlight_1
                    name: Entry Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_color_downlight_3
                    name: Drums Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_color_downlight_5
                    name: Bathroom Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_color_downlight_6
                    name: Couch Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_color_downlight_8
                    name: Server Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_color_downlight_7
                    name: TV Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_play_2
                    name: TV Left Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_play_1
                    name: TV Right Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                columns: 2
              - type: custom:bubble-card
                card_type: separator
                name: Theater Room Lights
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button:
                  - entity: light.theater_room
                    tap_action:
                      action: toggle
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_30
                    name: Front Screen Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_29
                    name: Front Right Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_27
                    name: Front Back Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_28
                    name: Rear Front Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_26
                    name: Rear Back Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_31
                    name: Rear Right Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                columns: 2
              - type: custom:bubble-card
                card_type: separator
                name: Downstairs Hallway Light
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button:
                  - entity: light.downstairs_hallway
                    tap_action:
                      action: toggle
                    icon: mdi:lightbulb
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_25
                    name: Downstairs Hallway Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                columns: 2
              - type: custom:bubble-card
                card_type: separator
                name: Guest Bathroom Light
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button:
                  - entity: light.guest_bathroom_dimmer_switch
                    tap_action:
                      action: toggle
                    icon: mdi:lightbulb
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.guest_bathroom_dimmer_switch
                    name: Guest Bathroom Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                columns: 2
              - type: custom:bubble-card
                card_type: separator
                name: Master Bathroom Light
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button:
                  - entity: light.aqara_dimmer_switch_h2
                    tap_action:
                      action: toggle
                    icon: mdi:lightbulb
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.aqara_dimmer_switch_h2
                    name: Master Bathroom Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                columns: 2
          - type: vertical-stack
            grid_options:
              columns: full
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#climate-overview'
                button_type: name
                show_icon: false
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                  .bubble-pop-up-background {
                    background-color: rgba(25, 36, 54, 0.55) !important;
                    filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.18);
                    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.15),
                        0 15px 40px rgba(0, 0, 0, 0.35);
                  }
              - type: custom:bubble-card
                card_type: separator
                name: Living Room Climate
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button: []
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: >-
                      sensor.hallway_entryway_living_room_presence_sensor_temperature
                    name: Entryway
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.entryway_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                    show_icon: true
                    show_name: true
                    force_icon: false
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.living_room_presence_sensor_temperature
                    name: Living Room
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.living_room_presence_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.living_room_temperature
                    name: Ecobee
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.living_room_ecobee_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                columns: 2
              - type: custom:bubble-card
                card_type: separator
                name: Kitchen Climate
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button: []
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: >-
                      sensor.hallway_entryway_living_room_presence_sensor_temperature
                    name: Entryway
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.entryway_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.kitchen_presence_sensor_temperature
                    name: Kitchen
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.kitchen_presence_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.kitchen_temperature
                    name: Ecobee
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.kitchen_ecobee_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                columns: 2
              - type: custom:bubble-card
                card_type: separator
                name: Master Bedroom Climate
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button: []
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.aqara_presence_multisensor_fp300_temperature_2
                    name: Street Window
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.master_bedroom_window_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.bedroom_temperature
                    name: Ecobee
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.master_bedroom_ecobee_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                columns: 2
              - type: custom:bubble-card
                card_type: separator
                name: Gym Climate
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button: []
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.gym_presence_sensor_temperature
                    name: Gym
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.gym_presence_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.hallway_guest_bath_gym_presence_sensor_temperature
                    name: Gym Door
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.gym_door_guest_bath_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.gym_temperature
                    name: Ecobee
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.gym_ecobee_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                columns: 2
              - type: custom:bubble-card
                card_type: separator
                name: Hallway Climate
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button: []
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: >-
                      sensor.hallway_entryway_living_room_presence_sensor_temperature
                    name: Entryway
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.entryway_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.hallway_guest_bath_gym_presence_sensor_temperature
                    name: Guest Bath
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.gym_door_guest_bath_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.aqara_presence_multisensor_fp300_temperature
                    name: Office
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.office_door_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.home_current_temperature
                    name: Ecobee
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.hallway_ecobee_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                columns: 2
              - type: custom:bubble-card
                card_type: separator
                name: Office Climate
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button: []
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.aqara_presence_multisensor_fp300_temperature
                    name: Office Door
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.office_door_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.office_presence_sensor_temperature
                    name: Office
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.office_presence_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.office_temperature
                    name: Ecobee
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.office_ecobee_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                columns: 2
              - type: custom:bubble-card
                card_type: separator
                name: Dining Room Climate
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button: []
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.dining_room_presence_sensor_temperature
                    name: Dining Room
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.dining_room_presence_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.dining_room_temperature
                    name: Ecobee
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.dining_room_ecobee_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                columns: 2
              - type: custom:bubble-card
                card_type: separator
                name: Guest Room Climate
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button: []
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.guest_room_presence_sensor_temperature
                    name: Guest Room
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.guest_room_presence_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.guest_room_temperature
                    name: Ecobee
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.guest_room_ecobee_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                columns: 2
              - type: custom:bubble-card
                card_type: separator
                name: Music Room Climate
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button: []
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.music_room_temperature
                    name: Ecobee
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.music_room_ecobee_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                columns: 2
              - type: custom:bubble-card
                card_type: separator
                name: Theater Room Climate
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button: []
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.theater_room_temperature
                    name: Ecobee
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.theater_room_ecobee_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                columns: 2
              - type: custom:bubble-card
                card_type: separator
                name: Guest Bathroom Climate
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button: []
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.guest_bathroom_presence_sensor_temperature
                    name: Guest Bathroom
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.guest_bathroom_presence_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.guest_bathroom_temperature
                    name: Ecobee
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.guest_bathroom_ecobee_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                columns: 2
              - type: custom:bubble-card
                card_type: separator
                name: Master Bathroom Climate
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button: []
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.master_bathroom_presense_sensor_temperature
                    name: Master Bathroom
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.master_bathroom_presence_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.master_bathroom_temperature
                    name: Ecobee
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.master_bathroom_ecobee_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                columns: 2
        column_span: 4
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: separator
            name: Security
            card_layout: large
            rows: '01'
            grid_options:
              columns: full
          - type: custom:bubble-card
            card_type: button
            button_type: state
            entity: alarm_control_panel.aqara_hub_m3_0056_security_system_2
            card_layout: large-sub-buttons-grid
            rows: '2'
            sub_button:
              - entity: alarm_control_panel.aqara_hub_m3_0056_security_system_2
                name: Disarm
                icon: mdi:shield-lock-open
                show_name: true
                tap_action:
                  action: perform-action
                  perform_action: alarm_control_panel.alarm_disarm
                  target:
                    entity_id: alarm_control_panel.aqara_hub_m3_0056_security_system_2
              - entity: alarm_control_panel.aqara_hub_m3_0056_security_system_2
                name: Home
                tap_action:
                  action: perform-action
                  perform_action: alarm_control_panel.alarm_arm_home
                  target:
                    entity_id: alarm_control_panel.aqara_hub_m3_0056_security_system_2
                show_name: true
                icon: mdi:home
              - entity: alarm_control_panel.aqara_hub_m3_0056_security_system_2
                name: Away
                icon: mdi:shield
                show_name: true
                tap_action:
                  action: perform-action
                  perform_action: alarm_control_panel.alarm_arm_away
                  target:
                    entity_id: alarm_control_panel.aqara_hub_m3_0056_security_system_2
              - entity: alarm_control_panel.aqara_hub_m3_0056_security_system_2
                name: Night
                icon: mdi:moon-waning-crescent
                show_name: true
                tap_action:
                  action: perform-action
                  perform_action: alarm_control_panel.alarm_arm_night
                  target:
                    entity_id: alarm_control_panel.aqara_hub_m3_0056_security_system_2
            modules:
              - subbutton_below
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              :host {
                --security-color: ${(() => {
                    const colors = {
                      disarmed: '#43a047',
                      armed_home: '#1e88e5',
                      armed_night: '#8e24aa',
                      armed_away: '#e53935',
                      triggered: '#e53935',
                    };
                    return colors[hass.states[entity]?.state] ?? '#546e7a';
                  })()};
              }
              .bubble-background,
              .bubble-icon-container {
                background: var(--security-color) !important;
              }
                                .bubble-main-icon-container {
                                  background: none !important;
                                  box-shadow: none !important;
                                  padding: 0 !important;
                                  width: auto !important;
                                  height: auto !important;
                                  pointer-events: none !important;
                                }
            name: Security System
            grid_options:
              columns: 24
              rows: '2'
        column_span: 4
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: separator
            name: Cameras
            card_layout: large
            rows: '01'
            grid_options:
              columns: full
          - square: true
            type: grid
            cards:
              - type: custom:webrtc-camera-sfenton
                card_id: front-door-primary
                shared: true
                ui: true
                muted: true
                intersection: 0
                digital_ptz:
                  mouse_drag_pan: false
                  mouse_wheel_zoom: false
                  mouse_double_click_zoom: false
                  touch_drag_pan: false
                  touch_pinch_zoom: false
                  touch_tap_drag_zoom: false
                  persist: true
                streams:
                  - url: front_door
                    mode: webrtc,webrtc/tcp,mse,hls,mjpeg
                    media: video,audio
                tap_action:
                  action: navigate
                  navigation_path: '#camera-front-door'
                card_mod:
                  style: |
                    video {
                      width: 100% !important;
                      height: 100% !important;
                      object-fit: cover;
                    }
                    .fullscreen,
                    .screenshot,
                    .header,
                    .volume,
                    .play,
                    .pictureinpicture {
                      display: none !important;
                    }
                    ha-card::after {
                      content: "Front Door";
                      position: absolute;
                      left: 16px;
                      bottom: 16px;
                      font-size: 13px;
                      line-height: 1.2;
                      font-weight: 600;
                      color: white;
                      pointer-events: none;
                    }
              - type: custom:webrtc-camera-sfenton
                card_id: upper-deck-primary
                shared: true
                ui: true
                muted: true
                intersection: 0
                digital_ptz:
                  mouse_drag_pan: false
                  mouse_wheel_zoom: false
                  mouse_double_click_zoom: false
                  touch_drag_pan: false
                  touch_pinch_zoom: false
                  touch_tap_drag_zoom: false
                  persist: true
                streams:
                  - url: upper_deck
                    mode: webrtc,webrtc/tcp,mse,hls,mjpeg
                    media: video,audio
                tap_action:
                  action: navigate
                  navigation_path: '#camera-upper-deck'
                card_mod:
                  style: |
                    video {
                      width: 100% !important;
                      height: 100% !important;
                      object-fit: cover;
                    }
                    .fullscreen,
                    .screenshot,
                    .header,
                    .volume,
                    .play,
                    .pictureinpicture {
                      display: none !important;
                    }
                    ha-card::after {
                      content: "Upper Deck";
                      position: absolute;
                      left: 16px;
                      bottom: 16px;
                      font-size: 13px;
                      line-height: 1.2;
                      font-weight: 600;
                      color: white;
                      pointer-events: none;
                    }
              - type: custom:webrtc-camera-sfenton
                card_id: lower-deck-primary
                shared: true
                ui: true
                muted: true
                intersection: 0
                digital_ptz:
                  mouse_drag_pan: false
                  mouse_wheel_zoom: false
                  mouse_double_click_zoom: false
                  touch_drag_pan: false
                  touch_pinch_zoom: false
                  touch_tap_drag_zoom: false
                  persist: true
                streams:
                  - url: lower_deck
                    mode: webrtc,webrtc/tcp,mse,hls,mjpeg
                    media: video,audio
                tap_action:
                  action: navigate
                  navigation_path: '#camera-lower-deck'
                card_mod:
                  style: |
                    video {
                      width: 100% !important;
                      height: 100% !important;
                      object-fit: cover;
                    }
                    .fullscreen,
                    .screenshot,
                    .header,
                    .volume,
                    .play,
                    .pictureinpicture {
                      display: none !important;
                    }
                    ha-card::after {
                      content: "Lower Deck";
                      position: absolute;
                      left: 16px;
                      bottom: 16px;
                      font-size: 13px;
                      line-height: 1.2;
                      font-weight: 600;
                      color: white;
                      pointer-events: none;
                    }
            columns: 2
          - type: vertical-stack
            grid_options:
              columns: full
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#camera-front-door'
                button_type: name
                show_icon: false
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                  .bubble-pop-up-background {
                    background-color: rgba(25, 36, 54, 0.55) !important;
                    filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.18);
                    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.15),
                        0 15px 40px rgba(0, 0, 0, 0.35);
                  }
              - type: custom:bubble-card
                card_type: separator
                name: Front Door Camera
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button: []
              - square: false
                type: grid
                grid_options:
                  columns: full
                cards:
                  - type: custom:webrtc-camera-sfenton
                    card_id: front-door-popup-home
                    shared: true
                    streams:
                      - url: front_door
                        mode: webrtc,webrtc/tcp,mse,hls,mjpeg
                        media: video,audio
                    style: |
                      ha-card {
                        aspect-ratio: 4 / 3;
                        height: auto;
                      }
                      .fullscreen,
                      .screenshot,
                      .header,
                      .volume,
                      .play,
                      .pictureinpicture {
                        display: none !important;
                      }
                    ui: true
                    digital_ptz:
                      mouse_drag_pan: false
                      mouse_wheel_zoom: false
                      mouse_double_click_zoom: false
                      touch_drag_pan: false
                      touch_pinch_zoom: false
                      touch_tap_drag_zoom: false
                      persist: true
                    muted: true
                    intersection: 0
                columns: 1
                card_mod:
                  style: |
                    .fullscreen,
                    .screenshot,
                    .header,
                    .volume,
                    .play,
                    .pictureinpicture {
                      display: none !important;
                    }
                    :host {
                      display: grid;
                      width: 100%;
                      gap: 12px;
                      align-items: stretch;
                    }
              - type: grid
                columns: 3
                square: false
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: name
                    name: ''
                    icon: mdi:camera
                    show_state: false
                    show_name: false
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    button_action:
                      tap_action:
                        action: fire-dom-event
                        event: webrtc-screenshot
                        target_id: front-door-popup-home
                    styles: |
                      ha-card {
                        display: flex !important;
                        flex-direction: row !important;
                        justify-content: center !important;
                      }
                      .bubble-button-card-container {
                        width: 52px !important;
                        height: 52px !important;
                      }
                      .bubble-background {
                        border-radius: 50% !important;
                        cursor: pointer !important;
                      }
                      .bubble-icon-container {
                        background-color: green !important;
                        width: 52px !important;
                        height: 52px !important;
                        margin: 0 !important;
                        pointer-events: none !important;
                      }
                      .bubble-icon {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      .bubble-name-container {
                        display: none !important;
                      }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: name
                    name: ''
                    icon: mdi:volume-off
                    show_state: false
                    show_name: false
                    button_action:
                      tap_action:
                        action: fire-dom-event
                        event: webrtc-toggle-mute
                        target_id: front-door-popup-home
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      ha-card {
                        display: flex !important;
                        flex-direction: row !important;
                        justify-content: center !important;
                      }
                      .bubble-button-card-container {
                        width: 52px !important;
                        height: 52px !important;
                      }
                      .bubble-background {
                        border-radius: 50% !important;
                        cursor: pointer !important;
                      }
                      .bubble-icon-container {
                        background-color: rgba(220, 38, 38, 1) !important;
                        width: 52px !important;
                        height: 52px !important;
                        margin: 0 !important;
                        position: relative;
                        transition: background-color 0.2s ease;
                        pointer-events: none !important;
                      }
                      .bubble-icon {
                        transition: color 0.2s ease, visibility 0.2s ease;
                      }
                      .bubble-icon {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      .bubble-name-container {
                        display: none !important;
                      }
                    card_mod:
                      style: >
                        /* Unmuted state (green) - when body has the unmuted
                        class */

                        :host-context(body.webrtc-unmuted-front-door-popup-home)
                        .bubble-icon-container {
                          background-color: green !important;
                        }

                        :host-context(body.webrtc-unmuted-front-door-popup-home)
                        .bubble-icon {
                          visibility: hidden;
                        }

                        /* Show volume-high icon when unmuted using ::after on
                        container */

                        :host-context(body.webrtc-unmuted-front-door-popup-home)
                        .bubble-icon-container::after {
                          content: '';
                          position: absolute;
                          top: 50%;
                          left: 50%;
                          transform: translate(-50%, -50%);
                          width: 24px;
                          height: 24px;
                          background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%23ffffff' d='M14,3.23V5.29C16.89,6.15 19,8.83 19,12C19,15.17 16.89,17.84 14,18.7V20.77C18,19.86 21,16.28 21,12C21,7.72 18,4.14 14,3.23M16.5,12C16.5,10.23 15.5,8.71 14,7.97V16C15.5,15.29 16.5,13.76 16.5,12M3,9V15H7L12,20V4L7,9H3Z'/%3E%3C/svg%3E") center/contain no-repeat;
                          pointer-events: none;
                        }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: switch
                    name: ''
                    entity: input_boolean.is_front_door_recording
                    show_state: false
                    show_name: false
                    button_action:
                      tap_action:
                        action: call-service
                        service: script.turn_on
                        target:
                          entity_id: script.front_door_manual_recording
                      hold_action:
                        action: none
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      ha-card {
                        display: flex !important;
                        flex-direction: row !important;
                        justify-content: center !important;
                      }
                      .bubble-button-card-container {
                        width: 52px !important;
                        height: 52px !important;
                      }
                      .bubble-background {
                        border-radius: 50% !important;
                        cursor: pointer !important;
                      }
                      .bubble-icon-container {
                        width: 52px !important;
                        height: 52px !important;
                        margin: 0 !important;
                        pointer-events: none !important;
                      }
                      .bubble-icon {
                        color: rgba(220, 38, 38, 0.85) !important;
                      }
                      .bubble-name-container {
                        display: none !important;
                      }
                      .is-on .bubble-icon-container {
                        background-color: red !important;
                      }
                      .bubble-icon {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                card_mod:
                  style: |
                    ha-card {
                      display: flex;
                      flex-direction: row;
                      justify-content: center;
                    }
          - type: vertical-stack
            grid_options:
              columns: full
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#camera-upper-deck'
                button_type: name
                show_icon: false
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                  .bubble-pop-up-background {
                    background-color: rgba(25, 36, 54, 0.55) !important;
                    filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.18);
                    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.15),
                        0 15px 40px rgba(0, 0, 0, 0.35);
                  }
              - type: custom:bubble-card
                card_type: separator
                name: Upper Deck Camera
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button: []
              - square: false
                type: grid
                grid_options:
                  columns: full
                cards:
                  - type: custom:webrtc-camera-sfenton
                    card_id: upper-deck-popup-home
                    shared: true
                    streams:
                      - url: upper_deck
                        mode: webrtc,webrtc/tcp,mse,hls,mjpeg
                        media: video,audio
                    style: |
                      ha-card {
                        aspect-ratio: 16 / 9;
                        height: auto;
                      }
                      .fullscreen,
                      .screenshot,
                      .header,
                      .volume,
                      .play,
                      .pictureinpicture {
                        display: none !important;
                      }
                    ui: true
                    digital_ptz:
                      mouse_drag_pan: false
                      mouse_wheel_zoom: false
                      mouse_double_click_zoom: false
                      touch_drag_pan: false
                      touch_pinch_zoom: false
                      touch_tap_drag_zoom: false
                      persist: true
                    muted: true
                    intersection: 0
                columns: 1
                card_mod:
                  style: |
                    :host {
                      display: grid;
                      width: 100%;
                      gap: 12px;
                      align-items: stretch;
                    }
              - type: grid
                columns: 3
                square: false
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: name
                    name: ''
                    icon: mdi:camera
                    show_state: false
                    show_name: false
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    button_action:
                      tap_action:
                        action: fire-dom-event
                        event: webrtc-screenshot
                        target_id: upper-deck-popup-home
                    styles: |
                      ha-card {
                        display: flex !important;
                        flex-direction: row !important;
                        justify-content: center !important;
                      }
                      .bubble-button-card-container {
                        width: 52px !important;
                        height: 52px !important;
                      }
                      .bubble-background {
                        border-radius: 50% !important;
                        cursor: pointer !important;
                      }
                      .bubble-icon-container {
                        background-color: green !important;
                        width: 52px !important;
                        height: 52px !important;
                        margin: 0 !important;
                        pointer-events: none !important;
                      }
                      .bubble-icon {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      .bubble-name-container {
                        display: none !important;
                      }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: name
                    name: ''
                    icon: mdi:volume-off
                    show_state: false
                    show_name: false
                    button_action:
                      tap_action:
                        action: fire-dom-event
                        event: webrtc-toggle-mute
                        target_id: upper-deck-popup-home
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      ha-card {
                        display: flex !important;
                        flex-direction: row !important;
                        justify-content: center !important;
                      }
                      .bubble-button-card-container {
                        width: 52px !important;
                        height: 52px !important;
                      }
                      .bubble-background {
                        border-radius: 50% !important;
                        cursor: pointer !important;
                      }
                      .bubble-icon-container {
                        background-color: rgba(220, 38, 38, 1) !important;
                        width: 52px !important;
                        height: 52px !important;
                        margin: 0 !important;
                        position: relative;
                        transition: background-color 0.2s ease;
                        pointer-events: none !important;
                      }
                      .bubble-icon {
                        transition: color 0.2s ease, visibility 0.2s ease;
                      }
                      .bubble-icon {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      .bubble-name-container {
                        display: none !important;
                      }
                    card_mod:
                      style: >
                        /* Unmuted state (green) - when body has the unmuted
                        class */

                        :host-context(body.webrtc-unmuted-upper-deck-popup-home)
                        .bubble-icon-container {
                          background-color: green !important;
                        }

                        :host-context(body.webrtc-unmuted-upper-deck-popup-home)
                        .bubble-icon {
                          visibility: hidden;
                        }

                        /* Show volume-high icon when unmuted using ::after on
                        container */

                        :host-context(body.webrtc-unmuted-upper-deck-popup-home)
                        .bubble-icon-container::after {
                          content: '';
                          position: absolute;
                          top: 50%;
                          left: 50%;
                          transform: translate(-50%, -50%);
                          width: 24px;
                          height: 24px;
                          background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%23ffffff' d='M14,3.23V5.29C16.89,6.15 19,8.83 19,12C19,15.17 16.89,17.84 14,18.7V20.77C18,19.86 21,16.28 21,12C21,7.72 18,4.14 14,3.23M16.5,12C16.5,10.23 15.5,8.71 14,7.97V16C15.5,15.29 16.5,13.76 16.5,12M3,9V15H7L12,20V4L7,9H3Z'/%3E%3C/svg%3E") center/contain no-repeat;
                          pointer-events: none;
                        }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: switch
                    name: ''
                    entity: input_boolean.is_upper_deck_recording
                    show_state: false
                    show_name: false
                    button_action:
                      tap_action:
                        action: call-service
                        service: script.turn_on
                        target:
                          entity_id: script.upper_deck_manual_recording
                      hold_action:
                        action: none
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      ha-card {
                        display: flex !important;
                        flex-direction: row !important;
                        justify-content: center !important;
                      }
                      .bubble-button-card-container {
                        width: 52px !important;
                        height: 52px !important;
                      }
                      .bubble-background {
                        border-radius: 50% !important;
                        cursor: pointer !important;
                      }
                      .bubble-icon-container {
                        width: 52px !important;
                        height: 52px !important;
                        margin: 0 !important;
                        pointer-events: none !important;
                      }
                      .bubble-icon {
                        color: rgba(220, 38, 38, 0.85) !important;
                      }
                      .bubble-name-container {
                        display: none !important;
                      }
                      .is-on .bubble-icon-container {
                        background-color: red !important;
                      }
                      .bubble-icon {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                card_mod:
                  style: |
                    ha-card {
                      display: flex;
                      flex-direction: row;
                      justify-content: center;
                    }
          - type: vertical-stack
            grid_options:
              columns: full
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#camera-lower-deck'
                button_type: name
                show_icon: false
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                  .bubble-pop-up-background {
                    background-color: rgba(25, 36, 54, 0.55) !important;
                    filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.18);
                    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.15),
                        0 15px 40px rgba(0, 0, 0, 0.35);
                  }
              - type: custom:bubble-card
                card_type: separator
                name: Lower Deck Camera
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button: []
              - square: false
                type: grid
                grid_options:
                  columns: full
                cards:
                  - type: custom:webrtc-camera-sfenton
                    card_id: lower-deck-popup-home
                    shared: true
                    streams:
                      - url: lower_deck
                        mode: webrtc,webrtc/tcp,mse,hls,mjpeg
                        media: video,audio
                    style: |
                      ha-card {
                        aspect-ratio: 16 / 9;
                        height: auto;
                      }
                      .fullscreen,
                      .screenshot,
                      .header,
                      .volume,
                      .play,
                      .pictureinpicture {
                        display: none !important;
                      }
                    ui: true
                    digital_ptz:
                      mouse_drag_pan: false
                      mouse_wheel_zoom: false
                      mouse_double_click_zoom: false
                      touch_drag_pan: false
                      touch_pinch_zoom: false
                      touch_tap_drag_zoom: false
                      persist: true
                    muted: true
                    intersection: 0
                columns: 1
                card_mod:
                  style: |
                    :host {
                      display: grid;
                      width: 100%;
                      gap: 12px;
                      align-items: stretch;
                    }
              - type: grid
                columns: 3
                square: false
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: name
                    name: ''
                    icon: mdi:camera
                    show_state: false
                    show_name: false
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    button_action:
                      tap_action:
                        action: fire-dom-event
                        event: webrtc-screenshot
                        target_id: lower-deck-popup-home
                    styles: |
                      ha-card {
                        display: flex !important;
                        flex-direction: row !important;
                        justify-content: center !important;
                      }
                      .bubble-button-card-container {
                        width: 52px !important;
                        height: 52px !important;
                      }
                      .bubble-background {
                        border-radius: 50% !important;
                        cursor: pointer !important;
                      }
                      .bubble-icon-container {
                        background-color: green !important;
                        width: 52px !important;
                        height: 52px !important;
                        margin: 0 !important;
                        pointer-events: none !important;
                      }
                      .bubble-icon {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      .bubble-name-container {
                        display: none !important;
                      }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: name
                    name: ''
                    icon: mdi:volume-off
                    show_state: false
                    show_name: false
                    button_action:
                      tap_action:
                        action: fire-dom-event
                        event: webrtc-toggle-mute
                        target_id: lower-deck-popup-home
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      ha-card {
                        display: flex !important;
                        flex-direction: row !important;
                        justify-content: center !important;
                      }
                      .bubble-button-card-container {
                        width: 52px !important;
                        height: 52px !important;
                      }
                      .bubble-background {
                        border-radius: 50% !important;
                        cursor: pointer !important;
                      }
                      .bubble-icon-container {
                        background-color: rgba(220, 38, 38, 1) !important;
                        width: 52px !important;
                        height: 52px !important;
                        margin: 0 !important;
                        position: relative;
                        transition: background-color 0.2s ease;
                        pointer-events: none !important;
                      }
                      .bubble-icon {
                        transition: color 0.2s ease, visibility 0.2s ease;
                      }
                      .bubble-icon {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      .bubble-name-container {
                        display: none !important;
                      }
                    card_mod:
                      style: >
                        /* Unmuted state (green) - when body has the unmuted
                        class */

                        :host-context(body.webrtc-unmuted-lower-deck-popup-home)
                        .bubble-icon-container {
                          background-color: green !important;
                        }

                        :host-context(body.webrtc-unmuted-lower-deck-popup-home)
                        .bubble-icon {
                          visibility: hidden;
                        }

                        /* Show volume-high icon when unmuted using ::after on
                        container */

                        :host-context(body.webrtc-unmuted-lower-deck-popup-home)
                        .bubble-icon-container::after {
                          content: '';
                          position: absolute;
                          top: 50%;
                          left: 50%;
                          transform: translate(-50%, -50%);
                          width: 24px;
                          height: 24px;
                          background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%23ffffff' d='M14,3.23V5.29C16.89,6.15 19,8.83 19,12C19,15.17 16.89,17.84 14,18.7V20.77C18,19.86 21,16.28 21,12C21,7.72 18,4.14 14,3.23M16.5,12C16.5,10.23 15.5,8.71 14,7.97V16C15.5,15.29 16.5,13.76 16.5,12M3,9V15H7L12,20V4L7,9H3Z'/%3E%3C/svg%3E") center/contain no-repeat;
                          pointer-events: none;
                        }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: switch
                    name: ''
                    entity: input_boolean.is_lower_deck_recording
                    show_state: false
                    show_name: false
                    button_action:
                      tap_action:
                        action: call-service
                        service: script.turn_on
                        target:
                          entity_id: script.lower_deck_manual_recording
                      hold_action:
                        action: none
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      ha-card {
                        display: flex !important;
                        flex-direction: row !important;
                        justify-content: center !important;
                      }
                      .bubble-button-card-container {
                        width: 52px !important;
                        height: 52px !important;
                      }
                      .bubble-background {
                        border-radius: 50% !important;
                        cursor: pointer !important;
                      }
                      .bubble-icon-container {
                        width: 52px !important;
                        height: 52px !important;
                        margin: 0 !important;
                        pointer-events: none !important;
                      }
                      .bubble-icon {
                        color: rgba(220, 38, 38, 0.85) !important;
                      }
                      .bubble-name-container {
                        display: none !important;
                      }
                      .is-on .bubble-icon-container {
                        background-color: red !important;
                      }
                      .bubble-icon {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                card_mod:
                  style: |
                    ha-card {
                      display: flex;
                      flex-direction: row;
                      justify-content: center;
                    }
        column_span: 4
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: separator
            name: Areas
            card_layout: large
            rows: '01'
            grid_options:
              columns: full
          - square: false
            type: grid
            cards:
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: vacuum.roborock_s7_maxv
                name: Living Room
                show_icon: false
                modules: []
                grid_options:
                  columns: 24
                  rows: 3
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                        .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-wrapper {
                    align-items: flex-end;
                    justify-content: flex-start;
                    width: 100%;
                    height: 100%;
                  }
                  .bubble-name-container {
                    margin: 0;
                    margin-left: 16px !important;
                    margin-bottom: 16px !important;
                    text-align: left;
                    align-items: flex-start;
                    pointer-events: none;
                  }
                  .bubble-name,
                  .bubble-state {
                    width: 100%;
                    line-height: 1.2;
                  }
                  .bubble-state {
                    opacity: 0.75;
                    font-size: 0.9rem;
                  }
                  .bubble-container,
                  .bubble-card,
                  .bubble-button-card-container {
                    background: transparent !important;
                    box-shadow: none !important;
                  }
                  .bubble-background {
                    background-color: transparent !important;
                    -webkit-mask-image: none !important;
                    mask-image: none !important;
                  }
                show_attribute: false
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: /at-a-glance/living-room
                sub_button: []
                scrolling_effect: true
                show_name: true
                card_mod:
                  style: |
                    .bubble-background {
                      background: url("/local/images/living-room.jpg") center/cover no-repeat !important;
                      background-size: cover !important;
                      background-position: center !important;
                      background-repeat: no-repeat !important;
                      filter: none !important;
                      padding: 0 !important;
                      margin: 0 !important;
                      width: 100% !important;
                      height: 100% !important;
                      border-radius: inherit !important;
                      opacity: 1 !important;
                    }
                    .bubble-wrapper {
                      backdrop-filter: none !important;
                    }
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: vacuum.roborock_s7_maxv
                name: Guest Room
                show_icon: false
                grid_options:
                  columns: 24
                  rows: 3
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                        .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-wrapper {
                    align-items: flex-end;
                    justify-content: flex-start;
                    width: 100%;
                    height: 100%;
                  }
                  .bubble-name-container {
                    margin: 0;
                    margin-left: 16px !important;
                    margin-bottom: 16px !important;
                    text-align: left;
                    align-items: flex-start;
                    pointer-events: none;
                  }
                  .bubble-name,
                  .bubble-state {
                    width: 100%;
                    line-height: 1.2;
                  }
                  .bubble-state {
                    opacity: 0.75;
                    font-size: 0.9rem;
                  }
                  .bubble-container,
                  .bubble-card,
                  .bubble-button-card-container {
                    background: transparent !important;
                    box-shadow: none !important;
                  }
                  .bubble-background {
                    background-color: transparent !important;
                    -webkit-mask-image: none !important;
                    mask-image: none !important;
                  }
                show_attribute: false
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: /at-a-glance/guest-room
                card_mod:
                  style: |
                    .bubble-background {
                      background: url("/local/images/guest-room.jpg") center/cover no-repeat !important;
                      background-size: cover !important;
                      background-position: center !important;
                      background-repeat: no-repeat !important;
                      filter: none !important;              /* remove default dim/blur */
                      padding: 0 !important;
                      margin: 0 !important;
                      width: 100% !important;
                      height: 100% !important;
                      border-radius: inherit !important;
                      opacity: 1 !important;
                    }
                    .bubble-wrapper {
                      backdrop-filter: none !important;     /* optional: removes extra haze */
                    }
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: vacuum.roborock_s7_maxv
                name: Gym
                show_icon: false
                grid_options:
                  columns: 24
                  rows: 3
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                        .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-wrapper {
                    align-items: flex-end;
                    justify-content: flex-start;
                    width: 100%;
                    height: 100%;
                  }
                  .bubble-name-container {
                    margin: 0;
                    margin-left: 16px !important;
                    margin-bottom: 16px !important;
                    text-align: left;
                    align-items: flex-start;
                    pointer-events: none;
                  }
                  .bubble-name,
                  .bubble-state {
                    width: 100%;
                    line-height: 1.2;
                  }
                  .bubble-state {
                    opacity: 0.75;
                    font-size: 0.9rem;
                  }
                  .bubble-container,
                  .bubble-card,
                  .bubble-button-card-container {
                    background: transparent !important;
                    box-shadow: none !important;
                  }
                  .bubble-background {
                    background-color: transparent !important;
                    -webkit-mask-image: none !important;
                    mask-image: none !important;
                  }
                show_attribute: false
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: /at-a-glance/gym
                card_mod:
                  style: |
                    .bubble-background {
                      background: url("/local/images/gym.jpg") center/cover no-repeat !important;
                      background-size: cover !important;
                      background-position: center !important;
                      background-repeat: no-repeat !important;
                      filter: none !important;              /* remove default dim/blur */
                      padding: 0 !important;
                      margin: 0 !important;
                      width: 100% !important;
                      height: 100% !important;
                      border-radius: inherit !important;
                      opacity: 1 !important;
                    }
                    .bubble-wrapper {
                      backdrop-filter: none !important;     /* optional: removes extra haze */
                    }
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: vacuum.roborock_s7_maxv
                name: Master Bedroom
                show_icon: false
                grid_options:
                  columns: 24
                  rows: 3
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                        .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-wrapper {
                    align-items: flex-end;
                    justify-content: flex-start;
                    width: 100%;
                    height: 100%;
                  }
                  .bubble-name-container {
                    margin: 0;
                    margin-left: 16px !important;
                    margin-bottom: 16px !important;
                    text-align: left;
                    align-items: flex-start;
                    pointer-events: none;
                  }
                  .bubble-name,
                  .bubble-state {
                    width: 100%;
                    line-height: 1.2;
                  }
                  .bubble-state {
                    opacity: 0.75;
                    font-size: 0.9rem;
                  }
                  .bubble-container,
                  .bubble-card,
                  .bubble-button-card-container {
                    background: transparent !important;
                    box-shadow: none !important;
                  }
                  .bubble-background {
                    background-color: transparent !important;
                    -webkit-mask-image: none !important;
                    mask-image: none !important;
                  }
                show_attribute: false
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: /at-a-glance/master-bedroom
                card_mod:
                  style: |
                    .bubble-background {
                      background: url("/local/images/master-bedroom.jpg") center/cover no-repeat !important;
                      background-size: cover !important;
                      background-position: center !important;
                      background-repeat: no-repeat !important;
                      filter: none !important;              /* remove default dim/blur */
                      padding: 0 !important;
                      margin: 0 !important;
                      width: 100% !important;
                      height: 100% !important;
                      border-radius: inherit !important;
                      opacity: 1 !important;
                    }
                    .bubble-wrapper {
                      backdrop-filter: none !important;     /* optional: removes extra haze */
                    }
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: vacuum.roborock_s7_maxv
                name: Office
                show_icon: false
                grid_options:
                  columns: 24
                  rows: 3
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                        .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-wrapper {
                    align-items: flex-end;
                    justify-content: flex-start;
                    width: 100%;
                    height: 100%;
                  }
                  .bubble-name-container {
                    margin: 0;
                    margin-left: 16px !important;
                    margin-bottom: 16px !important;
                    text-align: left;
                    align-items: flex-start;
                    pointer-events: none;
                  }
                  .bubble-name,
                  .bubble-state {
                    width: 100%;
                    line-height: 1.2;
                  }
                  .bubble-state {
                    opacity: 0.75;
                    font-size: 0.9rem;
                  }
                  .bubble-container,
                  .bubble-card,
                  .bubble-button-card-container {
                    background: transparent !important;
                    box-shadow: none !important;
                  }
                  .bubble-background {
                    background-color: transparent !important;
                    -webkit-mask-image: none !important;
                    mask-image: none !important;
                  }
                show_attribute: false
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: /at-a-glance/office
                card_mod:
                  style: |
                    .bubble-background {
                      background: url("/local/images/gym.jpg") center/cover no-repeat !important;
                      background-size: cover !important;
                      background-position: center !important;
                      background-repeat: no-repeat !important;
                      filter: none !important;              /* remove default dim/blur */
                      padding: 0 !important;
                      margin: 0 !important;
                      width: 100% !important;
                      height: 100% !important;
                      border-radius: inherit !important;
                      opacity: 1 !important;
                    }
                    .bubble-wrapper {
                      backdrop-filter: none !important;     /* optional: removes extra haze */
                    }
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: vacuum.roborock_s7_maxv
                name: Hallway
                show_icon: false
                grid_options:
                  columns: 24
                  rows: 3
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                        .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-wrapper {
                    align-items: flex-end;
                    justify-content: flex-start;
                    width: 100%;
                    height: 100%;
                  }
                  .bubble-name-container {
                    margin: 0;
                    margin-left: 16px !important;
                    margin-bottom: 16px !important;
                    text-align: left;
                    align-items: flex-start;
                    pointer-events: none;
                  }
                  .bubble-name,
                  .bubble-state {
                    width: 100%;
                    line-height: 1.2;
                  }
                  .bubble-state {
                    opacity: 0.75;
                    font-size: 0.9rem;
                  }
                  .bubble-container,
                  .bubble-card,
                  .bubble-button-card-container {
                    background: transparent !important;
                    box-shadow: none !important;
                  }
                  .bubble-background {
                    background-color: transparent !important;
                    -webkit-mask-image: none !important;
                    mask-image: none !important;
                  }
                show_attribute: false
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: /at-a-glance/hallway
                card_mod:
                  style: |
                    .bubble-background {
                      background: url("/local/images/hallway.jpg") center/cover no-repeat !important;
                      background-size: cover !important;
                      background-position: center !important;
                      background-repeat: no-repeat !important;
                      filter: none !important;              /* remove default dim/blur */
                      padding: 0 !important;
                      margin: 0 !important;
                      width: 100% !important;
                      height: 100% !important;
                      border-radius: inherit !important;
                      opacity: 1 !important;
                    }
                    .bubble-wrapper {
                      backdrop-filter: none !important;     /* optional: removes extra haze */
                    }
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: vacuum.roborock_s7_maxv
                name: Kitchen
                show_icon: false
                grid_options:
                  columns: 24
                  rows: 3
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                        .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-wrapper {
                    align-items: flex-end;
                    justify-content: flex-start;
                    width: 100%;
                    height: 100%;
                  }
                  .bubble-name-container {
                    margin: 0;
                    margin-left: 16px !important;
                    margin-bottom: 16px !important;
                    text-align: left;
                    align-items: flex-start;
                    pointer-events: none;
                  }
                  .bubble-name,
                  .bubble-state {
                    width: 100%;
                    line-height: 1.2;
                  }
                  .bubble-state {
                    opacity: 0.75;
                    font-size: 0.9rem;
                  }
                  .bubble-container,
                  .bubble-card,
                  .bubble-button-card-container {
                    background: transparent !important;
                    box-shadow: none !important;
                  }
                  .bubble-background {
                    background-color: transparent !important;
                    -webkit-mask-image: none !important;
                    mask-image: none !important;
                  }
                show_attribute: false
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: /at-a-glance/kitchen
                card_mod:
                  style: |
                    .bubble-background {
                      background: url("/local/images/kitchen.jpg") center/cover no-repeat !important;
                      background-size: cover !important;
                      background-position: center !important;
                      background-repeat: no-repeat !important;
                      filter: none !important;              /* remove default dim/blur */
                      padding: 0 !important;
                      margin: 0 !important;
                      width: 100% !important;
                      height: 100% !important;
                      border-radius: inherit !important;
                      opacity: 1 !important;
                    }
                    .bubble-wrapper {
                      backdrop-filter: none !important;     /* optional: removes extra haze */
                    }
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: vacuum.roborock_s7_maxv
                name: Music Room
                show_icon: false
                grid_options:
                  columns: 24
                  rows: 3
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                        .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-wrapper {
                    align-items: flex-end;
                    justify-content: flex-start;
                    width: 100%;
                    height: 100%;
                  }
                  .bubble-name-container {
                    margin: 0;
                    margin-left: 16px !important;
                    margin-bottom: 16px !important;
                    text-align: left;
                    align-items: flex-start;
                    pointer-events: none;
                  }
                  .bubble-name,
                  .bubble-state {
                    width: 100%;
                    line-height: 1.2;
                  }
                  .bubble-state {
                    opacity: 0.75;
                    font-size: 0.9rem;
                  }
                  .bubble-container,
                  .bubble-card,
                  .bubble-button-card-container {
                    background: transparent !important;
                    box-shadow: none !important;
                  }
                  .bubble-background {
                    background-color: transparent !important;
                    -webkit-mask-image: none !important;
                    mask-image: none !important;
                  }
                show_attribute: false
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: /at-a-glance/music-room
                card_mod:
                  style: |
                    .bubble-background {
                      background: url("/local/images/gym.jpg") center/cover no-repeat !important;
                      background-size: cover !important;
                      background-position: center !important;
                      background-repeat: no-repeat !important;
                      filter: none !important;              /* remove default dim/blur */
                      padding: 0 !important;
                      margin: 0 !important;
                      width: 100% !important;
                      height: 100% !important;
                      border-radius: inherit !important;
                      opacity: 1 !important;
                    }
                    .bubble-wrapper {
                      backdrop-filter: none !important;     /* optional: removes extra haze */
                    }
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: vacuum.roborock_s7_maxv
                name: Garage
                show_icon: false
                grid_options:
                  columns: 24
                  rows: 3
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                        .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-wrapper {
                    align-items: flex-end;
                    justify-content: flex-start;
                    width: 100%;
                    height: 100%;
                  }
                  .bubble-name-container {
                    margin: 0;
                    margin-left: 16px !important;
                    margin-bottom: 16px !important;
                    text-align: left;
                    align-items: flex-start;
                    pointer-events: none;
                  }
                  .bubble-name,
                  .bubble-state {
                    width: 100%;
                    line-height: 1.2;
                  }
                  .bubble-state {
                    opacity: 0.75;
                    font-size: 0.9rem;
                  }
                  .bubble-container,
                  .bubble-card,
                  .bubble-button-card-container {
                    background: transparent !important;
                    box-shadow: none !important;
                  }
                  .bubble-background {
                    background-color: transparent !important;
                    -webkit-mask-image: none !important;
                    mask-image: none !important;
                  }
                show_attribute: false
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: /at-a-glance/garage
                card_mod:
                  style: |
                    .bubble-background {
                      background: url("/local/images/gym.jpg") center/cover no-repeat !important;
                      background-size: cover !important;
                      background-position: center !important;
                      background-repeat: no-repeat !important;
                      filter: none !important;              /* remove default dim/blur */
                      padding: 0 !important;
                      margin: 0 !important;
                      width: 100% !important;
                      height: 100% !important;
                      border-radius: inherit !important;
                      opacity: 1 !important;
                    }
                    .bubble-wrapper {
                      backdrop-filter: none !important;     /* optional: removes extra haze */
                    }
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: vacuum.roborock_s7_maxv
                name: Theater Room
                show_icon: false
                grid_options:
                  columns: 24
                  rows: 3
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                        .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-wrapper {
                    align-items: flex-end;
                    justify-content: flex-start;
                    width: 100%;
                    height: 100%;
                  }
                  .bubble-name-container {
                    margin: 0;
                    margin-left: 16px !important;
                    margin-bottom: 16px !important;
                    text-align: left;
                    align-items: flex-start;
                    pointer-events: none;
                  }
                  .bubble-name,
                  .bubble-state {
                    width: 100%;
                    line-height: 1.2;
                  }
                  .bubble-state {
                    opacity: 0.75;
                    font-size: 0.9rem;
                  }
                  .bubble-container,
                  .bubble-card,
                  .bubble-button-card-container {
                    background: transparent !important;
                    box-shadow: none !important;
                  }
                  .bubble-background {
                    background-color: transparent !important;
                    -webkit-mask-image: none !important;
                    mask-image: none !important;
                  }
                show_attribute: false
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: /at-a-glance/theater-room
                card_mod:
                  style: |
                    .bubble-background {
                      background: url("/local/images/gym.jpg") center/cover no-repeat !important;
                      background-size: cover !important;
                      background-position: center !important;
                      background-repeat: no-repeat !important;
                      filter: none !important;              /* remove default dim/blur */
                      padding: 0 !important;
                      margin: 0 !important;
                      width: 100% !important;
                      height: 100% !important;
                      border-radius: inherit !important;
                      opacity: 1 !important;
                    }
                    .bubble-wrapper {
                      backdrop-filter: none !important;     /* optional: removes extra haze */
                    }
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: vacuum.roborock_s7_maxv
                name: Back Deck
                show_icon: false
                grid_options:
                  columns: 24
                  rows: 3
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                        .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-wrapper {
                    align-items: flex-end;
                    justify-content: flex-start;
                    width: 100%;
                    height: 100%;
                  }
                  .bubble-name-container {
                    margin: 0;
                    margin-left: 16px !important;
                    margin-bottom: 16px !important;
                    text-align: left;
                    align-items: flex-start;
                    pointer-events: none;
                  }
                  .bubble-name,
                  .bubble-state {
                    width: 100%;
                    line-height: 1.2;
                  }
                  .bubble-state {
                    opacity: 0.75;
                    font-size: 0.9rem;
                  }
                  .bubble-container,
                  .bubble-card,
                  .bubble-button-card-container {
                    background: transparent !important;
                    box-shadow: none !important;
                  }
                  .bubble-background {
                    background-color: transparent !important;
                    -webkit-mask-image: none !important;
                    mask-image: none !important;
                  }
                show_attribute: false
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: /at-a-glance/back-deck
                card_mod:
                  style: |
                    .bubble-background {
                      background: url("/local/images/upper-deck.jpg") center/cover no-repeat !important;
                      background-size: cover !important;
                      background-position: center !important;
                      background-repeat: no-repeat !important;
                      filter: none !important;              /* remove default dim/blur */
                      padding: 0 !important;
                      margin: 0 !important;
                      width: 100% !important;
                      height: 100% !important;
                      border-radius: inherit !important;
                      opacity: 1 !important;
                    }
                    .bubble-wrapper {
                      backdrop-filter: none !important;     /* optional: removes extra haze */
                    }
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: vacuum.roborock_s7_maxv
                name: Downstairs Hallway
                show_icon: false
                grid_options:
                  columns: 24
                  rows: 3
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                        .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-wrapper {
                    align-items: flex-end;
                    justify-content: flex-start;
                    width: 100%;
                    height: 100%;
                  }
                  .bubble-name-container {
                    margin: 0;
                    margin-left: 16px !important;
                    margin-bottom: 16px !important;
                    text-align: left;
                    align-items: flex-start;
                    pointer-events: none;
                  }
                  .bubble-name,
                  .bubble-state {
                    width: 100%;
                    line-height: 1.2;
                  }
                  .bubble-state {
                    opacity: 0.75;
                    font-size: 0.9rem;
                  }
                  .bubble-container,
                  .bubble-card,
                  .bubble-button-card-container {
                    background: transparent !important;
                    box-shadow: none !important;
                  }
                  .bubble-background {
                    background-color: transparent !important;
                    -webkit-mask-image: none !important;
                    mask-image: none !important;
                  }
                show_attribute: false
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: /at-a-glance/downstairs-hallway
                card_mod:
                  style: |
                    .bubble-background {
                      background: url("/local/images/gym.jpg") center/cover no-repeat !important;
                      background-size: cover !important;
                      background-position: center !important;
                      background-repeat: no-repeat !important;
                      filter: none !important;              /* remove default dim/blur */
                      padding: 0 !important;
                      margin: 0 !important;
                      width: 100% !important;
                      height: 100% !important;
                      border-radius: inherit !important;
                      opacity: 1 !important;
                    }
                    .bubble-wrapper {
                      backdrop-filter: none !important;     /* optional: removes extra haze */
                    }
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: vacuum.roborock_s7_maxv
                name: Guest Bathroom
                show_icon: false
                grid_options:
                  columns: 24
                  rows: 3
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                        .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-wrapper {
                    align-items: flex-end;
                    justify-content: flex-start;
                    width: 100%;
                    height: 100%;
                  }
                  .bubble-name-container {
                    margin: 0;
                    margin-left: 16px !important;
                    margin-bottom: 16px !important;
                    text-align: left;
                    align-items: flex-start;
                    pointer-events: none;
                  }
                  .bubble-name,
                  .bubble-state {
                    width: 100%;
                    line-height: 1.2;
                  }
                  .bubble-state {
                    opacity: 0.75;
                    font-size: 0.9rem;
                  }
                  .bubble-container,
                  .bubble-card,
                  .bubble-button-card-container {
                    background: transparent !important;
                    box-shadow: none !important;
                  }
                  .bubble-background {
                    background-color: transparent !important;
                    -webkit-mask-image: none !important;
                    mask-image: none !important;
                  }
                show_attribute: false
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: /at-a-glance/guest-bathroom
                card_mod:
                  style: |
                    .bubble-background {
                      background: url("/local/images/gym.jpg") center/cover no-repeat !important;
                      background-size: cover !important;
                      background-position: center !important;
                      background-repeat: no-repeat !important;
                      filter: none !important;              /* remove default dim/blur */
                      padding: 0 !important;
                      margin: 0 !important;
                      width: 100% !important;
                      height: 100% !important;
                      border-radius: inherit !important;
                      opacity: 1 !important;
                    }
                    .bubble-wrapper {
                      backdrop-filter: none !important;     /* optional: removes extra haze */
                    }
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: vacuum.roborock_s7_maxv
                name: Master Bathroom
                show_icon: false
                grid_options:
                  columns: 24
                  rows: 3
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                        .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-wrapper {
                    align-items: flex-end;
                    justify-content: flex-start;
                    width: 100%;
                    height: 100%;
                  }
                  .bubble-name-container {
                    margin: 0;
                    margin-left: 16px !important;
                    margin-bottom: 16px !important;
                    text-align: left;
                    align-items: flex-start;
                    pointer-events: none;
                  }
                  .bubble-name,
                  .bubble-state {
                    width: 100%;
                    line-height: 1.2;
                  }
                  .bubble-state {
                    opacity: 0.75;
                    font-size: 0.9rem;
                  }
                  .bubble-container,
                  .bubble-card,
                  .bubble-button-card-container {
                    background: transparent !important;
                    box-shadow: none !important;
                  }
                  .bubble-background {
                    background-color: transparent !important;
                    -webkit-mask-image: none !important;
                    mask-image: none !important;
                  }
                show_attribute: false
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: /at-a-glance/master-bathroom
                card_mod:
                  style: |
                    .bubble-background {
                      background: url("/local/images/master-bathroom.jpg") center/cover no-repeat !important;
                      background-size: cover !important;
                      background-position: center !important;
                      background-repeat: no-repeat !important;
                      filter: none !important;              /* remove default dim/blur */
                      padding: 0 !important;
                      margin: 0 !important;
                      width: 100% !important;
                      height: 100% !important;
                      border-radius: inherit !important;
                      opacity: 1 !important;
                    }
                    .bubble-wrapper {
                      backdrop-filter: none !important;     /* optional: removes extra haze */
                    }
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: vacuum.roborock_s7_maxv
                name: Dining Room
                show_icon: false
                grid_options:
                  columns: 24
                  rows: 3
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                        .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-wrapper {
                    align-items: flex-end;
                    justify-content: flex-start;
                    width: 100%;
                    height: 100%;
                  }
                  .bubble-name-container {
                    margin: 0;
                    margin-left: 16px !important;
                    margin-bottom: 16px !important;
                    text-align: left;
                    align-items: flex-start;
                    pointer-events: none;
                  }
                  .bubble-name,
                  .bubble-state {
                    width: 100%;
                    line-height: 1.2;
                  }
                  .bubble-state {
                    opacity: 0.75;
                    font-size: 0.9rem;
                  }
                  .bubble-container,
                  .bubble-card,
                  .bubble-button-card-container {
                    background: transparent !important;
                    box-shadow: none !important;
                  }
                  .bubble-background {
                    background-color: transparent !important;
                    -webkit-mask-image: none !important;
                    mask-image: none !important;
                  }
                show_attribute: false
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: /at-a-glance/dining-room
                card_mod:
                  style: |
                    .bubble-background {
                      background: url("/local/images/dining-room.jpg") center/cover no-repeat !important;
                      background-size: cover !important;
                      background-position: center !important;
                      background-repeat: no-repeat !important;
                      filter: none !important;              /* remove default dim/blur */
                      padding: 0 !important;
                      margin: 0 !important;
                      width: 100% !important;
                      height: 100% !important;
                      border-radius: inherit !important;
                      opacity: 1 !important;
                    }
                    .bubble-wrapper {
                      backdrop-filter: none !important;     /* optional: removes extra haze */
                    }
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: vacuum.roborock_s7_maxv
                name: Entryway
                show_icon: false
                grid_options:
                  columns: 24
                  rows: 3
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                        .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-wrapper {
                    align-items: flex-end;
                    justify-content: flex-start;
                    width: 100%;
                    height: 100%;
                  }
                  .bubble-name-container {
                    margin: 0;
                    margin-left: 16px !important;
                    margin-bottom: 16px !important;
                    text-align: left;
                    align-items: flex-start;
                    pointer-events: none;
                  }
                  .bubble-name,
                  .bubble-state {
                    width: 100%;
                    line-height: 1.2;
                  }
                  .bubble-state {
                    opacity: 0.75;
                    font-size: 0.9rem;
                  }
                  .bubble-container,
                  .bubble-card,
                  .bubble-button-card-container {
                    background: transparent !important;
                    box-shadow: none !important;
                  }
                  .bubble-background {
                    background-color: transparent !important;
                    -webkit-mask-image: none !important;
                    mask-image: none !important;
                  }
                show_attribute: false
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: /at-a-glance/entryway
                card_mod:
                  style: |
                    .bubble-background {
                      background: url("/local/images/entryway.jpg") center/cover no-repeat !important;
                      background-size: cover !important;
                      background-position: center !important;
                      background-repeat: no-repeat !important;
                      filter: none !important;              /* remove default dim/blur */
                      padding: 0 !important;
                      margin: 0 !important;
                      width: 100% !important;
                      height: 100% !important;
                      border-radius: inherit !important;
                      opacity: 1 !important;
                    }
                    .bubble-wrapper {
                      backdrop-filter: none !important;     /* optional: removes extra haze */
                    }
            columns: 2
            grid_options:
              columns: full
        column_span: 4
      - type: grid
        cards:
          - type: custom:navbar-card
            layout:
              mobile:
                mode: floating
                show_labels: false
              desktop:
                position: bottom
                show_labels: true
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .navbar-card.mobile {
                padding-bottom: calc(env(safe-area-inset-bottom, 0px));
              }
                          :host {
                            --navbar-background-color: rgba(25, 36, 54, 0.55);
                            --navbar-box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-desktop: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-mobile-floating: 0 24px 55px rgba(0, 0, 0, 0.55);
                          }
                          .navbar-card,
                          .navbar-card.desktop,
                          .navbar-card.mobile,
                          .navbar-card.desktop.bottom,
                          .navbar-card.desktop.top,
                          .navbar-card.desktop.left,
                          .navbar-card.desktop.right,
                          .navbar-card.mobile.floating,
                          ha-card.navbar-card {
                            background: rgba(25, 36, 54, 0.55) !important;
                            border: 1px solid rgba(255, 255, 255, 0.18) !important;
                            backdrop-filter: blur(20px);
                            -webkit-backdrop-filter: blur(20px);
                            box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45) !important;
                          }
            routes:
              - url: /at-a-glance/overview
                icon: mdi:home
                label: Home
                selected: |
                  [[[
                    const path = (location && location.pathname) || '';
                    const direct = ['/at-a-glance/security', '/at-a-glance/shopping-list', '/at-a-glance/chores'];
                    return !direct.some(prefix => path.startsWith(prefix));
                  ]]]
              - url: /at-a-glance/security
                icon: mdi:shield
                label: Security
              - url: /at-a-glance/shopping-list
                icon: mdi:shopping
                label: Shopping List
              - icon: mdi:dots-horizontal
                label: More
                tap_action:
                  action: open-popup
                popup:
                  - icon: mdi:cog
                    url: /config/dashboard
                  - icon: mdi:hammer
                    url: /developer-tools/yaml
                  - icon: mdi:power
                    tap_action:
                      action: call-service
                      service: homeassistant.restart
                      service_data: {}
                      confirmation:
                        text: Are you sure you want to restart Home Assistant?
            media_player: {}
            desktop: {}
    cards: []
  - title: Security
    path: security
    type: sections
    style: |
      :host {
        --view-padding: 0 16px !important;   /* left/right margin */
        --lovelace-view-margin: 0 16px !important;  /* fallback for older builds */
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
      }
      bubble-card {
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
        --bubble-icon-opacity: 1 !important;
        --bubble-icon-opacity-active: 1 !important;
        --bubble-icon-opacity-disabled: 1 !important;
      }
      bubble-card .bubble-icon,
      bubble-card .bubble-main-icon-container,
      bubble-card .bubble-main-icon-container ha-icon,
      bubble-card ha-icon,
      bubble-card .is-off .bubble-main-icon,
      bubble-card .is-off .bubble-main-icon-container,
      bubble-card .is-off ha-icon {
        color: white !important;
        fill: white !important;
        opacity: 1 !important;
        filter: none !important;
      }
      bubble-card .is-off .bubble-background,
      bubble-card .is-off .bubble-icon-container {
        background: rgba(255, 255, 255, 0.35) !important;
      }
      hui-view-header,
      hui-section-heading-row,
      hui-section-heading-tile {
        display: none !important;
      }
    sections:
      - type: grid
        cards:
          - type: markdown
            content: '# Security'
            text_only: true
            grid_options:
              columns: full
              rows: 1.25
            card_mod:
              style: |
                ha-card {
                  display: flex;
                  align-items: center;
                  justify-content: flex-end;   /* vertical */
                  padding-bottom: 0;           /* optional */
                  --card-mod-script: |
                    if (window.__bubbleForceWhiteInit) {
                      return;
                    }
                    window.__bubbleForceWhiteInit = true;
                    const styleId = 'bubble-force-white-style';
                    const cssLines = [
                      '.bubble-icon,',
                      '.bubble-main-icon,',
                      '.bubble-main-icon-container,',
                      '.bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.is-off .bubble-icon,',
                      '.is-off .bubble-main-icon,',
                      '.is-off .bubble-main-icon-container,',
                      '.is-off .bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.ha-markdown-element {',
                      '  color: white !important',
                      '}',
                    ];
                    const css = cssLines.join('\n');
                    const touchIcons = (root) => {
                      if (!root) {
                        return;
                      }
                      root.querySelectorAll('.bubble-icon, .bubble-main-icon, .bubble-main-icon-container ha-icon').forEach((icon) => {
                        icon.style.setProperty('color', 'white', 'important');
                        icon.style.setProperty('fill', 'white', 'important');
                        icon.style.setProperty('opacity', '1', 'important');
                        icon.style.removeProperty('filter');
                      });
                    };
                    const applyStyles = (card) => {
                      if (!card) {
                        return;
                      }
                      const root = card.shadowRoot || card;
                      if (!root) {
                        return;
                      }
                      if (!root.getElementById(styleId)) {
                        const style = document.createElement('style');
                        style.id = styleId;
                        style.textContent = css;
                        root.appendChild(style);
                      }
                      touchIcons(root);
                    };
                    const registeredRoots = new Set();
                    const registerRoot = (root) => {
                      if (
                        root &&
                        typeof root.querySelectorAll === 'function' &&
                        !registeredRoots.has(root)
                      ) {
                        registeredRoots.add(root);
                      }
                    };
                    const scan = () => {
                      registeredRoots.forEach((root) => {
                        root.querySelectorAll('bubble-card').forEach(applyStyles);
                        root.querySelectorAll('*').forEach((el) => {
                          if (el.shadowRoot) {
                            registerRoot(el.shadowRoot);
                          }
                        });
                      });
                    };
                    registerRoot(document);
                    registerRoot(document.body);
                    registerRoot(document.documentElement);
                    scan();
                    window.__bubbleForceWhiteInterval = window.setInterval(() => {
                      scan();
                    }, 750);
                }
                ha-markdown {
                  width: 100%;
                  margin: 0;
                   color: white !important;
                }
          - type: custom:swipe-card
            grid_options:
              columns: full
              rows: 1
            parameters:
              slidesPerView: auto
              spaceBetween: 12
              freeMode: true
              freeModeSticky: false
              mousewheel: true
            style: |
              margin-bottom: 10px !important;
            cards:
              - type: custom:bubble-card
                card_type: button
                button_type: state
                entity: alarm_control_panel.aqara_hub_m3_0056_security_system_2
                name: Security
                modules:
                  - frosted_glass
                button_action:
                  tap_action:
                    action: none
                  hold_action:
                    action: none
                icon_action:
                  tap_action:
                    action: none
                  hold_action:
                    action: none
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    --security-color: ${(() => {
                        const colors = {
                          disarmed: '#43a047',
                          armed_home: '#1e88e5',
                          armed_night: '#8e24aa',
                          armed_away: '#e53935',
                          triggered: '#e53935',
                        };
                        return colors[hass.states[entity]?.state] ?? '#546e7a';
                      })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--security-color) !important;
                  }
                card_mod:
                  style: >
                    :host {
                      width: auto;
                      max-width: 160px;
                      flex: 0 0 auto;
                      margin-bottom: 10px !important;
                      --bubble-icon-color: white;          # primary icon color
                      --bubble-icon-color-active: white;   # when entity is "on"
                      --bubble-icon-color-disabled: white;    # when unavailable
                    }

                    .bubble-main-icon-container {
                      background: none !important;
                      box-shadow: none !important;
                      padding: 0 !important;
                      width: auto !important;
                      height: auto !important;
                      pointer-events: none !important;
                    }

                    .bubble-main-icon-container ha-icon {
                      width: 24px;   /* or any size you need */
                      height: 24px;
                      color: white !important;
                    }

                    .bubble-main-icon-container ha-ripple,

                    .bubble-main-icon-container .bubble-icon-feedback-container
                    {
                      display: none !important;   /* remove ripple/feedback layers */
                    }
                show_state: true
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: binary_sensor.door_contact_sensors
                name: Doors
                show_state: true
                icon: mdi:motion-sensor
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  ${(() => {
                      const ids = entity?.attributes?.entity_id ?? [];
                      const openCount = ids.filter((id) => hass.states[id]?.state === 'on').length;
                      const subtitle = openCount > 0 ? `${openCount} Open` : 'All Closed';

                      card.querySelector('.bubble-state')?.replaceChildren(subtitle);
                      icon.setAttribute('icon', openCount > 0 ? 'mdi:door-open' : 'mdi:door');
                  })()}
                card_mod:
                  style: >
                    :host {
                      width: auto;
                      max-width: 150px;
                      flex: 0 0 auto;
                      margin-bottom: 10px !important;
                      --bubble-icon-color: white;
                      --bubble-icon-color-active: white;
                      --bubble-icon-color-disabled: white;
                    }

                    .bubble-main-icon-container {
                      background: none !important;
                      box-shadow: none !important;
                      padding: 0 !important;
                      width: auto !important;
                      height: auto !important;
                      pointer-events: none !important;
                    }

                    .bubble-main-icon-container ha-icon {
                      width: 24px;
                      height: 24px;
                      color: white !important;
                    }

                    .bubble-main-icon-container ha-ripple,

                    .bubble-main-icon-container .bubble-icon-feedback-container
                    {
                      display: none !important;
                    }
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: binary_sensor.window_contact_sensors
                name: Windows
                show_state: true
                icon: mdi:motion-sensor
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  ${(() => {
                      const ids = entity?.attributes?.entity_id ?? [];
                      const openCount = ids.filter((id) => hass.states[id]?.state === 'on').length;
                      const subtitle = openCount > 0 ? `${openCount} Open` : 'All Closed';

                      card.querySelector('.bubble-state')?.replaceChildren(subtitle);
                      icon.setAttribute('icon', openCount > 0 ? 'mdi:window-open' : 'mdi:window-closed');
                  })()}
                card_mod:
                  style: >
                    :host {
                      width: auto;
                      max-width: 150px;
                      flex: 0 0 auto;
                      margin-bottom: 10px !important;
                      --bubble-icon-color: white;
                      --bubble-icon-color-active: white;
                      --bubble-icon-color-disabled: white;
                    }

                    .bubble-main-icon-container {
                      background: none !important;
                      box-shadow: none !important;
                      padding: 0 !important;
                      width: auto !important;
                      height: auto !important;
                      pointer-events: none !important;
                    }

                    .bubble-main-icon-container ha-icon {
                      width: 24px;
                      height: 24px;
                      color: white !important;
                    }

                    .bubble-main-icon-container ha-ripple,

                    .bubble-main-icon-container .bubble-icon-feedback-container
                    {
                      display: none !important;
                    }
        column_span: 4
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: separator
            name: Security
            card_layout: large
            rows: '01'
            grid_options:
              columns: full
          - type: custom:bubble-card
            card_type: button
            button_type: state
            entity: alarm_control_panel.aqara_hub_m3_0056_security_system_2
            card_layout: large-sub-buttons-grid
            rows: '2'
            sub_button:
              - entity: alarm_control_panel.aqara_hub_m3_0056_security_system_2
                name: Disarm
                icon: mdi:shield-lock-open
                show_name: true
                tap_action:
                  action: perform-action
                  perform_action: alarm_control_panel.alarm_disarm
                  target:
                    entity_id: alarm_control_panel.aqara_hub_m3_0056_security_system_2
              - entity: alarm_control_panel.aqara_hub_m3_0056_security_system_2
                name: Home
                tap_action:
                  action: perform-action
                  perform_action: alarm_control_panel.alarm_arm_home
                  target:
                    entity_id: alarm_control_panel.aqara_hub_m3_0056_security_system_2
                show_name: true
                icon: mdi:home
              - entity: alarm_control_panel.aqara_hub_m3_0056_security_system_2
                name: Away
                icon: mdi:shield
                show_name: true
                tap_action:
                  action: perform-action
                  perform_action: alarm_control_panel.alarm_arm_away
                  target:
                    entity_id: alarm_control_panel.aqara_hub_m3_0056_security_system_2
              - entity: alarm_control_panel.aqara_hub_m3_0056_security_system_2
                name: Night
                icon: mdi:moon-waning-crescent
                show_name: true
                tap_action:
                  action: perform-action
                  perform_action: alarm_control_panel.alarm_arm_night
                  target:
                    entity_id: alarm_control_panel.aqara_hub_m3_0056_security_system_2
            modules:
              - subbutton_below
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              :host {
                --security-color: ${(() => {
                    const colors = {
                      disarmed: '#43a047',
                      armed_home: '#1e88e5',
                      armed_night: '#8e24aa',
                      armed_away: '#e53935',
                      triggered: '#e53935',
                    };
                    return colors[hass.states[entity]?.state] ?? '#546e7a';
                  })()};
              }
              .bubble-background,
              .bubble-icon-container {
                background: var(--security-color) !important;
              }
                                .bubble-main-icon-container {
                                  background: none !important;
                                  box-shadow: none !important;
                                  padding: 0 !important;
                                  width: auto !important;
                                  height: auto !important;
                                  pointer-events: none !important;
                                }
            name: Security System
            grid_options:
              columns: 24
              rows: '2'
          - type: custom:bubble-card
            card_type: button
            button_type: switch
            entity: lock.aqara_smart_lock_u100
            grid_options:
              columns: 6
              rows: 2
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            tap_action:
              action: toggle
            button_action:
              hold_action:
                action: none
            styles: |
              :host {
                --security-color: ${(() => {
                    const colors = {
                      locked: '#43a047',
                      unlocking: '#1e88e5',
                      locking: '#1e88e5',
                      unlocked: '#ff000059',
                    };
                    return colors[hass.states[entity]?.state] ?? '#546e7a';
                  })()};
              }
              .bubble-main-icon {
                color: white !important;
              }
              .bubble-background {
                background: var(--security-color) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-main-icon-container {
                background: none !important;
                box-shadow: none !important;
                padding: 0 !important;
                width: auto !important;
                height: auto !important;
                pointer-events: none !important;
              }
            name: Front Door Lock
            show_state: true
          - type: custom:bubble-card
            card_type: button
            button_type: slider
            entity: cover.left_door
            name: Left Door
            card_layout: large
            grid_options:
              columns: 6
              rows: 2
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            tap_action:
              action: toggle
            button_action: {}
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background {
                background: rgba(67, 160, 71, 0.35) !important;
              }
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-on .bubble-background {
                background: rgba(255, 0, 0, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-main-icon-container {
                background: none !important;
                box-shadow: none !important;
                padding: 0 !important;
                width: auto !important;
                height: auto !important;
                pointer-events: none !important;
              }
            show_state: true
          - type: custom:bubble-card
            card_type: button
            button_type: slider
            entity: cover.right_door
            name: Right Door
            card_layout: large
            grid_options:
              columns: 6
              rows: 2
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            tap_action:
              action: toggle
            button_action: {}
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background {
                background: rgba(67, 160, 71, 0.35) !important;
              }
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-on .bubble-background {
                background: rgba(255, 0, 0, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-main-icon-container {
                background: none !important;
                box-shadow: none !important;
                padding: 0 !important;
                width: auto !important;
                height: auto !important;
                pointer-events: none !important;
              }
            show_state: true
        column_span: 4
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: separator
            name: Cameras
            card_layout: large
            rows: '01'
            grid_options:
              columns: full
          - square: true
            type: grid
            cards:
              - type: custom:webrtc-camera-sfenton
                shared: true
                streams:
                  - url: front_door
                    mode: webrtc,webrtc/tcp,mse,hls,mjpeg
                    media: video,audio
                ui: true
                muted: true
                intersection: 0
                tap_action:
                  action: navigate
                  navigation_path: '#camera-front-door'
                card_mod:
                  style: |
                    video {
                      width: 100% !important;
                      height: 100% !important;
                      object-fit: cover;
                    }
                    .fullscreen,
                    .screenshot,
                    .header,
                    .volume,
                    .play,
                    .pictureinpicture {
                      display: none !important;
                    }
                    ha-card::after {
                      content: "Front Door";
                      position: absolute;
                      left: 16px;
                      bottom: 16px;
                      font-size: 13px;
                      line-height: 1.2;
                      font-weight: 600;
                      color: white;
                      pointer-events: none;
                    }
              - type: custom:webrtc-camera-sfenton
                shared: true
                streams:
                  - url: upper_deck
                    mode: webrtc,webrtc/tcp,mse,hls,mjpeg
                    media: video,audio
                ui: true
                muted: true
                intersection: 0
                tap_action:
                  action: navigate
                  navigation_path: '#camera-upper-deck'
                card_mod:
                  style: |
                    video {
                      width: 100% !important;
                      height: 100% !important;
                      object-fit: cover;
                    }
                    .fullscreen,
                    .screenshot,
                    .header,
                    .volume,
                    .play,
                    .pictureinpicture {
                      display: none !important;
                    }
                    ha-card::after {
                      content: "Upper Deck";
                      position: absolute;
                      left: 16px;
                      bottom: 16px;
                      font-size: 13px;
                      line-height: 1.2;
                      font-weight: 600;
                      color: white;
                      pointer-events: none;
                    }
              - type: custom:webrtc-camera-sfenton
                shared: true
                streams:
                  - url: lower_deck
                    mode: webrtc,webrtc/tcp,mse,hls,mjpeg
                    media: video,audio
                ui: true
                muted: true
                intersection: 0
                tap_action:
                  action: navigate
                  navigation_path: '#camera-lower-deck'
                card_mod:
                  style: |
                    video {
                      width: 100% !important;
                      height: 100% !important;
                      object-fit: cover;
                    }
                    .fullscreen,
                    .screenshot,
                    .header,
                    .volume,
                    .play,
                    .pictureinpicture {
                      display: none !important;
                    }
                    ha-card::after {
                      content: "Lower Deck";
                      position: absolute;
                      left: 16px;
                      bottom: 16px;
                      font-size: 13px;
                      line-height: 1.2;
                      font-weight: 600;
                      color: white;
                      pointer-events: none;
                    }
            columns: 2
          - type: vertical-stack
            grid_options:
              columns: full
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#camera-front-door'
                button_type: name
                show_icon: false
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                  .bubble-pop-up-background {
                    background-color: rgba(25, 36, 54, 0.55) !important;
                    filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.18);
                    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.15),
                        0 15px 40px rgba(0, 0, 0, 0.35);
                  }
              - type: custom:bubble-card
                card_type: separator
                name: Front Door Camera
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button: []
              - square: false
                type: grid
                grid_options:
                  columns: full
                cards:
                  - type: custom:webrtc-camera-sfenton
                    card_id: front-door-popup-security
                    shared: true
                    streams:
                      - url: front_door
                        mode: webrtc,webrtc/tcp,mse,hls,mjpeg
                        media: video,audio
                    style: |
                      ha-card {
                        aspect-ratio: 4 / 3;
                        height: auto;
                      }
                      .fullscreen,
                      .screenshot,
                      .header,
                      .volume,
                      .play,
                      .pictureinpicture {
                        display: none !important;
                      }
                    ui: true
                    muted: true
                    intersection: 0
                columns: 1
                card_mod:
                  style: |
                    .fullscreen,
                    .screenshot,
                    .header,
                    .volume,
                    .play,
                    .pictureinpicture {
                      display: none !important;
                    }
                    :host {
                      display: grid;
                      width: 100%;
                      gap: 12px;
                      align-items: stretch;
                    }
              - type: grid
                columns: 3
                square: false
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: name
                    name: ''
                    icon: mdi:camera
                    show_state: false
                    show_name: false
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    button_action:
                      tap_action:
                        action: fire-dom-event
                        event: webrtc-screenshot
                        target_id: front-door-popup-security
                    styles: |
                      ha-card {
                        display: flex !important;
                        flex-direction: row !important;
                        justify-content: center !important;
                      }
                      .bubble-button-card-container {
                        width: 52px !important;
                        height: 52px !important;
                      }
                      .bubble-background {
                        border-radius: 50% !important;
                        cursor: pointer !important;
                      }
                      .bubble-icon-container {
                        background-color: green !important;
                        width: 52px !important;
                        height: 52px !important;
                        margin: 0 !important;
                        pointer-events: none !important;
                      }
                      .bubble-icon {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      .bubble-name-container {
                        display: none !important;
                      }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: name
                    name: ''
                    icon: mdi:volume-off
                    show_state: false
                    show_name: false
                    button_action:
                      tap_action:
                        action: fire-dom-event
                        event: webrtc-toggle-mute
                        target_id: front-door-popup-security
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      ha-card {
                        display: flex !important;
                        flex-direction: row !important;
                        justify-content: center !important;
                      }
                      .bubble-button-card-container {
                        width: 52px !important;
                        height: 52px !important;
                      }
                      .bubble-background {
                        border-radius: 50% !important;
                        cursor: pointer !important;
                      }
                      .bubble-icon-container {
                        background-color: rgba(220, 38, 38, 1) !important;
                        width: 52px !important;
                        height: 52px !important;
                        margin: 0 !important;
                        position: relative;
                        transition: background-color 0.2s ease;
                        pointer-events: none !important;
                      }
                      .bubble-icon {
                        transition: color 0.2s ease, visibility 0.2s ease;
                      }
                      .bubble-icon {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      .bubble-name-container {
                        display: none !important;
                      }
                    card_mod:
                      style: >
                        /* Unmuted state (green) - when body has the unmuted
                        class */

                        :host-context(body.webrtc-unmuted-front-door-popup-security)
                        .bubble-icon-container {
                          background-color: green !important;
                        }

                        :host-context(body.webrtc-unmuted-front-door-popup-security)
                        .bubble-icon {
                          visibility: hidden;
                        }

                        /* Show volume-high icon when unmuted using ::after on
                        container */

                        :host-context(body.webrtc-unmuted-front-door-popup-security)
                        .bubble-icon-container::after {
                          content: '';
                          position: absolute;
                          top: 50%;
                          left: 50%;
                          transform: translate(-50%, -50%);
                          width: 24px;
                          height: 24px;
                          background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%23ffffff' d='M14,3.23V5.29C16.89,6.15 19,8.83 19,12C19,15.17 16.89,17.84 14,18.7V20.77C18,19.86 21,16.28 21,12C21,7.72 18,4.14 14,3.23M16.5,12C16.5,10.23 15.5,8.71 14,7.97V16C15.5,15.29 16.5,13.76 16.5,12M3,9V15H7L12,20V4L7,9H3Z'/%3E%3C/svg%3E") center/contain no-repeat;
                          pointer-events: none;
                        }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: switch
                    name: ''
                    entity: input_boolean.is_front_door_recording
                    show_state: false
                    show_name: false
                    button_action:
                      tap_action:
                        action: call-service
                        service: script.turn_on
                        target:
                          entity_id: script.front_door_manual_recording
                      hold_action:
                        action: none
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      ha-card {
                        display: flex !important;
                        flex-direction: row !important;
                        justify-content: center !important;
                      }
                      .bubble-button-card-container {
                        width: 52px !important;
                        height: 52px !important;
                      }
                      .bubble-background {
                        border-radius: 50% !important;
                        cursor: pointer !important;
                      }
                      .bubble-icon-container {
                        width: 52px !important;
                        height: 52px !important;
                        margin: 0 !important;
                        pointer-events: none !important;
                      }
                      .bubble-icon {
                        color: rgba(220, 38, 38, 0.85) !important;
                      }
                      .bubble-name-container {
                        display: none !important;
                      }
                      .is-on .bubble-icon-container {
                        background-color: red !important;
                      }
                      .bubble-icon {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                card_mod:
                  style: |
                    ha-card {
                      display: flex;
                      flex-direction: row;
                      justify-content: center;
                    }
          - type: vertical-stack
            grid_options:
              columns: full
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#camera-upper-deck'
                button_type: name
                show_icon: false
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                  .bubble-pop-up-background {
                    background-color: rgba(25, 36, 54, 0.55) !important;
                    filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.18);
                    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.15),
                        0 15px 40px rgba(0, 0, 0, 0.35);
                  }
              - type: custom:bubble-card
                card_type: separator
                name: Upper Deck Camera
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button: []
              - square: false
                type: grid
                grid_options:
                  columns: full
                cards:
                  - type: custom:webrtc-camera-sfenton
                    card_id: upper-deck-popup-security
                    shared: true
                    streams:
                      - url: upper_deck
                        mode: webrtc,webrtc/tcp,mse,hls,mjpeg
                        media: video,audio
                    style: |
                      ha-card {
                        aspect-ratio: 16 / 9;
                        height: auto;
                      }
                      .fullscreen,
                      .screenshot,
                      .header,
                      .volume,
                      .play,
                      .pictureinpicture {
                        display: none !important;
                      }
                    ui: true
                    muted: true
                    intersection: 0
                columns: 1
                card_mod:
                  style: |
                    :host {
                      display: grid;
                      width: 100%;
                      gap: 12px;
                      align-items: stretch;
                    }
              - type: grid
                columns: 3
                square: false
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: name
                    name: ''
                    icon: mdi:camera
                    show_state: false
                    show_name: false
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    button_action:
                      tap_action:
                        action: fire-dom-event
                        event: webrtc-screenshot
                        target_id: upper-deck-popup-security
                    styles: |
                      ha-card {
                        display: flex !important;
                        flex-direction: row !important;
                        justify-content: center !important;
                      }
                      .bubble-button-card-container {
                        width: 52px !important;
                        height: 52px !important;
                      }
                      .bubble-background {
                        border-radius: 50% !important;
                        cursor: pointer !important;
                      }
                      .bubble-icon-container {
                        background-color: green !important;
                        width: 52px !important;
                        height: 52px !important;
                        margin: 0 !important;
                        pointer-events: none !important;
                      }
                      .bubble-icon {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      .bubble-name-container {
                        display: none !important;
                      }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: name
                    name: ''
                    icon: mdi:volume-off
                    show_state: false
                    show_name: false
                    button_action:
                      tap_action:
                        action: fire-dom-event
                        event: webrtc-toggle-mute
                        target_id: upper-deck-popup-security
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      ha-card {
                        display: flex !important;
                        flex-direction: row !important;
                        justify-content: center !important;
                      }
                      .bubble-button-card-container {
                        width: 52px !important;
                        height: 52px !important;
                      }
                      .bubble-background {
                        border-radius: 50% !important;
                        cursor: pointer !important;
                      }
                      .bubble-icon-container {
                        background-color: rgba(220, 38, 38, 1) !important;
                        width: 52px !important;
                        height: 52px !important;
                        margin: 0 !important;
                        position: relative;
                        transition: background-color 0.2s ease;
                        pointer-events: none !important;
                      }
                      .bubble-icon {
                        transition: color 0.2s ease, visibility 0.2s ease;
                      }
                      .bubble-icon {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      .bubble-name-container {
                        display: none !important;
                      }
                    card_mod:
                      style: >
                        /* Unmuted state (green) - when body has the unmuted
                        class */

                        :host-context(body.webrtc-unmuted-upper-deck-popup-security)
                        .bubble-icon-container {
                          background-color: green !important;
                        }

                        :host-context(body.webrtc-unmuted-upper-deck-popup-security)
                        .bubble-icon {
                          visibility: hidden;
                        }

                        /* Show volume-high icon when unmuted using ::after on
                        container */

                        :host-context(body.webrtc-unmuted-upper-deck-popup-security)
                        .bubble-icon-container::after {
                          content: '';
                          position: absolute;
                          top: 50%;
                          left: 50%;
                          transform: translate(-50%, -50%);
                          width: 24px;
                          height: 24px;
                          background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%23ffffff' d='M14,3.23V5.29C16.89,6.15 19,8.83 19,12C19,15.17 16.89,17.84 14,18.7V20.77C18,19.86 21,16.28 21,12C21,7.72 18,4.14 14,3.23M16.5,12C16.5,10.23 15.5,8.71 14,7.97V16C15.5,15.29 16.5,13.76 16.5,12M3,9V15H7L12,20V4L7,9H3Z'/%3E%3C/svg%3E") center/contain no-repeat;
                          pointer-events: none;
                        }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: switch
                    name: ''
                    entity: input_boolean.is_upper_deck_recording
                    show_state: false
                    show_name: false
                    button_action:
                      tap_action:
                        action: call-service
                        service: script.turn_on
                        target:
                          entity_id: script.upper_deck_manual_recording
                      hold_action:
                        action: none
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      ha-card {
                        display: flex !important;
                        flex-direction: row !important;
                        justify-content: center !important;
                      }
                      .bubble-button-card-container {
                        width: 52px !important;
                        height: 52px !important;
                      }
                      .bubble-background {
                        border-radius: 50% !important;
                        cursor: pointer !important;
                      }
                      .bubble-icon-container {
                        width: 52px !important;
                        height: 52px !important;
                        margin: 0 !important;
                        pointer-events: none !important;
                      }
                      .bubble-icon {
                        color: rgba(220, 38, 38, 0.85) !important;
                      }
                      .bubble-name-container {
                        display: none !important;
                      }
                      .is-on .bubble-icon-container {
                        background-color: red !important;
                      }
                      .bubble-icon {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                card_mod:
                  style: |
                    ha-card {
                      display: flex;
                      flex-direction: row;
                      justify-content: center;
                    }
          - type: vertical-stack
            grid_options:
              columns: full
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#camera-lower-deck'
                button_type: name
                show_icon: false
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                  .bubble-pop-up-background {
                    background-color: rgba(25, 36, 54, 0.55) !important;
                    filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.18);
                    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.15),
                        0 15px 40px rgba(0, 0, 0, 0.35);
                  }
              - type: custom:bubble-card
                card_type: separator
                name: Lower Deck Camera
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button: []
              - square: false
                type: grid
                grid_options:
                  columns: full
                cards:
                  - type: custom:webrtc-camera-sfenton
                    card_id: lower-deck-popup-security
                    shared: true
                    streams:
                      - url: lower_deck
                        mode: webrtc,webrtc/tcp,mse,hls,mjpeg
                        media: video,audio
                    style: |
                      ha-card {
                        aspect-ratio: 16 / 9;
                        height: auto;
                      }
                      .fullscreen,
                      .screenshot,
                      .header,
                      .volume,
                      .play,
                      .pictureinpicture {
                        display: none !important;
                      }
                    ui: true
                    muted: true
                    intersection: 0
                columns: 1
                card_mod:
                  style: |
                    :host {
                      display: grid;
                      width: 100%;
                      gap: 12px;
                      align-items: stretch;
                    }
              - type: grid
                columns: 3
                square: false
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: name
                    name: ''
                    icon: mdi:camera
                    show_state: false
                    show_name: false
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    button_action:
                      tap_action:
                        action: fire-dom-event
                        event: webrtc-screenshot
                        target_id: lower-deck-popup-security
                    styles: |
                      ha-card {
                        display: flex !important;
                        flex-direction: row !important;
                        justify-content: center !important;
                      }
                      .bubble-button-card-container {
                        width: 52px !important;
                        height: 52px !important;
                      }
                      .bubble-background {
                        border-radius: 50% !important;
                        cursor: pointer !important;
                      }
                      .bubble-icon-container {
                        background-color: green !important;
                        width: 52px !important;
                        height: 52px !important;
                        margin: 0 !important;
                        pointer-events: none !important;
                      }
                      .bubble-icon {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      .bubble-name-container {
                        display: none !important;
                      }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: name
                    name: ''
                    icon: mdi:volume-off
                    show_state: false
                    show_name: false
                    button_action:
                      tap_action:
                        action: fire-dom-event
                        event: webrtc-toggle-mute
                        target_id: lower-deck-popup-security
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      ha-card {
                        display: flex !important;
                        flex-direction: row !important;
                        justify-content: center !important;
                      }
                      .bubble-button-card-container {
                        width: 52px !important;
                        height: 52px !important;
                      }
                      .bubble-background {
                        border-radius: 50% !important;
                        cursor: pointer !important;
                      }
                      .bubble-icon-container {
                        background-color: rgba(220, 38, 38, 1) !important;
                        width: 52px !important;
                        height: 52px !important;
                        margin: 0 !important;
                        position: relative;
                        transition: background-color 0.2s ease;
                        pointer-events: none !important;
                      }
                      .bubble-icon {
                        transition: color 0.2s ease, visibility 0.2s ease;
                      }
                      .bubble-icon {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      .bubble-name-container {
                        display: none !important;
                      }
                    card_mod:
                      style: >
                        /* Unmuted state (green) - when body has the unmuted
                        class */

                        :host-context(body.webrtc-unmuted-lower-deck-popup-security)
                        .bubble-icon-container {
                          background-color: green !important;
                        }

                        :host-context(body.webrtc-unmuted-lower-deck-popup-security)
                        .bubble-icon {
                          visibility: hidden;
                        }

                        /* Show volume-high icon when unmuted using ::after on
                        container */

                        :host-context(body.webrtc-unmuted-lower-deck-popup-security)
                        .bubble-icon-container::after {
                          content: '';
                          position: absolute;
                          top: 50%;
                          left: 50%;
                          transform: translate(-50%, -50%);
                          width: 24px;
                          height: 24px;
                          background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%23ffffff' d='M14,3.23V5.29C16.89,6.15 19,8.83 19,12C19,15.17 16.89,17.84 14,18.7V20.77C18,19.86 21,16.28 21,12C21,7.72 18,4.14 14,3.23M16.5,12C16.5,10.23 15.5,8.71 14,7.97V16C15.5,15.29 16.5,13.76 16.5,12M3,9V15H7L12,20V4L7,9H3Z'/%3E%3C/svg%3E") center/contain no-repeat;
                          pointer-events: none;
                        }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: switch
                    name: ''
                    entity: input_boolean.is_lower_deck_recording
                    show_state: false
                    show_name: false
                    button_action:
                      tap_action:
                        action: call-service
                        service: script.turn_on
                        target:
                          entity_id: script.lower_deck_manual_recording
                      hold_action:
                        action: none
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      ha-card {
                        display: flex !important;
                        flex-direction: row !important;
                        justify-content: center !important;
                      }
                      .bubble-button-card-container {
                        width: 52px !important;
                        height: 52px !important;
                      }
                      .bubble-background {
                        border-radius: 50% !important;
                        cursor: pointer !important;
                      }
                      .bubble-icon-container {
                        width: 52px !important;
                        height: 52px !important;
                        margin: 0 !important;
                        pointer-events: none !important;
                      }
                      .bubble-icon {
                        color: rgba(220, 38, 38, 0.85) !important;
                      }
                      .bubble-name-container {
                        display: none !important;
                      }
                      .is-on .bubble-icon-container {
                        background-color: red !important;
                      }
                      .bubble-icon {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                card_mod:
                  style: |
                    ha-card {
                      display: flex;
                      flex-direction: row;
                      justify-content: center;
                    }
        column_span: 4
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: separator
            name: Mach-E
            card_layout: large
            rows: '01'
            grid_options:
              columns: full
          - type: custom:bubble-card
            card_type: button
            button_type: switch
            entity: lock.fordpass_3fmtk3su5mma09266_doorlock
            name: Doors
            show_state: true
            grid_options:
              columns: 6
              rows: auto
            tap_action:
              action: toggle
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            button_action: {}
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-main-icon-container {
                background: none !important;
                box-shadow: none !important;
                padding: 0 !important;
                width: auto !important;
                height: auto !important;
                pointer-events: none !important;
              }
        column_span: 4
      - type: grid
        cards:
          - type: custom:navbar-card
            layout:
              auto_padding:
                enabled: true
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .navbar-card.mobile {
                padding-bottom: calc(env(safe-area-inset-bottom, 0px));
              }
                          :host {
                            --navbar-background-color: rgba(25, 36, 54, 0.55);
                            --navbar-box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-desktop: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-mobile-floating: 0 24px 55px rgba(0, 0, 0, 0.55);
                          }
                          .navbar-card,
                          .navbar-card.desktop,
                          .navbar-card.mobile,
                          .navbar-card.desktop.bottom,
                          .navbar-card.desktop.top,
                          .navbar-card.desktop.left,
                          .navbar-card.desktop.right,
                          .navbar-card.mobile.floating,
                          ha-card.navbar-card {
                            background: rgba(25, 36, 54, 0.55) !important;
                            border: 1px solid rgba(255, 255, 255, 0.18) !important;
                            backdrop-filter: blur(20px);
                            -webkit-backdrop-filter: blur(20px);
                            box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45) !important;
                          }
            routes:
              - url: /at-a-glance/overview
                icon: mdi:home
                label: Home
                selected: |
                  [[[
                    const path = (location && location.pathname) || '';
                    const direct = ['/at-a-glance/security', '/at-a-glance/shopping-list', '/at-a-glance/chores'];
                    return !direct.some(prefix => path.startsWith(prefix));
                  ]]]
                hold_action: null
                badge:
                  show: false
                  count: null
                popup:
                  - icon: mdi:alert-circle-outline
                    label: ''
                    url: ''
              - url: /at-a-glance/security
                icon: mdi:shield
                label: Security
              - icon: mdi:shopping
                label: Shopping List
                url: /at-a-glance/shopping-list
              - icon: mdi:dots-horizontal
                label: More
                tap_action:
                  action: open-popup
                popup:
                  - icon: mdi:cog
                    url: /config/dashboard
                  - icon: mdi:hammer
                    url: /developer-tools/yaml
                  - icon: mdi:power
                    tap_action:
                      action: call-service
                      service: homeassistant.restart
                      service_data: {}
                      confirmation:
                        text: Are you sure you want to restart Home Assistant?
            media_player: {}
            desktop: {}
    cards: []
  - type: sections
    max_columns: 4
    title: Shopping List
    path: shopping-list
    icon: mdi:shopping
    style: |
      :host {
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
      }
      bubble-card {
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
        --bubble-icon-opacity: 1 !important;
        --bubble-icon-opacity-active: 1 !important;
        --bubble-icon-opacity-disabled: 1 !important;
      }
      bubble-card .bubble-icon,
      bubble-card .bubble-main-icon-container,
      bubble-card .bubble-main-icon-container ha-icon,
      bubble-card ha-icon,
      bubble-card .is-off .bubble-main-icon,
      bubble-card .is-off .bubble-main-icon-container,
      bubble-card .is-off ha-icon {
        color: white !important;
        fill: white !important;
        opacity: 1 !important;
        filter: none !important;
      }
      bubble-card .is-off .bubble-background,
      bubble-card .is-off .bubble-icon-container {
        background: rgba(255, 255, 255, 0.35) !important;
      }
    sections:
      - type: grid
        cards:
          - display_order: none
            type: todo-list
            entity: todo.shopping_list
            hide_completed: true
      - type: grid
        cards:
          - type: custom:navbar-card
            layout:
              mobile:
                mode: floating
                show_labels: false
              desktop:
                position: bottom
                show_labels: true
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .navbar-card.mobile {
                padding-bottom: calc(env(safe-area-inset-bottom, 0px));
              }
                          :host {
                            --navbar-background-color: rgba(25, 36, 54, 0.55);
                            --navbar-box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-desktop: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-mobile-floating: 0 24px 55px rgba(0, 0, 0, 0.55);
                          }
                          .navbar-card,
                          .navbar-card.desktop,
                          .navbar-card.mobile,
                          .navbar-card.desktop.bottom,
                          .navbar-card.desktop.top,
                          .navbar-card.desktop.left,
                          .navbar-card.desktop.right,
                          .navbar-card.mobile.floating,
                          ha-card.navbar-card {
                            background: rgba(25, 36, 54, 0.55) !important;
                            border: 1px solid rgba(255, 255, 255, 0.18) !important;
                            backdrop-filter: blur(20px);
                            -webkit-backdrop-filter: blur(20px);
                            box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45) !important;
                          }
            routes:
              - url: /at-a-glance/overview
                icon: mdi:home
                label: Home
                selected: |
                  [[[
                    const path = (location && location.pathname) || '';
                    const direct = ['/at-a-glance/security', '/at-a-glance/shopping-list', '/at-a-glance/chores'];
                    return !direct.some(prefix => path.startsWith(prefix));
                  ]]]
              - url: /at-a-glance/security
                icon: mdi:shield
                label: Security
              - url: /at-a-glance/shopping-list
                icon: mdi:shopping
                label: Shopping List
              - icon: mdi:dots-horizontal
                label: More
                tap_action:
                  action: open-popup
                popup:
                  - icon: mdi:cog
                    url: /config/dashboard
                  - icon: mdi:hammer
                    url: /developer-tools/yaml
                  - icon: mdi:power
                    tap_action:
                      action: call-service
                      service: homeassistant.restart
                      service_data: {}
                      confirmation:
                        text: Are you sure you want to restart Home Assistant?
            media_player: {}
            desktop: {}
    header:
      card:
        type: tile
        grid_options:
          columns: full
          rows: 1
        entity: vacuum.roborock_s7_maxv
        name: Shopping List
        hide_state: true
        vertical: false
        tap_action:
          action: none
        icon_tap_action:
          action: none
        features_position: bottom
        card_mod:
          style:
            ha-tile-icon $: |
              div.container {
                height: 40px;
                width: 40px;
                border-radius: 20%;
                --mdc-icon-size: 40px;
              }
            .: |
              ha-card {
                border: none !important;
                box-shadow: none !important;
                background: none !important;
                padding: 0 !important;
                transition: none !important;

                font-size: 64
                #font-weight: 800

                --ha-card-background: transparent;
                box-shadow: none !important;
                border: none !important;
                --ha-tile-info-primary-font-size: 2.2rem;
                --ha-tile-info-primary-font-weight: 800;          --ha-tile-info-primary-line-height: 1.2;
                padding: 0 !important;
              }
              ha-tile-icon {
                display: none;
              }
              hui-badges-row {
                margin-bottom: 8px !important; /* Adjust this value */
              }
              ha-card::before {
                content: none !important;
                display: none !important;     # suppress ripple/backdrop
              }
      layout: start
      badges_position: bottom
      badges_wrap: wrap
  - type: sections
    max_columns: 4
    title: Chores
    path: chores
    icon: mdi:broom
    style: |
      :host {
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
      }
      bubble-card {
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
        --bubble-icon-opacity: 1 !important;
        --bubble-icon-opacity-active: 1 !important;
        --bubble-icon-opacity-disabled: 1 !important;
      }
      bubble-card .bubble-icon,
      bubble-card .bubble-main-icon-container,
      bubble-card .bubble-main-icon-container ha-icon,
      bubble-card ha-icon,
      bubble-card .is-off .bubble-main-icon,
      bubble-card .is-off .bubble-main-icon-container,
      bubble-card .is-off ha-icon {
        color: white !important;
        fill: white !important;
        opacity: 1 !important;
        filter: none !important;
      }
      bubble-card .is-off .bubble-background,
      bubble-card .is-off .bubble-icon-container {
        background: rgba(255, 255, 255, 0.35) !important;
      }
    sections:
      - type: grid
        cards:
          - type: tile
            grid_options:
              columns: full
              rows: 1
            entity: vacuum.roborock_s7_maxv
            name: Your Chores
            hide_state: true
            vertical: false
            tap_action:
              action: none
            icon_tap_action:
              action: none
            features_position: bottom
            card_mod:
              style:
                ha-tile-icon $: |
                  div.container {
                    height: 40px;
                    width: 40px;
                    border-radius: 20%;
                    --mdc-icon-size: 40px;
                  }
                .: |
                  ha-card {
                    border: none !important;
                    box-shadow: none !important;
                    background: none !important;
                    padding: 0 !important;
                    transition: none !important;

                    font-size: 64
                    #font-weight: 800

                    --ha-card-background: transparent;
                    box-shadow: none !important;
                    border: none !important;
                    --ha-tile-info-primary-font-size: 1.5rem;
                    --ha-tile-info-primary-font-weight: 800;          --ha-tile-info-primary-line-height: 1.2;
                    padding: 0 !important;
                    margin-top: 1.5rem !important;
                  }
                  ha-tile-icon {
                    display: none;
                  }
                  ha-card::before {
                    content: none !important;
                    display: none !important;     # suppress ripple/backdrop
                  }
          - display_order: duedate_asc
            type: todo-list
            entity: todo.stephen_s_tasks
            hide_completed: true
            visibility:
              - condition: user
                users:
                  - 64089b5683944c39b4f944c8f76830b0
      - type: grid
        cards:
          - type: custom:navbar-card
            layout:
              mobile:
                mode: floating
                show_labels: false
              desktop:
                position: bottom
                show_labels: true
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .navbar-card.mobile {
                padding-bottom: calc(env(safe-area-inset-bottom, 0px));
              }
                          :host {
                            --navbar-background-color: rgba(25, 36, 54, 0.55);
                            --navbar-box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-desktop: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-mobile-floating: 0 24px 55px rgba(0, 0, 0, 0.55);
                          }
                          .navbar-card,
                          .navbar-card.desktop,
                          .navbar-card.mobile,
                          .navbar-card.desktop.bottom,
                          .navbar-card.desktop.top,
                          .navbar-card.desktop.left,
                          .navbar-card.desktop.right,
                          .navbar-card.mobile.floating,
                          ha-card.navbar-card {
                            background: rgba(25, 36, 54, 0.55) !important;
                            border: 1px solid rgba(255, 255, 255, 0.18) !important;
                            backdrop-filter: blur(20px);
                            -webkit-backdrop-filter: blur(20px);
                            box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45) !important;
                          }
            routes:
              - url: /at-a-glance/overview
                icon: mdi:home
                label: Home
                selected: |
                  [[[
                    const path = (location && location.pathname) || '';
                    const direct = ['/at-a-glance/security', '/at-a-glance/shopping-list', '/at-a-glance/chores'];
                    return !direct.some(prefix => path.startsWith(prefix));
                  ]]]
              - url: /at-a-glance/security
                icon: mdi:shield
                label: Security
              - url: /at-a-glance/shopping-list
                icon: mdi:shopping
                label: Shopping List
              - icon: mdi:dots-horizontal
                label: More
                tap_action:
                  action: open-popup
                popup:
                  - icon: mdi:cog
                    url: /config/dashboard
                  - icon: mdi:hammer
                    url: /developer-tools/yaml
                  - icon: mdi:power
                    tap_action:
                      action: call-service
                      service: homeassistant.restart
                      service_data: {}
                      confirmation:
                        text: Are you sure you want to restart Home Assistant?
            media_player: {}
            desktop: {}
    header:
      card:
        type: tile
        grid_options:
          columns: full
          rows: 1
        entity: vacuum.roborock_s7_maxv
        name: Chores
        hide_state: true
        vertical: false
        tap_action:
          action: none
        icon_tap_action:
          action: none
        features_position: bottom
        card_mod:
          style:
            ha-tile-icon $: |
              div.container {
                height: 40px;
                width: 40px;
                border-radius: 20%;
                --mdc-icon-size: 40px;
              }
            .: |
              ha-card {
                border: none !important;
                box-shadow: none !important;
                background: none !important;
                padding: 0 !important;
                transition: none !important;

                font-size: 64
                #font-weight: 800

                --ha-card-background: transparent;
                box-shadow: none !important;
                border: none !important;
                --ha-tile-info-primary-font-size: 2.2rem;
                --ha-tile-info-primary-font-weight: 800;          --ha-tile-info-primary-line-height: 1.2;
                padding: 0 !important;
              }
              ha-tile-icon {
                display: none;
              }
              hui-badges-row {
                margin-bottom: 8px !important; /* Adjust this value */
              }
              ha-card::before {
                content: none !important;
                display: none !important;     # suppress ripple/backdrop
              }
      layout: start
      badges_position: bottom
      badges_wrap: wrap
  - title: Living Room
    path: living-room
    type: sections
    style: |
      :host {
        --view-padding: 0 16px !important;
        --lovelace-view-margin: 0 16px !important;
        position: relative;
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
      }
      bubble-card {
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
        --bubble-icon-opacity: 1 !important;
        --bubble-icon-opacity-active: 1 !important;
        --bubble-icon-opacity-disabled: 1 !important;
      }
      bubble-card .bubble-icon,
      bubble-card .bubble-main-icon-container,
      bubble-card .bubble-main-icon-container ha-icon,
      bubble-card ha-icon,
      bubble-card .is-off .bubble-main-icon,
      bubble-card .is-off .bubble-main-icon-container,
      bubble-card .is-off ha-icon {
        color: white !important;
        fill: white !important;
        opacity: 1 !important;
        filter: none !important;
      }
      bubble-card .is-off .bubble-background,
      bubble-card .is-off .bubble-icon-container {
        background: rgba(255, 255, 255, 0.35) !important;
      }
      :host::before {
        content: "";
        position: fixed;
        inset: 0;
        background-image: url("media-source://image_upload/b9449f15a0e0c05ad7c84ebd806b883c");
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
        filter: blur(18px) saturate(140%);
        transform: scale(1.05);     /* avoids clipping after blur */
        z-index: -2;
      }
      :host::after {
        content: "";
        position: fixed;
        inset: 0;
        background: rgba(12, 18, 28, 0.35);  /* frosted tint */
        backdrop-filter: blur(8px);
        z-index: -1;
      }
      hui-view-header,
      hui-section-heading-row,
      hui-section-heading-tile {
        display: none !important;
      }
    sections:
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: button
            button_type: name
            show_name: false
            show_state: false
            show_icon: true
            icon: mdi:chevron-left
            tap_action:
              action: fire-dom-event
              browser_mod:
                service: browser_mod.javascript
                data:
                  code: history.back()
            button_action:
              tap_action:
                action: fire-dom-event
                browser_mod:
                  service: browser_mod.javascript
                  data:
                    code: history.back()
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .bubble-icon,
              .bubble-main-icon,
              .bubble-main-icon-container ha-icon {
                color: white !important;
                opacity: 1 !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-button-card-container {
                display: flex !important;
                align-items: center !important;
                justify-content: flex-start !important;
                padding: 0 !important;
                border: 0 !important;
                background: transparent !important;
                box-shadow: none !important;
                cursor: pointer;
                margin-left: -16px !important;
              }
              .bubble-button-card-container:hover,
              .bubble-button-card-container:focus,
              .bubble-button-card-container:active {
                background: transparent !important;
                box-shadow: none !important;
                filter: none !important;
              }


              .bubble-icon-container {
                background: transparent !important;
                box-shadow: none !important;
              }

              .bubble-icon {
                --mdc-icon-size: 36px !important;
                padding: 0 !important;
              }
            grid_options:
              columns: 2
              rows: auto
          - type: markdown
            content: '# Living Room'
            text_only: true
            card_mod:
              style: |
                ha-card {
                  display: flex;
                  align-items: center;   # vertical center
                  justify-content: center;  # optional horizontal center
                  height: 100%;
                  padding: 0;
                  margin-left: -32px !important;
                  --card-mod-script: |
                    if (window.__bubbleForceWhiteInit) {
                      return;
                    }
                    window.__bubbleForceWhiteInit = true;
                    const styleId = 'bubble-force-white-style';
                    const cssLines = [
                      '.bubble-icon,',
                      '.bubble-main-icon,',
                      '.bubble-main-icon-container,',
                      '.bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.is-off .bubble-icon,',
                      '.is-off .bubble-main-icon,',
                      '.is-off .bubble-main-icon-container,',
                      '.is-off .bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.ha-markdown-element {',
                      '  color: white !important',
                      '}',
                    ];
                    const css = cssLines.join('\n');
                    const touchIcons = (root) => {
                      if (!root) {
                        return;
                      }
                      root.querySelectorAll('.bubble-icon, .bubble-main-icon, .bubble-main-icon-container ha-icon').forEach((icon) => {
                        icon.style.setProperty('color', 'white', 'important');
                        icon.style.setProperty('fill', 'white', 'important');
                        icon.style.setProperty('opacity', '1', 'important');
                        icon.style.removeProperty('filter');
                      });
                    };
                    const applyStyles = (card) => {
                      if (!card) {
                        return;
                      }
                      const root = card.shadowRoot || card;
                      if (!root) {
                        return;
                      }
                      if (!root.getElementById(styleId)) {
                        const style = document.createElement('style');
                        style.id = styleId;
                        style.textContent = css;
                        root.appendChild(style);
                      }
                      touchIcons(root);
                    };
                    const registeredRoots = new Set();
                    const registerRoot = (root) => {
                      if (
                        root &&
                        typeof root.querySelectorAll === 'function' &&
                        !registeredRoots.has(root)
                      ) {
                        registeredRoots.add(root);
                      }
                    };
                    const scan = () => {
                      registeredRoots.forEach((root) => {
                        root.querySelectorAll('bubble-card').forEach(applyStyles);
                        root.querySelectorAll('*').forEach((el) => {
                          if (el.shadowRoot) {
                            registerRoot(el.shadowRoot);
                          }
                        });
                      });
                    };
                    registerRoot(document);
                    registerRoot(document.body);
                    registerRoot(document.documentElement);
                    scan();
                    window.__bubbleForceWhiteInterval = window.setInterval(() => {
                      scan();
                    }, 750);
                }
                ha-markdown {
                  margin: 0;
                  width: 100%;
                  text-align: center;    # drop if you only want vertical centering
                   color: white !important;
                }
            grid_options:
              columns: 6
              rows: auto
          - type: custom:swipe-card
            grid_options:
              columns: full
              rows: 1
            parameters:
              slidesPerView: auto
              spaceBetween: 12
              freeMode: true
              freeModeSticky: false
              mousewheel: true
            style: |
              margin-bottom: 10px !important;
            cards:
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: light.living_room
                name: Lights
                show_state: true
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    --lights-color: ${(() => {
                      const light = hass.states[entity];
                      if (!light) {
                        return 'rgba(255, 255, 255, 0.35)';
                      }
                      const state = light.state;
                      if (state === 'off') {
                        return '#1e88e5';
                      }
                      if (state === 'unavailable') {
                        return 'rgba(120, 120, 120, 0.6)';
                      }
                      const attrs = light.attributes || {};
                      const rgb = attrs.rgb_color;
                      if (Array.isArray(rgb) && rgb.length === 3) {
                        const [r, g, b] = rgb;
                        return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                      }
                      const hs = attrs.hs_color;
                      if (Array.isArray(hs) && hs.length === 2) {
                        const hue = hs[0];
                        const sat = (hs[1] || 0) / 100;
                        const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                        const c = brightness * sat;
                        const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                        const m = brightness - c;
                        let r1 = 0;
                        let g1 = 0;
                        let b1 = 0;
                        if (hue >= 0 && hue < 60) {
                          r1 = c;
                          g1 = x;
                        } else if (hue < 120) {
                          r1 = x;
                          g1 = c;
                        } else if (hue < 180) {
                          g1 = c;
                          b1 = x;
                        } else if (hue < 240) {
                          g1 = x;
                          b1 = c;
                        } else if (hue < 300) {
                          r1 = x;
                          b1 = c;
                        } else {
                          r1 = c;
                          b1 = x;
                        }
                        const r = Math.round((r1 + m) * 255);
                        const g = Math.round((g1 + m) * 255);
                        const b = Math.round((b1 + m) * 255);
                        return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                      }
                      const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                      if (temp) {
                        const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                        const kelvin = clamp(temp, 2000, 6500);
                        const t = kelvin / 100;
                        let r;
                        let g;
                        let b;
                        if (t <= 66) {
                          r = 255;
                          g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                        } else {
                          r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                          g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                        }
                        if (t >= 66) {
                          b = 255;
                        } else if (t <= 19) {
                          b = 0;
                        } else {
                          b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                        }
                        return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                      }
                      return 'rgba(255, 255, 255, 0.35)';
                    })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--lights-color) !important;
                  }
                tap_action:
                  action: navigate
                  navigation_path: '#lights-living-room'
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#lights-living-room'
                card_mod:
                  style: >
                    :host {
                      width: auto;
                      max-width: 130px;
                      flex: 0 0 auto;
                      margin-bottom: 10px !important;
                      --bubble-icon-color: white;          # primary icon color
                      --bubble-icon-color-active: white;   # when entity is "on"
                      --bubble-icon-color-disabled: white;
                      --bubble-button-spacing: 0px;   /* no gap between icon and text */
                    }

                    .bubble-main-icon-container {
                      background: none !important;
                      box-shadow: none !important;
                      padding: 0 !important;
                      width: auto !important;
                      height: auto !important;
                      pointer-events: none !important;
                    }

                    .bubble-main-icon-container ha-icon {
                      width: 24px;   /* or any size you need */
                      height: 24px;
                      color: white !important;
                    }

                    .bubble-main-icon-container ha-ripple,

                    .bubble-main-icon-container .bubble-icon-feedback-container
                    {
                      display: none !important;   /* remove ripple/feedback layers */
                    }
              - type: custom:bubble-card
                card_type: button
                button_type: state
                entity: input_text.living_room_climate_range
                icon: mdi:thermometer
                name: Climate
                show_state: true
                modules:
                  - frosted_glass
                  - get_state_attribute
                get_state_attribute:
                  - entity: input_text.living_room_climate_range
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    width: auto;
                    max-width: 180px;
                    flex: 0 0 auto;
                    margin-bottom: 10px !important;
                    --climate-color: ${(() => {
                      const color = hass.states['input_text.living_room_climate_color']?.state?.trim();
                      return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                    })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--climate-color) !important;
                  }

                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#climate-living-room'
                  hold_action:
                    action: none
                icon_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#climate-living-room'
                  hold_action:
                    action: none
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: binary_sensor.living_room_presence_sensor_occupancy
                name: Occupancy
                icon: mdi:motion-sensor
                show_state: true
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    --occupancy-color: ${(() => {
                        const securityEntity = 'alarm_control_panel.aqara_hub_m3_0056_security_system_2';
                        const occState = hass.states[entity]?.state;
                        const securityState = hass.states[securityEntity]?.state;
                        const occupiedStates = ['on', 'detected', 'occupied'];
                        const clearStates = ['off', 'clear', 'standby'];
                        if (clearStates.includes(occState)) {
                          return '#43a047';
                        }
                        if (occupiedStates.includes(occState) && securityState === 'armed_away') {
                          return '#e53935';
                        }
                        if (occupiedStates.includes(occState)) {
                          return '#1e88e5';
                        }
                        if (occState === 'unavailable') {
                          return 'rgba(120, 120, 120, 0.6)';
                        }
                        return '#546e7a';
                      })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--occupancy-color) !important;
                  }
                card_mod:
                  style: >
                    :host {
                      width: auto;
                      max-width: 150px;
                      flex: 0 0 auto;
                      margin-bottom: 10px !important;
                      --bubble-icon-color: white;          # primary icon color
                      --bubble-icon-color-active: white;   # when entity is "on"
                      --bubble-icon-color-disabled: white;    # when unavailable
                    }

                    .bubble-main-icon-container {
                      background: none !important;
                      box-shadow: none !important;
                      padding: 0 !important;
                      width: auto !important;
                      height: auto !important;
                      pointer-events: none !important;
                    }

                    .bubble-main-icon-container ha-icon {
                      width: 24px;   /* or any size you need */
                      height: 24px;
                      color: white !important;
                    }

                    .bubble-main-icon-container ha-ripple,

                    .bubble-main-icon-container .bubble-icon-feedback-container
                    {
                      display: none !important;   /* remove ripple/feedback layers */
                    }
        column_span: 4
      - type: grid
        cards:
          - type: vertical-stack
            grid_options:
              columns: full
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#lights-living-room'
                button_type: name
                show_icon: false
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                  .bubble-pop-up-background {
                    background-color: rgba(25, 36, 54, 0.55) !important;
                    filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.18);
                    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.15),
                        0 15px 40px rgba(0, 0, 0, 0.35);
                  }
              - type: custom:bubble-card
                card_type: separator
                name: Living Room Lights
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button:
                  - entity: light.living_room
                    tap_action:
                      action: toggle
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_11
                    name: Front Left Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_23
                    name: Front Right Light
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_14
                    name: Back Left Light
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_12
                    name: Back Right Light
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                columns: 2
        column_span: 4
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: separator
            name: Climate
            card_layout: large
            rows: '01'
            grid_options:
              columns: full
            sub_button: []
          - type: custom:bubble-card
            card_type: button
            button_type: switch
            entity: cover.living_room_vents
            icon: mdi:air-filter
            tap_action:
              action: perform-action
              perform_action: cover.toggle_cover_tilt
              target:
                entity_id: cover.living_room_vents
            button_action:
              tap_action:
                action: perform-action
                perform_action: cover.toggle_cover_tilt
                target:
                  entity_id: cover.living_room_vents
            grid_options:
              columns: 6
              rows: auto
            name: Vents
            show_state: true
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-main-icon-container {
                background: none !important;
                box-shadow: none !important;
                padding: 0 !important;
                width: auto !important;
                height: auto !important;
                pointer-events: none !important;
              }
          - type: custom:bubble-card
            card_type: button
            button_type: state
            entity: fan.living_room_purifier
            grid_options:
              columns: 6
              rows: auto
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            name: Air Purifier
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-main-icon-container {
                background: none !important;
                box-shadow: none !important;
                padding: 0 !important;
                width: auto !important;
                height: auto !important;
                pointer-events: none !important;
              }
        column_span: 4
      - type: grid
        cards:
          - type: vertical-stack
            grid_options:
              columns: full
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#climate-living-room'
                button_type: name
                show_icon: false
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                  .bubble-pop-up-background {
                    background-color: rgba(25, 36, 54, 0.55) !important;
                    filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.18);
                    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.15),
                        0 15px 40px rgba(0, 0, 0, 0.35);
                  }
              - type: custom:bubble-card
                card_type: separator
                name: Living Room Climate
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button: []
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: >-
                      sensor.hallway_entryway_living_room_presence_sensor_temperature
                    name: Entryway
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.entryway_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                    show_icon: true
                    show_name: true
                    force_icon: false
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.living_room_presence_sensor_temperature
                    name: Living Room
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.living_room_presence_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.living_room_temperature
                    name: Ecobee
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.living_room_ecobee_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                columns: 2
        column_span: 4
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: separator
            name: Devices
            card_layout: large
            rows: '01'
            grid_options:
              columns: full
            sub_button: []
          - type: custom:bubble-card
            card_type: button
            entity: vacuum.roborock_s7_maxv
            name: Roborock
            show_state: true
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            sub_button: []
            button_type: switch
            tap_action:
              action: navigate
              navigation_path: '#roborock-popup'
            button_action:
              tap_action:
                action: navigate
                navigation_path: '#roborock-popup'
            grid_options:
              columns: 12
              rows: 2
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-main-icon-container {
                background: none !important;
                box-shadow: none !important;
                padding: 0 !important;
                width: auto !important;
                height: auto !important;
                pointer-events: none !important;
              }
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#roborock-popup'
                button_type: switch
                entity: vacuum.roborock_s7_maxv
                name: Roborock
                show_icon: false
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                  .bubble-pop-up-background {
                    background-color: rgba(25, 36, 54, 0.55) !important;
                    filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.18);
                    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.15),
                        0 15px 40px rgba(0, 0, 0, 0.35);
                  }
              - type: custom:bubble-card
                card_type: button
                button_type: state
                entity: image.roborock_s7_maxv_map_0_custom
                show_state: false
                show_icon: false
                show_name: false
                card_layout: large
                rows: 6
                sub_button:
                  - name: Master Bedroom
                    icon: mdi:bed-double
                    tap_action:
                      action: perform-action
                      perform_action: input_boolean.toggle
                      target:
                        entity_id: input_boolean.roborock_master_bedroom_toggle
                    entity: input_boolean.roborock_master_bedroom_toggle
                  - name: Hallway
                    icon: mdi:walk
                    tap_action:
                      action: perform-action
                      perform_action: input_boolean.toggle
                      target:
                        entity_id: input_boolean.roborock_hallway_toggle
                    entity: input_boolean.roborock_hallway_toggle
                  - name: Guest Bedroom
                    icon: mdi:bed-queen
                    tap_action:
                      action: perform-action
                      perform_action: input_boolean.toggle
                      target:
                        entity_id: input_boolean.roborock_guest_room_toggle
                    entity: input_boolean.roborock_guest_room_toggle
                  - name: Kitchen
                    icon: mdi:silverware-fork-knife
                    tap_action:
                      action: perform-action
                      perform_action: input_boolean.toggle
                      target:
                        entity_id: input_boolean.roborock_kitchen_toggle
                    entity: input_boolean.roborock_kitchen_toggle
                  - name: Living Room
                    icon: mdi:sofa
                    tap_action:
                      action: perform-action
                      perform_action: input_boolean.toggle
                      target:
                        entity_id: input_boolean.roborock_living_room_toggle
                    entity: input_boolean.roborock_living_room_toggle
                  - name: Dining
                    icon: mdi:table-chair
                    tap_action:
                      action: perform-action
                      perform_action: input_boolean.toggle
                      target:
                        entity_id: input_boolean.roborock_dining_room_toggle
                    show_state: false
                    show_attribute: false
                    entity: input_boolean.roborock_dining_room_toggle
                  - name: Master Bath
                    icon: mdi:shower
                    tap_action:
                      action: perform-action
                      perform_action: input_boolean.toggle
                      target:
                        entity_id: input_boolean.roborock_master_bathroom_toggle
                    entity: input_boolean.roborock_master_bathroom_toggle
                  - name: Guest Bath
                    icon: mdi:shower-head
                    tap_action:
                      action: perform-action
                      perform_action: input_boolean.toggle
                      target:
                        entity_id: input_boolean.roborock_guest_bathroom_toggle
                    entity: input_boolean.roborock_guest_bathroom_toggle
                  - name: Office
                    icon: mdi:desk
                    tap_action:
                      action: perform-action
                      perform_action: input_boolean.toggle
                      target:
                        entity_id: input_boolean.roborock_office_toggle
                    entity: input_boolean.roborock_office_toggle
                  - name: Gym
                    icon: mdi:weight-lifter
                    tap_action:
                      action: perform-action
                      perform_action: input_boolean.toggle
                      target:
                        entity_id: input_boolean.roborock_gym_toggle
                    entity: input_boolean.roborock_gym_toggle
                    show_state: false
                styles: >
                  .bubble-main-icon {
                    color: white !important;
                  } .is-off .bubble-background, .is-unavailable
                  .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  } .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  } .bubble-name, .bubble_name {
                    color: white !important;
                  } .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  } ha-card {
                    padding: 0 !important;
                  }

                  .bubble-button-card-container {
                    width: 100% !important;
                    position: relative !important;
                    overflow: hidden !important;
                  }

                  .bubble-background {
                    background: ${(() => {
                      const mapEntity =
                        hass.states['input_text.roborock_current_map_entity']?.state?.trim() ||
                        'image.roborock_s7_maxv_map_0_custom';
                      const url = hass.states[mapEntity]?.attributes?.entity_picture || '';
                          if (!url) {
                            return 'none';
                          }
                          const bust = hass.states[mapEntity]?.last_changed?.valueOf?.() || Date.now();
                          const sep = url.includes('?') ? '&' : '?';
                          return `url("${url}${sep}v=${bust}") center / contain no-repeat`;
                    })()} !important;
                    filter: none !important;
                    transform: scale(1.4);
                    transform-origin: center center;
                  }


                  .bubble-wrapper {
                    backdrop-filter: none !important;
                  }

                  .bubble-sub-button-container {
                    position: absolute !important;
                    inset: 0;
                    pointer-events: none;                 /* keep default taps working elsewhere */
                    display: ${(() => {
                      const mapEntity =
                        hass.states['input_text.roborock_current_map_entity']?.state?.trim() ||
                        'image.roborock_s7_maxv_map_0_custom';
                      return mapEntity === 'image.roborock_s7_maxv_map_0_custom' ? 'block' : 'none';
                    })()} !important;                    /* hide chips when not on Map 0 */
                  }

                  .bubble-sub-button {
                    position: absolute !important;
                    pointer-events: auto;                 /* re-enable clicks on the chips */
                    transform: translate(-50%, -50%);
                    background: rgba(0, 0, 0, 0.55);
                    color: #fff;
                    border-radius: 18px;
                  }

                  .bubble-sub-button-icon {
                    margin-right: 0px;
                  }

                  /* room anchors (percentages derived from 1496  2416 map) */

                  .bubble-sub-button-1 { left: 58%; top: 19%; }   /* Master
                  Bedroom */

                  .bubble-sub-button-2 { left: 48%; top: 40%; }   /* Hallway */

                  .bubble-sub-button-3 { left: 39%; top: 33%; }   /* Guest
                  Bedroom */

                  .bubble-sub-button-4 { left: 59%; top: 67%; }   /* Kitchen */

                  .bubble-sub-button-5 { left: 41%; top: 82%; }   /* Living Room
                  */

                  .bubble-sub-button-6 { left: 59%; top: 86%; }   /* Dining */

                  .bubble-sub-button-7 { left: 64%; top: 47%; }   /* Master Bath
                  */

                  .bubble-sub-button-8 { left: 55%; top: 46%; }   /* Guest Bath
                  */

                  .bubble-sub-button-9 { left: 39%; top: 13%; }   /* Office */

                  .bubble-sub-button-10 { left: 39%; top: 50%; }   /* Gym */

                  .bubble-sub-button-1.is-on,

                  .bubble-sub-button-1.background-on,

                  .bubble-sub-button-2.is-on,

                  .bubble-sub-button-2.background-on,

                  .bubble-sub-button-3.is-on,

                  .bubble-sub-button-3.background-on,

                  .bubble-sub-button-4.is-on,

                  .bubble-sub-button-4.background-on,

                  .bubble-sub-button-5.is-on,

                  .bubble-sub-button-5.background-on,

                  .bubble-sub-button-6.is-on,

                  .bubble-sub-button-6.background-on,

                  .bubble-sub-button-7.is-on,

                  .bubble-sub-button-7.background-on,

                  .bubble-sub-button-8.is-on,

                  .bubble-sub-button-8.background-on,

                  .bubble-sub-button-9.is-on,

                  .bubble-sub-button-9.background-on,

                  .bubble-sub-button-10.is-on,

                  .bubble-sub-button-10.background-on {
                    background: purple !important;
                  }
                modules: []
                button_action:
                  hold_action:
                    action: none
                  tap_action:
                    action: none
              - type: horizontal-stack
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: switch
                    entity: image.roborock_s7_maxv_map_0_custom
                    name: Main Floor
                    icon: mdi:home
                    force_icon: false
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                      hold_action:
                        action: none
                    sub_button:
                      - entity: image.roborock_s7_maxv_map_0_custom
                        icon: mdi:home
                        show_icon: true
                        tap_action:
                          action: perform-action
                          perform_action: select.select_option
                          target:
                            entity_id: select.roborock_s7_maxv_selected_map
                          data:
                            option: Map 0
                        show_last_changed: false
                        state_background: false
                      - entity: image.roborock_s7_maxv_music_room_custom
                        icon: mdi:guitar-electric
                        tap_action:
                          action: perform-action
                          perform_action: select.select_option
                          target:
                            entity_id: select.roborock_s7_maxv_selected_map
                          data:
                            option: Music Room
                      - entity: image.roborock_s7_maxv_theater_room_custom
                        icon: mdi:projector
                        tap_action:
                          action: perform-action
                          perform_action: select.select_option
                          target:
                            entity_id: select.roborock_s7_maxv_selected_map
                          data:
                            option: Theater Room
                    show_icon: false
                    show_name: false
                    scrolling_effect: false
                    modules: []
                    styles: |-
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --ha-card-background: transparent !important;
                        --ha-card-border: 0 !important;
                        --ha-card-box-shadow: none !important;
                        --bubble-main-background-color: transparent !important;
                        --bubble-secondary-background-color: transparent !important;
                        --bubble-button-main-background-color: transparent !important;
                        --bubble-sub-button-background-color: purple !important;
                        --bubble-box-shadow: none !important;
                      }
                      .bubble-card,
                      .bubble-background,
                      .bubble-button,
                      .bubble-button-card-container,
                      .bubble-background-color,
                      .bubble-button::after {
                        background: transparent !important;
                        box-shadow: none !important;
                      }
                      .bubble-sub-button {
                        display: flex;
                        margin-left: 8px !important;
                        justify-content: center;
                        width: 100% !important;
                      }
                      .bubble-sub-button-container {
                        flex: 1 !important;
                      }
                      .bubble-content-container {
                        display: none !important;
                      }
                      .bubble-sub-button-1,
                      .bubble-sub-button-2,
                      .bubble-sub-button-3 {
                        transition: background 200ms ease;
                        background: transparent;
                      }
                      .bubble-sub-button-1 {
                        background: ${(() => {
                          const current =
                            hass.states['input_text.roborock_current_map_entity']?.state?.trim() ||
                            'image.roborock_s7_maxv_map_0_custom';
                          return current === 'image.roborock_s7_maxv_map_0_custom'
                            ? 'var(--bubble-sub-button-background-color, rgba(255,255,255,0.15))'
                            : 'transparent';
                        })()} !important;
                      }
                      .bubble-sub-button-2 {
                        background: ${(() => {
                          const current =
                            hass.states['input_text.roborock_current_map_entity']?.state?.trim() ||
                            'image.roborock_s7_maxv_map_0_custom';
                          return current === 'image.roborock_s7_maxv_music_room_custom'
                            ? 'var(--bubble-sub-button-background-color, rgba(255,255,255,0.15))'
                            : 'transparent';
                        })()} !important;
                      }
                      .bubble-sub-button-3 {
                        background: ${(() => {
                          const current =
                            hass.states['input_text.roborock_current_map_entity']?.state?.trim() ||
                            'image.roborock_s7_maxv_map_0_custom';
                          return current === 'image.roborock_s7_maxv_theater_room_custom'
                            ? 'var(--bubble-sub-button-background-color, rgba(255,255,255,0.15))'
                            : 'transparent';
                        })()} !important;
                      }
              - type: horizontal-stack
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: switch
                    entity: vacuum.roborock_s7_maxv
                    name: Power Settings
                    show_icon: false
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                      hold_action:
                        action: none
                    sub_button:
                      - entity: select.roborock_suction
                        icon: mdi:robot-vacuum-variant
                        show_name: false
                      - entity: select.roborock_s7_maxv_mop_intensity
                        icon: mdi:water
                        show_name: false
                    modules:
                      - get_state_attribute
                    get_state_attribute:
                      - entity: vacuum.roborock_s7_maxv
                        attribute: fan_speed
                      - entity: select.roborock_s7_maxv_mop_intensity
                    show_state: true
                    force_icon: false
                    scrolling_effect: true
              - type: horizontal-stack
                cards:
                  - type: conditional
                    conditions:
                      - entity: vacuum.roborock_s7_maxv
                        state_not: cleaning
                      - entity: vacuum.roborock_s7_maxv
                        state_not: returning
                      - entity: vacuum.roborock_s7_maxv
                        state_not: paused
                      - entity: vacuum.roborock_s7_maxv
                        state_not: charging
                      - entity: vacuum.roborock_s7_maxv
                        state_not: error
                    card:
                      type: custom:bubble-card
                      card_type: button
                      button_type: state
                      entity: vacuum.roborock_s7_maxv
                      name: Clean
                      show_icon: false
                      show_state: true
                      force_icon: false
                      tap_action:
                        action: none
                      button_action:
                        tap_action:
                          action: none
                      sub_button:
                        - name: Clean
                          icon: mdi:play
                          tap_action:
                            action: perform-action
                            perform_action: automation.trigger
                            target:
                              entity_id: automation.vacuum_clean_button_automation
                          button_action:
                            tap_action:
                              action: perform-action
                              perform_action: automation.trigger
                              target:
                                entity_id: automation.vacuum_clean_button_automation
                          show_state: false
                          show_attribute: false
                      scrolling_effect: false
                      modules:
                        - get_state_attribute
                      get_state_attribute:
                        - entity: vacuum.roborock_s7_maxv
                        - entity: sensor.roborock_s7_maxv_battery
                          attribute: charge
                  - type: conditional
                    conditions:
                      - entity: vacuum.roborock_s7_maxv
                        state: paused
                    card:
                      type: custom:bubble-card
                      card_type: button
                      button_type: state
                      entity: vacuum.roborock_s7_maxv
                      name: Roborock
                      show_icon: false
                      show_state: true
                      force_icon: false
                      sub_button:
                        - name: Resume
                          icon: mdi:play
                          tap_action:
                            action: perform-action
                            perform_action: script.roborock_pause_or_resume
                            target:
                              entity_id: script.roborock_pause_or_resume
                        - name: Stop
                          icon: mdi:stop
                          tap_action:
                            action: perform-action
                            perform_action: script.roborock_stop_and_dock
                            target:
                              entity_id: script.roborock_stop_and_dock
                      scrolling_effect: false
                      modules:
                        - get_state_attribute
                      get_state_attribute:
                        - entity: vacuum.roborock_s7_maxv
                        - entity: sensor.roborock_s7_maxv_battery
                          attribute: charge
                  - type: conditional
                    conditions:
                      - entity: vacuum.roborock_s7_maxv
                        state: charging
                    card:
                      type: custom:bubble-card
                      card_type: button
                      button_type: state
                      entity: vacuum.roborock_s7_maxv
                      name: Roborock
                      show_icon: false
                      show_state: true
                      force_icon: false
                      sub_button:
                        - name: Resume
                          icon: mdi:play
                          tap_action:
                            action: perform-action
                            perform_action: script.roborock_pause_or_resume
                            target:
                              entity_id: script.roborock_pause_or_resume
                        - name: Stop
                          icon: mdi:stop
                          tap_action:
                            action: perform-action
                            perform_action: script.roborock_stop_and_dock
                            target:
                              entity_id: script.roborock_stop_and_dock
                      scrolling_effect: false
                      modules:
                        - get_state_attribute
                      get_state_attribute:
                        - entity: vacuum.roborock_s7_maxv
                        - entity: sensor.roborock_s7_maxv_battery
                          attribute: charge
                  - type: conditional
                    conditions:
                      - entity: vacuum.roborock_s7_maxv
                        state: cleaning
                    card:
                      type: custom:bubble-card
                      card_type: button
                      button_type: state
                      entity: vacuum.roborock_s7_maxv
                      name: Roborock
                      show_icon: false
                      show_state: true
                      force_icon: false
                      sub_button:
                        - name: Pause
                          icon: mdi:pause
                          tap_action:
                            action: perform-action
                            perform_action: script.roborock_pause_or_resume
                            target:
                              entity_id: script.roborock_pause_or_resume
                        - name: Stop
                          icon: mdi:stop
                          tap_action:
                            action: perform-action
                            perform_action: script.roborock_stop_and_dock
                            target:
                              entity_id: script.roborock_stop_and_dock
                      scrolling_effect: false
                      modules:
                        - get_state_attribute
                      get_state_attribute:
                        - entity: vacuum.roborock_s7_maxv
                        - entity: sensor.roborock_s7_maxv_battery
                          attribute: charge
                  - type: conditional
                    conditions:
                      - entity: vacuum.roborock_s7_maxv
                        state: cleaning
                    card:
                      type: custom:bubble-card
                      card_type: button
                      button_type: state
                      entity: vacuum.roborock_s7_maxv
                      name: Roborock
                      show_icon: false
                      show_state: true
                      force_icon: false
                      sub_button:
                        - name: Pause
                          icon: mdi:pause
                          tap_action:
                            action: perform-action
                            perform_action: script.roborock_pause_or_resume
                            target:
                              entity_id: script.roborock_pause_or_resume
                        - name: Stop
                          icon: mdi:stop
                          tap_action:
                            action: perform-action
                            perform_action: script.roborock_stop_and_dock
                            target:
                              entity_id: script.roborock_stop_and_dock
                      scrolling_effect: false
                      modules:
                        - get_state_attribute
                      get_state_attribute:
                        - entity: vacuum.roborock_s7_maxv
                        - entity: sensor.roborock_s7_maxv_battery
                          attribute: charge
                  - type: conditional
                    conditions:
                      - entity: vacuum.roborock_s7_maxv
                        state: error
                    card:
                      type: custom:bubble-card
                      card_type: button
                      button_type: state
                      entity: vacuum.roborock_s7_maxv
                      name: Roborock
                      show_icon: false
                      show_state: true
                      force_icon: false
                      sub_button:
                        - name: Pause
                          icon: mdi:pause
                          tap_action:
                            action: perform-action
                            perform_action: script.roborock_pause_or_resume
                            target:
                              entity_id: script.roborock_pause_or_resume
                        - name: Stop
                          icon: mdi:stop
                          tap_action:
                            action: perform-action
                            perform_action: script.roborock_stop_and_dock
                            target:
                              entity_id: script.roborock_stop_and_dock
                      scrolling_effect: false
                      modules:
                        - get_state_attribute
                      get_state_attribute:
                        - entity: vacuum.roborock_s7_maxv
                        - entity: sensor.roborock_s7_maxv_battery
        column_span: 4
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: separator
            name: Media
            card_layout: large
            rows: '01'
            grid_options:
              columns: full
            sub_button: []
          - type: custom:bubble-card
            card_type: button
            button_type: switch
            entity: media_player.living_room_shield
            name: SHIELD
            show_state: true
            sub_button:
              - entity: media_player.living_room_shield
                tap_action:
                  action: perform-action
                  perform_action: media_player.volume_down
                  target:
                    entity_id:
                      - media_player.living_room_shield
                icon: mdi:volume-minus
              - entity: media_player.living_room_shield
                icon: mdi:play-pause
                tap_action:
                  action: perform-action
                  perform_action: media_player.media_play_pause
                  target:
                    entity_id: media_player.living_room_shield
              - entity: media_player.living_room_shield
                icon: mdi:volume-plus
                tap_action:
                  action: perform-action
                  perform_action: media_player.volume_up
                  target:
                    entity_id: media_player.living_room_shield
              - entity: media_player.living_room_shield
                tap_action:
                  action: perform-action
                  perform_action: ''
            grid_options:
              columns: full
            button_action:
              tap_action:
                action: more-info
            tap_action:
              action: toggle
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-main-icon-container {
                background: none !important;
                box-shadow: none !important;
                padding: 0 !important;
                width: auto !important;
                height: auto !important;
                pointer-events: none !important;
              }
          - type: custom:bubble-card
            card_type: button
            button_type: switch
            entity: media_player.living_room_tv
            show_state: true
            name: TV
            tap_action:
              action: toggle
            button_action:
              tap_action:
                action: more-info
            sub_button: []
            grid_options:
              columns: 6
              rows: auto
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-main-icon-container {
                background: none !important;
                box-shadow: none !important;
                padding: 0 !important;
                width: auto !important;
                height: auto !important;
                pointer-events: none !important;
              }
        column_span: 4
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: separator
            name: Sonos
            card_layout: large
            rows: '01'
            grid_options:
              columns: full
            sub_button: []
          - type: custom:bubble-card
            card_type: button
            button_type: switch
            entity: media_player.sonos
            show_state: true
            tap_action:
              action: more-info
            button_action:
              tap_action:
                action: more-info
            sub_button:
              - entity: media_player.sonos
                tap_action:
                  action: perform-action
                  perform_action: media_player.volume_mute
                  target:
                    device_id: 4beec4862c4675a9f5d071b1c2a0e2e3
                  data:
                    is_volume_muted: true
                icon: mdi:volume-mute
              - entity: media_player.sonos
                tap_action:
                  action: perform-action
                  perform_action: media_player.volume_down
                  target:
                    device_id: 4beec4862c4675a9f5d071b1c2a0e2e3
                icon: mdi:volume-minus
              - entity: media_player.sonos
                icon: mdi:volume-plus
                tap_action:
                  action: perform-action
                  perform_action: media_player.volume_up
                  target:
                    device_id: 4beec4862c4675a9f5d071b1c2a0e2e3
              - entity: media_player.sonos
                icon: mdi:skip-previous
                tap_action:
                  action: perform-action
                  perform_action: media_player.media_previous_track
                  target: {}
              - entity: media_player.sonos
                icon: mdi:play-pause
                tap_action:
                  action: perform-action
                  perform_action: media_player.media_play_pause
                  target:
                    device_id: 4beec4862c4675a9f5d071b1c2a0e2e3
              - entity: media_player.sonos
                icon: mdi:skip-next
                tap_action:
                  action: perform-action
                  perform_action: media_player.media_next_track
                  target:
                    device_id: 4beec4862c4675a9f5d071b1c2a0e2e3
            grid_options:
              columns: full
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-main-icon-container {
                background: none !important;
                box-shadow: none !important;
                padding: 0 !important;
                width: auto !important;
                height: auto !important;
                pointer-events: none !important;
              }
        column_span: 4
      - type: grid
        cards:
          - type: custom:navbar-card
            layout:
              mobile:
                mode: floating
                show_labels: false
              desktop:
                position: bottom
                show_labels: true
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .navbar-card.mobile {
                padding-bottom: calc(env(safe-area-inset-bottom, 0px));
              }
                          :host {
                            --navbar-background-color: rgba(25, 36, 54, 0.55);
                            --navbar-box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-desktop: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-mobile-floating: 0 24px 55px rgba(0, 0, 0, 0.55);
                          }
                          .navbar-card,
                          .navbar-card.desktop,
                          .navbar-card.mobile,
                          .navbar-card.desktop.bottom,
                          .navbar-card.desktop.top,
                          .navbar-card.desktop.left,
                          .navbar-card.desktop.right,
                          .navbar-card.mobile.floating,
                          ha-card.navbar-card {
                            background: rgba(25, 36, 54, 0.55) !important;
                            border: 1px solid rgba(255, 255, 255, 0.18) !important;
                            backdrop-filter: blur(20px);
                            -webkit-backdrop-filter: blur(20px);
                            box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45) !important;
                          }
            routes:
              - url: /at-a-glance/overview
                icon: mdi:home
                label: Home
                selected: |
                  [[[
                    const path = (location && location.pathname) || '';
                    const direct = ['/at-a-glance/security', '/at-a-glance/shopping-list', '/at-a-glance/chores'];
                    return !direct.some(prefix => path.startsWith(prefix));
                  ]]]
              - url: /at-a-glance/security
                icon: mdi:shield
                label: Security
              - url: /at-a-glance/shopping-list
                icon: mdi:shopping
                label: Shopping List
              - icon: mdi:dots-horizontal
                label: More
                tap_action:
                  action: open-popup
                popup:
                  - icon: mdi:cog
                    url: /config/dashboard
                  - icon: mdi:hammer
                    url: /developer-tools/yaml
                  - icon: mdi:power
                    tap_action:
                      action: call-service
                      service: homeassistant.restart
                      service_data: {}
                      confirmation:
                        text: Are you sure you want to restart Home Assistant?
            media_player: {}
            desktop: {}
    cards: []
  - title: Guest Room
    path: guest-room
    type: sections
    style: |
      :host {
        --view-padding: 0 16px !important;
        --lovelace-view-margin: 0 16px !important;
        position: relative;
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
      }
      bubble-card {
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
        --bubble-icon-opacity: 1 !important;
        --bubble-icon-opacity-active: 1 !important;
        --bubble-icon-opacity-disabled: 1 !important;
      }
      bubble-card .bubble-icon,
      bubble-card .bubble-main-icon-container,
      bubble-card .bubble-main-icon-container ha-icon,
      bubble-card ha-icon,
      bubble-card .is-off .bubble-main-icon,
      bubble-card .is-off .bubble-main-icon-container,
      bubble-card .is-off ha-icon {
        color: white !important;
        fill: white !important;
        opacity: 1 !important;
        filter: none !important;
      }
      bubble-card .is-off .bubble-background,
      bubble-card .is-off .bubble-icon-container {
        background: rgba(255, 255, 255, 0.35) !important;
      }
      :host::before {
        content: "";
        position: fixed;
        inset: 0;
        background-image: url("media-source://image_upload/b9449f15a0e0c05ad7c84ebd806b883c");
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
        filter: blur(18px) saturate(140%);
        transform: scale(1.05);     /* avoids clipping after blur */
        z-index: -2;
      }
      :host::after {
        content: "";
        position: fixed;
        inset: 0;
        background: rgba(12, 18, 28, 0.35);  /* frosted tint */
        backdrop-filter: blur(8px);
        z-index: -1;
      }
      hui-view-header,
      hui-section-heading-row,
      hui-section-heading-tile {
        display: none !important;
      }
    sections:
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: button
            button_type: name
            show_name: false
            show_state: false
            show_icon: true
            icon: mdi:chevron-left
            tap_action:
              action: fire-dom-event
              browser_mod:
                service: browser_mod.javascript
                data:
                  code: history.back()
            button_action:
              tap_action:
                action: fire-dom-event
                browser_mod:
                  service: browser_mod.javascript
                  data:
                    code: history.back()
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .bubble-icon,
              .bubble-main-icon,
              .bubble-main-icon-container ha-icon {
                color: white !important;
                opacity: 1 !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-button-card-container {
                display: flex !important;
                align-items: center !important;
                justify-content: flex-start !important;
                padding: 0 !important;
                border: 0 !important;
                background: transparent !important;
                box-shadow: none !important;
                cursor: pointer;
                margin-left: -16px !important;
              }
              .bubble-button-card-container:hover,
              .bubble-button-card-container:focus,
              .bubble-button-card-container:active {
                background: transparent !important;
                box-shadow: none !important;
                filter: none !important;
              }


              .bubble-icon-container {
                background: transparent !important;
                box-shadow: none !important;
              }

              .bubble-icon {
                --mdc-icon-size: 36px !important;
                padding: 0 !important;
              }
            grid_options:
              columns: 2
              rows: auto
          - type: markdown
            content: '# Guest Room'
            text_only: true
            card_mod:
              style: |
                ha-card {
                  display: flex;
                  align-items: center;   # vertical center
                  justify-content: center;  # optional horizontal center
                  height: 100%;
                  padding: 0;
                  margin-left: -32px !important;
                  --card-mod-script: |
                    if (window.__bubbleForceWhiteInit) {
                      return;
                    }
                    window.__bubbleForceWhiteInit = true;
                    const styleId = 'bubble-force-white-style';
                    const cssLines = [
                      '.bubble-icon,',
                      '.bubble-main-icon,',
                      '.bubble-main-icon-container,',
                      '.bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.is-off .bubble-icon,',
                      '.is-off .bubble-main-icon,',
                      '.is-off .bubble-main-icon-container,',
                      '.is-off .bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.ha-markdown-element {',
                      '  color: white !important',
                      '}',
                    ];
                    const css = cssLines.join('\n');
                    const touchIcons = (root) => {
                      if (!root) {
                        return;
                      }
                      root.querySelectorAll('.bubble-icon, .bubble-main-icon, .bubble-main-icon-container ha-icon').forEach((icon) => {
                        icon.style.setProperty('color', 'white', 'important');
                        icon.style.setProperty('fill', 'white', 'important');
                        icon.style.setProperty('opacity', '1', 'important');
                        icon.style.removeProperty('filter');
                      });
                    };
                    const applyStyles = (card) => {
                      if (!card) {
                        return;
                      }
                      const root = card.shadowRoot || card;
                      if (!root) {
                        return;
                      }
                      if (!root.getElementById(styleId)) {
                        const style = document.createElement('style');
                        style.id = styleId;
                        style.textContent = css;
                        root.appendChild(style);
                      }
                      touchIcons(root);
                    };
                    const registeredRoots = new Set();
                    const registerRoot = (root) => {
                      if (
                        root &&
                        typeof root.querySelectorAll === 'function' &&
                        !registeredRoots.has(root)
                      ) {
                        registeredRoots.add(root);
                      }
                    };
                    const scan = () => {
                      registeredRoots.forEach((root) => {
                        root.querySelectorAll('bubble-card').forEach(applyStyles);
                        root.querySelectorAll('*').forEach((el) => {
                          if (el.shadowRoot) {
                            registerRoot(el.shadowRoot);
                          }
                        });
                      });
                    };
                    registerRoot(document);
                    registerRoot(document.body);
                    registerRoot(document.documentElement);
                    scan();
                    window.__bubbleForceWhiteInterval = window.setInterval(() => {
                      scan();
                    }, 750);
                }
                ha-markdown {
                  margin: 0;
                  width: 100%;
                  text-align: center;    # drop if you only want vertical centering
                   color: white !important;
                }
            grid_options:
              columns: 6
              rows: auto
          - type: custom:swipe-card
            grid_options:
              columns: full
              rows: 1
            parameters:
              slidesPerView: auto
              spaceBetween: 12
              freeMode: true
              freeModeSticky: false
              mousewheel: true
            style: |
              margin-bottom: 10px !important;
            cards:
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: light.guest_room
                name: Lights
                show_state: true
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    --lights-color: ${(() => {
                      const light = hass.states[entity];
                      if (!light) {
                        return 'rgba(255, 255, 255, 0.35)';
                      }
                      const state = light.state;
                      if (state === 'off') {
                        return '#1e88e5';
                      }
                      if (state === 'unavailable') {
                        return 'rgba(120, 120, 120, 0.6)';
                      }
                      const attrs = light.attributes || {};
                      const rgb = attrs.rgb_color;
                      if (Array.isArray(rgb) && rgb.length === 3) {
                        const [r, g, b] = rgb;
                        return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                      }
                      const hs = attrs.hs_color;
                      if (Array.isArray(hs) && hs.length === 2) {
                        const hue = hs[0];
                        const sat = (hs[1] || 0) / 100;
                        const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                        const c = brightness * sat;
                        const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                        const m = brightness - c;
                        let r1 = 0;
                        let g1 = 0;
                        let b1 = 0;
                        if (hue >= 0 && hue < 60) {
                          r1 = c;
                          g1 = x;
                        } else if (hue < 120) {
                          r1 = x;
                          g1 = c;
                        } else if (hue < 180) {
                          g1 = c;
                          b1 = x;
                        } else if (hue < 240) {
                          g1 = x;
                          b1 = c;
                        } else if (hue < 300) {
                          r1 = x;
                          b1 = c;
                        } else {
                          r1 = c;
                          b1 = x;
                        }
                        const r = Math.round((r1 + m) * 255);
                        const g = Math.round((g1 + m) * 255);
                        const b = Math.round((b1 + m) * 255);
                        return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                      }
                      const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                      if (temp) {
                        const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                        const kelvin = clamp(temp, 2000, 6500);
                        const t = kelvin / 100;
                        let r;
                        let g;
                        let b;
                        if (t <= 66) {
                          r = 255;
                          g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                        } else {
                          r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                          g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                        }
                        if (t >= 66) {
                          b = 255;
                        } else if (t <= 19) {
                          b = 0;
                        } else {
                          b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                        }
                        return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                      }
                      return 'rgba(255, 255, 255, 0.35)';
                    })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--lights-color) !important;
                  }
                tap_action:
                  action: navigate
                  navigation_path: '#lights-guest-room'
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#lights-guest-room'
                card_mod:
                  style: >
                    :host {
                      width: auto;
                      max-width: 130px;
                      flex: 0 0 auto;
                      margin-bottom: 10px !important;
                      --bubble-icon-color: white;          # primary icon color
                      --bubble-icon-color-active: white;   # when entity is "on"
                      --bubble-icon-color-disabled: white;
                      --bubble-button-spacing: 0px;   /* no gap between icon and text */
                    }

                    .bubble-main-icon-container {
                      background: none !important;
                      box-shadow: none !important;
                      padding: 0 !important;
                      width: auto !important;
                      height: auto !important;
                      pointer-events: none !important;
                    }

                    .bubble-main-icon-container ha-icon {
                      width: 24px;   /* or any size you need */
                      height: 24px;
                      color: white !important;
                    }

                    .bubble-main-icon-container ha-ripple,

                    .bubble-main-icon-container .bubble-icon-feedback-container
                    {
                      display: none !important;   /* remove ripple/feedback layers */
                    }
              - type: custom:bubble-card
                card_type: button
                button_type: state
                entity: input_text.guest_room_climate_range
                icon: mdi:thermometer
                name: Climate
                show_state: true
                modules:
                  - frosted_glass
                  - get_state_attribute
                get_state_attribute:
                  - entity: input_text.guest_room_climate_range
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    width: auto;
                    max-width: 180px;
                    flex: 0 0 auto;
                    margin-bottom: 10px !important;
                    --climate-color: ${(() => {
                      const color = hass.states['input_text.guest_room_climate_color']?.state?.trim();
                      return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                    })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--climate-color) !important;
                  }

                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#climate-guest-room'
                  hold_action:
                    action: none
                icon_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#climate-guest-room'
                  hold_action:
                    action: none
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: binary_sensor.guest_room_presence_sensor_occupancy
                name: Occupancy
                icon: mdi:motion-sensor
                show_state: true
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    --occupancy-color: ${(() => {
                        const securityEntity = 'alarm_control_panel.aqara_hub_m3_0056_security_system_2';
                        const occState = hass.states[entity]?.state;
                        const securityState = hass.states[securityEntity]?.state;
                        const occupiedStates = ['on', 'detected', 'occupied'];
                        const clearStates = ['off', 'clear', 'standby'];
                        if (clearStates.includes(occState)) {
                          return '#43a047';
                        }
                        if (occupiedStates.includes(occState) && securityState === 'armed_away') {
                          return '#e53935';
                        }
                        if (occupiedStates.includes(occState)) {
                          return '#1e88e5';
                        }
                        if (occState === 'unavailable') {
                          return 'rgba(120, 120, 120, 0.6)';
                        }
                        return '#546e7a';
                      })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--occupancy-color) !important;
                  }
                card_mod:
                  style: >
                    :host {
                      width: auto;
                      max-width: 150px;
                      flex: 0 0 auto;
                      margin-bottom: 10px !important;
                      --bubble-icon-color: white;          # primary icon color
                      --bubble-icon-color-active: white;   # when entity is "on"
                      --bubble-icon-color-disabled: white;    # when unavailable
                    }

                    .bubble-main-icon-container {
                      background: none !important;
                      box-shadow: none !important;
                      padding: 0 !important;
                      width: auto !important;
                      height: auto !important;
                      pointer-events: none !important;
                    }

                    .bubble-main-icon-container ha-icon {
                      width: 24px;   /* or any size you need */
                      height: 24px;
                      color: white !important;
                    }

                    .bubble-main-icon-container ha-ripple,

                    .bubble-main-icon-container .bubble-icon-feedback-container
                    {
                      display: none !important;   /* remove ripple/feedback layers */
                    }
        column_span: 4
      - type: grid
        cards:
          - type: vertical-stack
            grid_options:
              columns: full
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#lights-guest-room'
                button_type: name
                show_icon: false
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                  .bubble-pop-up-background {
                    background-color: rgba(25, 36, 54, 0.55) !important;
                    filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.18);
                    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.15),
                        0 15px 40px rgba(0, 0, 0, 0.35);
                  }
              - type: custom:bubble-card
                card_type: separator
                name: Guest Room Lights
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button:
                  - entity: light.guest_room
                    tap_action:
                      action: toggle
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_8
                    name: TV Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_9
                    name: Bed Light
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: |
                      .bubble-main-icon {
                        color: white !important;
                      }
                      .is-off .bubble-background,
                      .is-unavailable .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      }
                      .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      }
                      .bubble-name,
                      .bubble_name {
                        color: white !important;
                      }
                      .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      }
                      :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }
                      .bubble-background,
                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }
                          .bubble-main-icon-container ha-ripple,
                          .bubble-main-icon-container .bubble-icon-feedback-container {
                            display: none !important;
                          }
                          .bubble-main-icon-container {
                            background: none !important;
                            box-shadow: none !important;
                            padding: 0 !important;
                            width: auto !important;
                            height: auto !important;
                            pointer-events: none !important;
                          }
                columns: 2
        column_span: 4
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: separator
            name: Climate
            card_layout: large
            rows: '01'
            grid_options:
              columns: full
            sub_button: []
          - type: custom:bubble-card
            card_type: button
            button_type: switch
            entity: cover.guest_room_vent_vent
            icon: mdi:air-filter
            tap_action:
              action: perform-action
              perform_action: cover.toggle_cover_tilt
              target:
                entity_id: cover.guest_room_vent_vent
              data: {}
            button_action:
              tap_action:
                action: perform-action
                perform_action: cover.toggle_cover_tilt
                target:
                  entity_id: cover.guest_room_vent_vent
                data: {}
            grid_options:
              columns: 6
              rows: auto
            name: Vent
            show_state: true
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-main-icon-container {
                background: none !important;
                box-shadow: none !important;
                padding: 0 !important;
                width: auto !important;
                height: auto !important;
                pointer-events: none !important;
              }
          - type: custom:bubble-card
            card_type: button
            button_type: state
            entity: fan.guest_purifier
            grid_options:
              columns: 6
              rows: auto
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            name: Air Purifier
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-main-icon-container {
                background: none !important;
                box-shadow: none !important;
                padding: 0 !important;
                width: auto !important;
                height: auto !important;
                pointer-events: none !important;
              }
        column_span: 4
      - type: grid
        cards:
          - type: vertical-stack
            grid_options:
              columns: full
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#climate-guest-room'
                button_type: name
                show_icon: false
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                  .bubble-pop-up-background {
                    background-color: rgba(25, 36, 54, 0.55) !important;
                    filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.18);
                    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.15),
                        0 15px 40px rgba(0, 0, 0, 0.35);
                  }
              - type: custom:bubble-card
                card_type: separator
                name: Guest Room Climate
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button: []
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.guest_room_presence_sensor_temperature
                    name: Guest Room
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.guest_room_presence_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.guest_room_temperature
                    name: Ecobee
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.guest_room_ecobee_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                columns: 2
        column_span: 4
      - type: grid
        cards:
          - type: custom:navbar-card
            layout:
              mobile:
                mode: floating
                show_labels: false
              desktop:
                position: bottom
                show_labels: true
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .navbar-card.mobile {
                padding-bottom: calc(env(safe-area-inset-bottom, 0px));
              }
                          :host {
                            --navbar-background-color: rgba(25, 36, 54, 0.55);
                            --navbar-box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-desktop: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-mobile-floating: 0 24px 55px rgba(0, 0, 0, 0.55);
                          }
                          .navbar-card,
                          .navbar-card.desktop,
                          .navbar-card.mobile,
                          .navbar-card.desktop.bottom,
                          .navbar-card.desktop.top,
                          .navbar-card.desktop.left,
                          .navbar-card.desktop.right,
                          .navbar-card.mobile.floating,
                          ha-card.navbar-card {
                            background: rgba(25, 36, 54, 0.55) !important;
                            border: 1px solid rgba(255, 255, 255, 0.18) !important;
                            backdrop-filter: blur(20px);
                            -webkit-backdrop-filter: blur(20px);
                            box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45) !important;
                          }
            routes:
              - url: /at-a-glance/overview
                icon: mdi:home
                label: Home
                selected: |
                  [[[
                    const path = (location && location.pathname) || '';
                    const direct = ['/at-a-glance/security', '/at-a-glance/shopping-list', '/at-a-glance/chores'];
                    return !direct.some(prefix => path.startsWith(prefix));
                  ]]]
              - url: /at-a-glance/security
                icon: mdi:shield
                label: Security
              - url: /at-a-glance/shopping-list
                icon: mdi:shopping
                label: Shopping List
              - icon: mdi:dots-horizontal
                label: More
                tap_action:
                  action: open-popup
                popup:
                  - icon: mdi:cog
                    url: /config/dashboard
                  - icon: mdi:hammer
                    url: /developer-tools/yaml
                  - icon: mdi:power
                    tap_action:
                      action: call-service
                      service: homeassistant.restart
                      service_data: {}
                      confirmation:
                        text: Are you sure you want to restart Home Assistant?
            media_player: {}
            desktop: {}
    cards: []
  - title: Master Bedroom
    path: master-bedroom
    type: sections
    style: |
      :host {
        --view-padding: 0 16px !important;
        --lovelace-view-margin: 0 16px !important;
        position: relative;
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
      }
      bubble-card {
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
        --bubble-icon-opacity: 1 !important;
        --bubble-icon-opacity-active: 1 !important;
        --bubble-icon-opacity-disabled: 1 !important;
      }
      bubble-card .bubble-icon,
      bubble-card .bubble-main-icon-container,
      bubble-card .bubble-main-icon-container ha-icon,
      bubble-card ha-icon,
      bubble-card .is-off .bubble-main-icon,
      bubble-card .is-off .bubble-main-icon-container,
      bubble-card .is-off ha-icon {
        color: white !important;
        fill: white !important;
        opacity: 1 !important;
        filter: none !important;
      }
      bubble-card .is-off .bubble-background,
      bubble-card .is-off .bubble-icon-container {
        background: rgba(255, 255, 255, 0.35) !important;
      }
      :host::before {
        content: "";
        position: fixed;
        inset: 0;
        background-image: url("media-source://image_upload/b9449f15a0e0c05ad7c84ebd806b883c");
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
        filter: blur(18px) saturate(140%);
        transform: scale(1.05);     /* avoids clipping after blur */
        z-index: -2;
      }
      :host::after {
        content: "";
        position: fixed;
        inset: 0;
        background: rgba(12, 18, 28, 0.35);  /* frosted tint */
        backdrop-filter: blur(8px);
        z-index: -1;
      }
      hui-view-header,
      hui-section-heading-row,
      hui-section-heading-tile {
        display: none !important;
      }
    sections:
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: button
            button_type: name
            show_name: false
            show_state: false
            show_icon: true
            icon: mdi:chevron-left
            tap_action:
              action: fire-dom-event
              browser_mod:
                service: browser_mod.javascript
                data:
                  code: history.back()
            button_action:
              tap_action:
                action: fire-dom-event
                browser_mod:
                  service: browser_mod.javascript
                  data:
                    code: history.back()
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .bubble-icon,
              .bubble-main-icon,
              .bubble-main-icon-container ha-icon {
                color: white !important;
                opacity: 1 !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-button-card-container {
                display: flex !important;
                align-items: center !important;
                justify-content: flex-start !important;
                padding: 0 !important;
                border: 0 !important;
                background: transparent !important;
                box-shadow: none !important;
                cursor: pointer;
                margin-left: -16px !important;
              }
              .bubble-button-card-container:hover,
              .bubble-button-card-container:focus,
              .bubble-button-card-container:active {
                background: transparent !important;
                box-shadow: none !important;
                filter: none !important;
              }


              .bubble-icon-container {
                background: transparent !important;
                box-shadow: none !important;
              }

              .bubble-icon {
                --mdc-icon-size: 36px !important;
                padding: 0 !important;
              }
            grid_options:
              columns: 2
              rows: auto
          - type: markdown
            content: '# Master Bedroom'
            text_only: true
            card_mod:
              style: |
                ha-card {
                  display: flex;
                  align-items: center;   # vertical center
                  justify-content: center;  # optional horizontal center
                  height: 100%;
                  padding: 0;
                  margin-left: -32px !important;
                  --card-mod-script: |
                    if (window.__bubbleForceWhiteInit) {
                      return;
                    }
                    window.__bubbleForceWhiteInit = true;
                    const styleId = 'bubble-force-white-style';
                    const cssLines = [
                      '.bubble-icon,',
                      '.bubble-main-icon,',
                      '.bubble-main-icon-container,',
                      '.bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.is-off .bubble-icon,',
                      '.is-off .bubble-main-icon,',
                      '.is-off .bubble-main-icon-container,',
                      '.is-off .bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.ha-markdown-element {',
                      '  color: white !important',
                      '}',
                    ];
                    const css = cssLines.join('\n');
                    const touchIcons = (root) => {
                      if (!root) {
                        return;
                      }
                      root.querySelectorAll('.bubble-icon, .bubble-main-icon, .bubble-main-icon-container ha-icon').forEach((icon) => {
                        icon.style.setProperty('color', 'white', 'important');
                        icon.style.setProperty('fill', 'white', 'important');
                        icon.style.setProperty('opacity', '1', 'important');
                        icon.style.removeProperty('filter');
                      });
                    };
                    const applyStyles = (card) => {
                      if (!card) {
                        return;
                      }
                      const root = card.shadowRoot || card;
                      if (!root) {
                        return;
                      }
                      if (!root.getElementById(styleId)) {
                        const style = document.createElement('style');
                        style.id = styleId;
                        style.textContent = css;
                        root.appendChild(style);
                      }
                      touchIcons(root);
                    };
                    const registeredRoots = new Set();
                    const registerRoot = (root) => {
                      if (
                        root &&
                        typeof root.querySelectorAll === 'function' &&
                        !registeredRoots.has(root)
                      ) {
                        registeredRoots.add(root);
                      }
                    };
                    const scan = () => {
                      registeredRoots.forEach((root) => {
                        root.querySelectorAll('bubble-card').forEach(applyStyles);
                        root.querySelectorAll('*').forEach((el) => {
                          if (el.shadowRoot) {
                            registerRoot(el.shadowRoot);
                          }
                        });
                      });
                    };
                    registerRoot(document);
                    registerRoot(document.body);
                    registerRoot(document.documentElement);
                    scan();
                    window.__bubbleForceWhiteInterval = window.setInterval(() => {
                      scan();
                    }, 750);
                }
                ha-markdown {
                  margin: 0;
                  width: 100%;
                  text-align: center;    # drop if you only want vertical centering
                   color: white !important;
                }
            grid_options:
              columns: 6
              rows: auto
          - type: custom:swipe-card
            grid_options:
              columns: full
              rows: 1
            parameters:
              slidesPerView: auto
              spaceBetween: 12
              freeMode: true
              freeModeSticky: false
              mousewheel: true
            style: |
              margin-bottom: 10px !important;
            cards:
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: light.master_bedroom
                name: Lights
                show_state: true
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    --lights-color: ${(() => {
                      const light = hass.states[entity];
                      if (!light) {
                        return 'rgba(255, 255, 255, 0.35)';
                      }
                      const state = light.state;
                      if (state === 'off') {
                        return '#1e88e5';
                      }
                      if (state === 'unavailable') {
                        return 'rgba(120, 120, 120, 0.6)';
                      }
                      const attrs = light.attributes || {};
                      const rgb = attrs.rgb_color;
                      if (Array.isArray(rgb) && rgb.length === 3) {
                        const [r, g, b] = rgb;
                        return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                      }
                      const hs = attrs.hs_color;
                      if (Array.isArray(hs) && hs.length === 2) {
                        const hue = hs[0];
                        const sat = (hs[1] || 0) / 100;
                        const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                        const c = brightness * sat;
                        const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                        const m = brightness - c;
                        let r1 = 0;
                        let g1 = 0;
                        let b1 = 0;
                        if (hue >= 0 && hue < 60) {
                          r1 = c;
                          g1 = x;
                        } else if (hue < 120) {
                          r1 = x;
                          g1 = c;
                        } else if (hue < 180) {
                          g1 = c;
                          b1 = x;
                        } else if (hue < 240) {
                          g1 = x;
                          b1 = c;
                        } else if (hue < 300) {
                          r1 = x;
                          b1 = c;
                        } else {
                          r1 = c;
                          b1 = x;
                        }
                        const r = Math.round((r1 + m) * 255);
                        const g = Math.round((g1 + m) * 255);
                        const b = Math.round((b1 + m) * 255);
                        return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                      }
                      const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                      if (temp) {
                        const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                        const kelvin = clamp(temp, 2000, 6500);
                        const t = kelvin / 100;
                        let r;
                        let g;
                        let b;
                        if (t <= 66) {
                          r = 255;
                          g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                        } else {
                          r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                          g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                        }
                        if (t >= 66) {
                          b = 255;
                        } else if (t <= 19) {
                          b = 0;
                        } else {
                          b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                        }
                        return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                      }
                      return 'rgba(255, 255, 255, 0.35)';
                    })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--lights-color) !important;
                  }
                tap_action:
                  action: navigate
                  navigation_path: '#lights-master-bedroom'
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#lights-master-bedroom'
                card_mod:
                  style: >
                    :host {
                      width: auto;
                      max-width: 130px;
                      flex: 0 0 auto;
                      margin-bottom: 10px !important;
                      --bubble-icon-color: white;          # primary icon color
                      --bubble-icon-color-active: white;   # when entity is "on"
                      --bubble-icon-color-disabled: white;
                      --bubble-button-spacing: 0px;   /* no gap between icon and text */
                    }

                    .bubble-main-icon-container {
                      background: none !important;
                      box-shadow: none !important;
                      padding: 0 !important;
                      width: auto !important;
                      height: auto !important;
                      pointer-events: none !important;
                    }

                    .bubble-main-icon-container ha-icon {
                      width: 24px;   /* or any size you need */
                      height: 24px;
                      color: white !important;
                    }

                    .bubble-main-icon-container ha-ripple,

                    .bubble-main-icon-container .bubble-icon-feedback-container
                    {
                      display: none !important;   /* remove ripple/feedback layers */
                    }
              - type: custom:bubble-card
                card_type: button
                button_type: state
                entity: input_text.master_bedroom_climate_range
                icon: mdi:thermometer
                name: Climate
                show_state: true
                modules:
                  - frosted_glass
                  - get_state_attribute
                get_state_attribute:
                  - entity: input_text.master_bedroom_climate_range
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    width: auto;
                    max-width: 180px;
                    flex: 0 0 auto;
                    margin-bottom: 10px !important;
                    --climate-color: ${(() => {
                      const color = hass.states['input_text.master_bedroom_climate_color']?.state?.trim();
                      return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                    })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--climate-color) !important;
                  }

                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#climate-master-bedroom'
                  hold_action:
                    action: none
                icon_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#climate-master-bedroom'
                  hold_action:
                    action: none
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: binary_sensor.aqara_presence_multisensor_fp300_occupancy_2
                name: Occupancy
                icon: mdi:motion-sensor
                show_state: true
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    --occupancy-color: ${(() => {
                        const securityEntity = 'alarm_control_panel.aqara_hub_m3_0056_security_system_2';
                        const occState = hass.states[entity]?.state;
                        const securityState = hass.states[securityEntity]?.state;
                        const occupiedStates = ['on', 'detected', 'occupied'];
                        const clearStates = ['off', 'clear', 'standby'];
                        if (clearStates.includes(occState)) {
                          return '#43a047';
                        }
                        if (occupiedStates.includes(occState) && securityState === 'armed_away') {
                          return '#e53935';
                        }
                        if (occupiedStates.includes(occState)) {
                          return '#1e88e5';
                        }
                        if (occState === 'unavailable') {
                          return 'rgba(120, 120, 120, 0.6)';
                        }
                        return '#546e7a';
                      })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--occupancy-color) !important;
                  }
                card_mod:
                  style: >
                    :host {
                      width: auto;
                      max-width: 150px;
                      flex: 0 0 auto;
                      margin-bottom: 10px !important;
                      --bubble-icon-color: white;          # primary icon color
                      --bubble-icon-color-active: white;   # when entity is "on"
                      --bubble-icon-color-disabled: white;    # when unavailable
                    }

                    .bubble-main-icon-container {
                      background: none !important;
                      box-shadow: none !important;
                      padding: 0 !important;
                      width: auto !important;
                      height: auto !important;
                      pointer-events: none !important;
                    }

                    .bubble-main-icon-container ha-icon {
                      width: 24px;   /* or any size you need */
                      height: 24px;
                      color: white !important;
                    }

                    .bubble-main-icon-container ha-ripple,

                    .bubble-main-icon-container .bubble-icon-feedback-container
                    {
                      display: none !important;   /* remove ripple/feedback layers */
                    }
        column_span: 4
      - type: grid
        cards:
          - type: vertical-stack
            grid_options:
              columns: full
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#lights-master-bedroom'
                button_type: name
                show_icon: false
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                  .bubble-pop-up-background {
                    background-color: rgba(25, 36, 54, 0.55) !important;
                    filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.18);
                    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.15),
                        0 15px 40px rgba(0, 0, 0, 0.35);
                  }
              - type: custom:bubble-card
                card_type: separator
                name: Master Bedroom Lights
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button:
                  - entity: light.master_bedroom
                    tap_action:
                      action: toggle
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_1
                    name: Window Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }

                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_3
                    name: Bathroom Light
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }

                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_2
                    name: Door Light
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }

                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                columns: 2
        column_span: 4
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: separator
            name: Climate
            card_layout: large
            rows: '01'
            grid_options:
              columns: full
            sub_button: []
          - type: custom:bubble-card
            card_type: button
            button_type: switch
            entity: cover.master_bedroom_vents
            icon: mdi:air-filter
            tap_action:
              action: perform-action
              perform_action: cover.toggle_cover_tilt
              target:
                entity_id: cover.master_bedroom_vents
              data: {}
            button_action:
              tap_action:
                action: perform-action
                perform_action: cover.toggle_cover_tilt
                target:
                  entity_id: cover.master_bedroom_vents
                data: {}
            grid_options:
              columns: 6
              rows: auto
            name: Vents
            show_state: true
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-main-icon-container {
                background: none !important;
                box-shadow: none !important;
                padding: 0 !important;
                width: auto !important;
                height: auto !important;
                pointer-events: none !important;
              }
          - type: custom:bubble-card
            card_type: button
            button_type: state
            entity: fan.bedroom_purifier
            grid_options:
              columns: 6
              rows: auto
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            name: Air Purifier
            show_attribute: true
            attribute: preset_mode
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-main-icon-container {
                background: none !important;
                box-shadow: none !important;
                padding: 0 !important;
                width: auto !important;
                height: auto !important;
                pointer-events: none !important;
              }
          - type: custom:bubble-card
            card_type: button
            button_type: state
            entity: humidifier.master_bedroom_humidifier
            grid_options:
              columns: 6
              rows: auto
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            name: Humidifier
            icon: mdi:air-humidifier
            show_attribute: true
            attribute: current_humidity
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-main-icon-container {
                background: none !important;
                box-shadow: none !important;
                padding: 0 !important;
                width: auto !important;
                height: auto !important;
                pointer-events: none !important;
              }
        column_span: 4
      - type: grid
        cards:
          - type: vertical-stack
            grid_options:
              columns: full
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#climate-master-bedroom'
                button_type: name
                show_icon: false
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                  .bubble-pop-up-background {
                    background-color: rgba(25, 36, 54, 0.55) !important;
                    filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.18);
                    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.15),
                        0 15px 40px rgba(0, 0, 0, 0.35);
                  }
              - type: custom:bubble-card
                card_type: separator
                name: Master Bedroom Climate
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button: []
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.aqara_presence_multisensor_fp300_temperature_2
                    name: Street Window
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.master_bedroom_window_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.bedroom_temperature
                    name: Ecobee
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.master_bedroom_ecobee_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                columns: 2
        column_span: 4
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: separator
            name: Media
            card_layout: large
            rows: '01'
            grid_options:
              columns: full
            sub_button: []
        column_span: 4
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: separator
            name: Sonos
            card_layout: large
            rows: '01'
            grid_options:
              columns: full
            sub_button: []
          - type: custom:bubble-card
            card_type: button
            button_type: switch
            entity: media_player.beam
            show_state: true
            tap_action:
              action: more-info
            button_action:
              tap_action:
                action: more-info
            sub_button:
              - entity: media_player.beam
                tap_action:
                  action: perform-action
                  perform_action: media_player.volume_mute
                  target:
                    device_id: 4beec4862c4675a9f5d071b1c2a0e2e3
                  data:
                    is_volume_muted: true
                icon: mdi:volume-mute
              - entity: media_player.beam
                tap_action:
                  action: perform-action
                  perform_action: media_player.volume_down
                  target:
                    device_id: 4beec4862c4675a9f5d071b1c2a0e2e3
                icon: mdi:volume-minus
              - entity: media_player.beam
                icon: mdi:volume-plus
                tap_action:
                  action: perform-action
                  perform_action: media_player.volume_up
                  target:
                    device_id: 4beec4862c4675a9f5d071b1c2a0e2e3
              - entity: media_player.beam
                icon: mdi:skip-previous
                tap_action:
                  action: perform-action
                  perform_action: media_player.media_previous_track
                  target: {}
              - entity: media_player.beam
                icon: mdi:play-pause
                tap_action:
                  action: perform-action
                  perform_action: media_player.media_play_pause
                  target:
                    device_id: 4beec4862c4675a9f5d071b1c2a0e2e3
              - entity: media_player.beam
                icon: mdi:skip-next
                tap_action:
                  action: perform-action
                  perform_action: media_player.media_next_track
                  target:
                    device_id: 4beec4862c4675a9f5d071b1c2a0e2e3
            grid_options:
              columns: full
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-main-icon-container {
                background: none !important;
                box-shadow: none !important;
                padding: 0 !important;
                width: auto !important;
                height: auto !important;
                pointer-events: none !important;
              }
        column_span: 4
      - type: grid
        cards:
          - type: vertical-stack
            grid_options:
              columns: full
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#climate-kitchen'
                button_type: name
                show_icon: false
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
              - type: custom:bubble-card
                card_type: separator
                name: Kitchen Climate
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button: []
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: >-
                      sensor.hallway_entryway_living_room_presence_sensor_temperature
                    name: Entryway
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.entryway_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.kitchen_presence_sensor_temperature
                    name: Kitchen
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.kitchen_presence_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.kitchen_temperature
                    name: Ecobee
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.kitchen_ecobee_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                columns: 2
        column_span: 4
      - type: grid
        cards:
          - type: custom:navbar-card
            layout:
              mobile:
                mode: floating
                show_labels: false
              desktop:
                position: bottom
                show_labels: true
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .navbar-card.mobile {
                padding-bottom: calc(env(safe-area-inset-bottom, 0px));
              }
                          :host {
                            --navbar-background-color: rgba(25, 36, 54, 0.55);
                            --navbar-box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-desktop: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-mobile-floating: 0 24px 55px rgba(0, 0, 0, 0.55);
                          }
                          .navbar-card,
                          .navbar-card.desktop,
                          .navbar-card.mobile,
                          .navbar-card.desktop.bottom,
                          .navbar-card.desktop.top,
                          .navbar-card.desktop.left,
                          .navbar-card.desktop.right,
                          .navbar-card.mobile.floating,
                          ha-card.navbar-card {
                            background: rgba(25, 36, 54, 0.55) !important;
                            border: 1px solid rgba(255, 255, 255, 0.18) !important;
                            backdrop-filter: blur(20px);
                            -webkit-backdrop-filter: blur(20px);
                            box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45) !important;
                          }
            routes:
              - url: /at-a-glance/overview
                icon: mdi:home
                label: Home
                selected: |
                  [[[
                    const path = (location && location.pathname) || '';
                    const direct = ['/at-a-glance/security', '/at-a-glance/shopping-list', '/at-a-glance/chores'];
                    return !direct.some(prefix => path.startsWith(prefix));
                  ]]]
              - url: /at-a-glance/security
                icon: mdi:shield
                label: Security
              - url: /at-a-glance/shopping-list
                icon: mdi:shopping
                label: Shopping List
              - icon: mdi:dots-horizontal
                label: More
                tap_action:
                  action: open-popup
                popup:
                  - icon: mdi:cog
                    url: /config/dashboard
                  - icon: mdi:hammer
                    url: /developer-tools/yaml
                  - icon: mdi:power
                    tap_action:
                      action: call-service
                      service: homeassistant.restart
                      service_data: {}
                      confirmation:
                        text: Are you sure you want to restart Home Assistant?
            media_player: {}
            desktop: {}
    cards: []
  - title: Gym
    path: gym
    type: sections
    style: |
      :host {
        --view-padding: 0 16px !important;
        --lovelace-view-margin: 0 16px !important;
        position: relative;
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
      }
      bubble-card {
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
        --bubble-icon-opacity: 1 !important;
        --bubble-icon-opacity-active: 1 !important;
        --bubble-icon-opacity-disabled: 1 !important;
      }
      bubble-card .bubble-icon,
      bubble-card .bubble-main-icon-container,
      bubble-card .bubble-main-icon-container ha-icon,
      bubble-card ha-icon,
      bubble-card .is-off .bubble-main-icon,
      bubble-card .is-off .bubble-main-icon-container,
      bubble-card .is-off ha-icon {
        color: white !important;
        fill: white !important;
        opacity: 1 !important;
        filter: none !important;
      }
      bubble-card .is-off .bubble-background,
      bubble-card .is-off .bubble-icon-container {
        background: rgba(255, 255, 255, 0.35) !important;
      }
      :host::before {
        content: "";
        position: fixed;
        inset: 0;
        background-image: url("media-source://image_upload/b9449f15a0e0c05ad7c84ebd806b883c");
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
        filter: blur(18px) saturate(140%);
        transform: scale(1.05);     /* avoids clipping after blur */
        z-index: -2;
      }
      :host::after {
        content: "";
        position: fixed;
        inset: 0;
        background: rgba(12, 18, 28, 0.35);  /* frosted tint */
        backdrop-filter: blur(8px);
        z-index: -1;
      }
      hui-view-header,
      hui-section-heading-row,
      hui-section-heading-tile {
        display: none !important;
      }
    sections:
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: button
            button_type: name
            show_name: false
            show_state: false
            show_icon: true
            icon: mdi:chevron-left
            tap_action:
              action: fire-dom-event
              browser_mod:
                service: browser_mod.javascript
                data:
                  code: history.back()
            button_action:
              tap_action:
                action: fire-dom-event
                browser_mod:
                  service: browser_mod.javascript
                  data:
                    code: history.back()
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .bubble-icon,
              .bubble-main-icon,
              .bubble-main-icon-container ha-icon {
                color: white !important;
                opacity: 1 !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-button-card-container {
                display: flex !important;
                align-items: center !important;
                justify-content: flex-start !important;
                padding: 0 !important;
                border: 0 !important;
                background: transparent !important;
                box-shadow: none !important;
                cursor: pointer;
                margin-left: -16px !important;
              }
              .bubble-button-card-container:hover,
              .bubble-button-card-container:focus,
              .bubble-button-card-container:active {
                background: transparent !important;
                box-shadow: none !important;
                filter: none !important;
              }


              .bubble-icon-container {
                background: transparent !important;
                box-shadow: none !important;
              }

              .bubble-icon {
                --mdc-icon-size: 36px !important;
                padding: 0 !important;
              }
            grid_options:
              columns: 2
              rows: auto
          - type: markdown
            content: '# Gym'
            text_only: true
            grid_options:
              columns: 6
              rows: auto
            card_mod:
              style: |
                ha-card {
                  display: flex;
                  align-items: center;   # vertical center
                  justify-content: center;  # optional horizontal center
                  height: 100%;
                  padding: 0;
                  margin-left: -32px !important;
                  --card-mod-script: |
                    if (window.__bubbleForceWhiteInit) {
                      return;
                    }
                    window.__bubbleForceWhiteInit = true;
                    const styleId = 'bubble-force-white-style';
                    const cssLines = [
                      '.bubble-icon,',
                      '.bubble-main-icon,',
                      '.bubble-main-icon-container,',
                      '.bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.is-off .bubble-icon,',
                      '.is-off .bubble-main-icon,',
                      '.is-off .bubble-main-icon-container,',
                      '.is-off .bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.ha-markdown-element {',
                      '  color: white !important',
                      '}',
                    ];
                    const css = cssLines.join('\n');
                    const touchIcons = (root) => {
                      if (!root) {
                        return;
                      }
                      root.querySelectorAll('.bubble-icon, .bubble-main-icon, .bubble-main-icon-container ha-icon').forEach((icon) => {
                        icon.style.setProperty('color', 'white', 'important');
                        icon.style.setProperty('fill', 'white', 'important');
                        icon.style.setProperty('opacity', '1', 'important');
                        icon.style.removeProperty('filter');
                      });
                    };
                    const applyStyles = (card) => {
                      if (!card) {
                        return;
                      }
                      const root = card.shadowRoot || card;
                      if (!root) {
                        return;
                      }
                      if (!root.getElementById(styleId)) {
                        const style = document.createElement('style');
                        style.id = styleId;
                        style.textContent = css;
                        root.appendChild(style);
                      }
                      touchIcons(root);
                    };
                    const registeredRoots = new Set();
                    const registerRoot = (root) => {
                      if (
                        root &&
                        typeof root.querySelectorAll === 'function' &&
                        !registeredRoots.has(root)
                      ) {
                        registeredRoots.add(root);
                      }
                    };
                    const scan = () => {
                      registeredRoots.forEach((root) => {
                        root.querySelectorAll('bubble-card').forEach(applyStyles);
                        root.querySelectorAll('*').forEach((el) => {
                          if (el.shadowRoot) {
                            registerRoot(el.shadowRoot);
                          }
                        });
                      });
                    };
                    registerRoot(document);
                    registerRoot(document.body);
                    registerRoot(document.documentElement);
                    scan();
                    window.__bubbleForceWhiteInterval = window.setInterval(() => {
                      scan();
                    }, 750);
                }
                ha-markdown {
                  margin: 0;
                  width: 100%;
                  text-align: center;    # drop if you only want vertical centering
                   color: white !important;
                }
          - type: custom:swipe-card
            grid_options:
              columns: full
              rows: 1
            parameters:
              slidesPerView: auto
              spaceBetween: 12
              freeMode: true
              freeModeSticky: false
              mousewheel: true
            style: |
              margin-bottom: 10px !important;
            cards:
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: light.spare_room
                name: Light
                show_state: true
                icon: mdi:lightbulb
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    --lights-color: ${(() => {
                      const light = hass.states[entity];
                      if (!light) {
                        return 'rgba(255, 255, 255, 0.35)';
                      }
                      const state = light.state;
                      if (state === 'off') {
                        return '#1e88e5';
                      }
                      if (state === 'unavailable') {
                        return 'rgba(120, 120, 120, 0.6)';
                      }
                      const attrs = light.attributes || {};
                      const rgb = attrs.rgb_color;
                      if (Array.isArray(rgb) && rgb.length === 3) {
                        const [r, g, b] = rgb;
                        return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                      }
                      const hs = attrs.hs_color;
                      if (Array.isArray(hs) && hs.length === 2) {
                        const hue = hs[0];
                        const sat = (hs[1] || 0) / 100;
                        const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                        const c = brightness * sat;
                        const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                        const m = brightness - c;
                        let r1 = 0;
                        let g1 = 0;
                        let b1 = 0;
                        if (hue >= 0 && hue < 60) {
                          r1 = c;
                          g1 = x;
                        } else if (hue < 120) {
                          r1 = x;
                          g1 = c;
                        } else if (hue < 180) {
                          g1 = c;
                          b1 = x;
                        } else if (hue < 240) {
                          g1 = x;
                          b1 = c;
                        } else if (hue < 300) {
                          r1 = x;
                          b1 = c;
                        } else {
                          r1 = c;
                          b1 = x;
                        }
                        const r = Math.round((r1 + m) * 255);
                        const g = Math.round((g1 + m) * 255);
                        const b = Math.round((b1 + m) * 255);
                        return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                      }
                      const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                      if (temp) {
                        const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                        const kelvin = clamp(temp, 2000, 6500);
                        const t = kelvin / 100;
                        let r;
                        let g;
                        let b;
                        if (t <= 66) {
                          r = 255;
                          g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                        } else {
                          r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                          g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                        }
                        if (t >= 66) {
                          b = 255;
                        } else if (t <= 19) {
                          b = 0;
                        } else {
                          b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                        }
                        return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                      }
                      return 'rgba(255, 255, 255, 0.35)';
                    })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--lights-color) !important;
                  }
                tap_action:
                  action: navigate
                  navigation_path: '#lights-gym'
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#lights-gym'
                card_mod:
                  style: >
                    :host {
                      width: auto;
                      max-width: 130px;
                      flex: 0 0 auto;
                      margin-bottom: 10px !important;
                      --bubble-icon-color: white;          # primary icon color
                      --bubble-icon-color-active: white;   # when entity is "on"
                      --bubble-icon-color-disabled: white;
                      --bubble-button-spacing: 0px;   /* no gap between icon and text */
                    }

                    .bubble-main-icon-container {
                      background: none !important;
                      box-shadow: none !important;
                      padding: 0 !important;
                      width: auto !important;
                      height: auto !important;
                      pointer-events: none !important;
                    }

                    .bubble-main-icon-container ha-icon {
                      width: 24px;   /* or any size you need */
                      height: 24px;
                      color: white !important;
                    }

                    .bubble-main-icon-container ha-ripple,

                    .bubble-main-icon-container .bubble-icon-feedback-container
                    {
                      display: none !important;   /* remove ripple/feedback layers */
                    }
              - type: custom:bubble-card
                card_type: button
                button_type: state
                entity: input_text.gym_climate_range
                icon: mdi:thermometer
                name: Climate
                show_state: true
                modules:
                  - frosted_glass
                  - get_state_attribute
                get_state_attribute:
                  - entity: input_text.gym_climate_range
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    width: auto;
                    max-width: 180px;
                    flex: 0 0 auto;
                    margin-bottom: 10px !important;
                    --climate-color: ${(() => {
                      const color = hass.states['input_text.gym_climate_color']?.state?.trim();
                      return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                    })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--climate-color) !important;
                  }

                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#climate-gym'
                  hold_action:
                    action: none
                icon_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#climate-gym'
                  hold_action:
                    action: none
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: binary_sensor.gym_presence_sensor_occupancy
                name: Occupancy
                icon: mdi:motion-sensor
                show_state: true
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    --occupancy-color: ${(() => {
                        const securityEntity = 'alarm_control_panel.aqara_hub_m3_0056_security_system_2';
                        const occState = hass.states[entity]?.state;
                        const securityState = hass.states[securityEntity]?.state;
                        const occupiedStates = ['on', 'detected', 'occupied'];
                        const clearStates = ['off', 'clear', 'standby'];
                        if (clearStates.includes(occState)) {
                          return '#43a047';
                        }
                        if (occupiedStates.includes(occState) && securityState === 'armed_away') {
                          return '#e53935';
                        }
                        if (occupiedStates.includes(occState)) {
                          return '#1e88e5';
                        }
                        if (occState === 'unavailable') {
                          return 'rgba(120, 120, 120, 0.6)';
                        }
                        return '#546e7a';
                      })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--occupancy-color) !important;
                  }
                card_mod:
                  style: >
                    :host {
                      width: auto;
                      max-width: 150px;
                      flex: 0 0 auto;
                      margin-bottom: 10px !important;
                      --bubble-icon-color: white;          # primary icon color
                      --bubble-icon-color-active: white;   # when entity is "on"
                      --bubble-icon-color-disabled: white;    # when unavailable
                    }

                    .bubble-main-icon-container {
                      background: none !important;
                      box-shadow: none !important;
                      padding: 0 !important;
                      width: auto !important;
                      height: auto !important;
                      pointer-events: none !important;
                    }

                    .bubble-main-icon-container ha-icon {
                      width: 24px;   /* or any size you need */
                      height: 24px;
                      color: white !important;
                    }

                    .bubble-main-icon-container ha-ripple,

                    .bubble-main-icon-container .bubble-icon-feedback-container
                    {
                      display: none !important;   /* remove ripple/feedback layers */
                    }
        column_span: 4
      - type: grid
        cards:
          - type: vertical-stack
            grid_options:
              columns: full
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#lights-gym'
                button_type: name
                show_icon: false
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                  .bubble-pop-up-background {
                    background-color: rgba(25, 36, 54, 0.55) !important;
                    filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.18);
                    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.15),
                        0 15px 40px rgba(0, 0, 0, 0.35);
                  }
              - type: custom:bubble-card
                card_type: separator
                name: Gym Light
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button:
                  - entity: light.spare_room
                    tap_action:
                      action: toggle
                    icon: mdi:lightbulb
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_24
                    name: Gym Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }

                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                columns: 2
        column_span: 4
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: separator
            name: Climate
            card_layout: large
            rows: '01'
            grid_options:
              columns: full
            sub_button: []
          - type: custom:bubble-card
            card_type: button
            button_type: switch
            entity: cover.gym_vent_vent
            icon: mdi:air-filter
            tap_action:
              action: perform-action
              perform_action: cover.toggle_cover_tilt
              target:
                entity_id: cover.gym_vent_vent
              data: {}
            button_action:
              tap_action:
                action: perform-action
                perform_action: cover.toggle_cover_tilt
                target:
                  entity_id: cover.gym_vent_vent
                data: {}
            grid_options:
              columns: 6
              rows: auto
            name: Vent
            show_state: true
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-main-icon-container {
                background: none !important;
                box-shadow: none !important;
                padding: 0 !important;
                width: auto !important;
                height: auto !important;
                pointer-events: none !important;
              }
        column_span: 4
      - type: grid
        cards:
          - type: vertical-stack
            grid_options:
              columns: full
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#climate-gym'
                button_type: name
                show_icon: false
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                  .bubble-pop-up-background {
                    background-color: rgba(25, 36, 54, 0.55) !important;
                    filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.18);
                    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.15),
                        0 15px 40px rgba(0, 0, 0, 0.35);
                  }
              - type: custom:bubble-card
                card_type: separator
                name: Gym Climate
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button: []
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.gym_presence_sensor_temperature
                    name: Gym
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.gym_presence_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.hallway_guest_bath_gym_presence_sensor_temperature
                    name: Gym Door
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.gym_door_guest_bath_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.gym_temperature
                    name: Ecobee
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.gym_ecobee_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                columns: 2
        column_span: 4
      - type: grid
        cards:
          - type: custom:navbar-card
            layout:
              mobile:
                mode: floating
                show_labels: false
              desktop:
                position: bottom
                show_labels: true
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .navbar-card.mobile {
                padding-bottom: calc(env(safe-area-inset-bottom, 0px));
              }
                          :host {
                            --navbar-background-color: rgba(25, 36, 54, 0.55);
                            --navbar-box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-desktop: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-mobile-floating: 0 24px 55px rgba(0, 0, 0, 0.55);
                          }
                          .navbar-card,
                          .navbar-card.desktop,
                          .navbar-card.mobile,
                          .navbar-card.desktop.bottom,
                          .navbar-card.desktop.top,
                          .navbar-card.desktop.left,
                          .navbar-card.desktop.right,
                          .navbar-card.mobile.floating,
                          ha-card.navbar-card {
                            background: rgba(25, 36, 54, 0.55) !important;
                            border: 1px solid rgba(255, 255, 255, 0.18) !important;
                            backdrop-filter: blur(20px);
                            -webkit-backdrop-filter: blur(20px);
                            box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45) !important;
                          }
            routes:
              - url: /at-a-glance/overview
                icon: mdi:home
                label: Home
                selected: |
                  [[[
                    const path = (location && location.pathname) || '';
                    const direct = ['/at-a-glance/security', '/at-a-glance/shopping-list', '/at-a-glance/chores'];
                    return !direct.some(prefix => path.startsWith(prefix));
                  ]]]
              - url: /at-a-glance/security
                icon: mdi:shield
                label: Security
              - url: /at-a-glance/shopping-list
                icon: mdi:shopping
                label: Shopping List
              - icon: mdi:dots-horizontal
                label: More
                tap_action:
                  action: open-popup
                popup:
                  - icon: mdi:cog
                    url: /config/dashboard
                  - icon: mdi:hammer
                    url: /developer-tools/yaml
                  - icon: mdi:power
                    tap_action:
                      action: call-service
                      service: homeassistant.restart
                      service_data: {}
                      confirmation:
                        text: Are you sure you want to restart Home Assistant?
            media_player: {}
            desktop: {}
    cards: []
  - title: Hallway
    path: hallway
    type: sections
    style: |
      :host {
        --view-padding: 0 16px !important;
        --lovelace-view-margin: 0 16px !important;
        position: relative;
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
      }
      bubble-card {
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
        --bubble-icon-opacity: 1 !important;
        --bubble-icon-opacity-active: 1 !important;
        --bubble-icon-opacity-disabled: 1 !important;
      }
      bubble-card .bubble-icon,
      bubble-card .bubble-main-icon-container,
      bubble-card .bubble-main-icon-container ha-icon,
      bubble-card ha-icon,
      bubble-card .is-off .bubble-main-icon,
      bubble-card .is-off .bubble-main-icon-container,
      bubble-card .is-off ha-icon {
        color: white !important;
        fill: white !important;
        opacity: 1 !important;
        filter: none !important;
      }
      bubble-card .is-off .bubble-background,
      bubble-card .is-off .bubble-icon-container {
        background: rgba(255, 255, 255, 0.35) !important;
      }
      :host::before {
        content: "";
        position: fixed;
        inset: 0;
        background-image: url("media-source://image_upload/b9449f15a0e0c05ad7c84ebd806b883c");
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
        filter: blur(18px) saturate(140%);
        transform: scale(1.05);     /* avoids clipping after blur */
        z-index: -2;
      }
      :host::after {
        content: "";
        position: fixed;
        inset: 0;
        background: rgba(12, 18, 28, 0.35);  /* frosted tint */
        backdrop-filter: blur(8px);
        z-index: -1;
      }
      hui-view-header,
      hui-section-heading-row,
      hui-section-heading-tile {
        display: none !important;
      }
    sections:
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: button
            button_type: name
            show_name: false
            show_state: false
            show_icon: true
            icon: mdi:chevron-left
            tap_action:
              action: fire-dom-event
              browser_mod:
                service: browser_mod.javascript
                data:
                  code: history.back()
            button_action:
              tap_action:
                action: fire-dom-event
                browser_mod:
                  service: browser_mod.javascript
                  data:
                    code: history.back()
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .bubble-icon,
              .bubble-main-icon,
              .bubble-main-icon-container ha-icon {
                color: white !important;
                opacity: 1 !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-button-card-container {
                display: flex !important;
                align-items: center !important;
                justify-content: flex-start !important;
                padding: 0 !important;
                border: 0 !important;
                background: transparent !important;
                box-shadow: none !important;
                cursor: pointer;
                margin-left: -16px !important;
              }
              .bubble-button-card-container:hover,
              .bubble-button-card-container:focus,
              .bubble-button-card-container:active {
                background: transparent !important;
                box-shadow: none !important;
                filter: none !important;
              }


              .bubble-icon-container {
                background: transparent !important;
                box-shadow: none !important;
              }

              .bubble-icon {
                --mdc-icon-size: 36px !important;
                padding: 0 !important;
              }
            grid_options:
              columns: 2
              rows: auto
          - type: markdown
            content: '# Hallway'
            text_only: true
            grid_options:
              columns: 6
              rows: auto
            card_mod:
              style: |
                ha-card {
                  display: flex;
                  align-items: center;   # vertical center
                  justify-content: center;  # optional horizontal center
                  height: 100%;
                  padding: 0;
                  margin-left: -32px !important;
                  --card-mod-script: |
                    if (window.__bubbleForceWhiteInit) {
                      return;
                    }
                    window.__bubbleForceWhiteInit = true;
                    const styleId = 'bubble-force-white-style';
                    const cssLines = [
                      '.bubble-icon,',
                      '.bubble-main-icon,',
                      '.bubble-main-icon-container,',
                      '.bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.is-off .bubble-icon,',
                      '.is-off .bubble-main-icon,',
                      '.is-off .bubble-main-icon-container,',
                      '.is-off .bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.ha-markdown-element {',
                      '  color: white !important',
                      '}',
                    ];
                    const css = cssLines.join('\n');
                    const touchIcons = (root) => {
                      if (!root) {
                        return;
                      }
                      root.querySelectorAll('.bubble-icon, .bubble-main-icon, .bubble-main-icon-container ha-icon').forEach((icon) => {
                        icon.style.setProperty('color', 'white', 'important');
                        icon.style.setProperty('fill', 'white', 'important');
                        icon.style.setProperty('opacity', '1', 'important');
                        icon.style.removeProperty('filter');
                      });
                    };
                    const applyStyles = (card) => {
                      if (!card) {
                        return;
                      }
                      const root = card.shadowRoot || card;
                      if (!root) {
                        return;
                      }
                      if (!root.getElementById(styleId)) {
                        const style = document.createElement('style');
                        style.id = styleId;
                        style.textContent = css;
                        root.appendChild(style);
                      }
                      touchIcons(root);
                    };
                    const registeredRoots = new Set();
                    const registerRoot = (root) => {
                      if (
                        root &&
                        typeof root.querySelectorAll === 'function' &&
                        !registeredRoots.has(root)
                      ) {
                        registeredRoots.add(root);
                      }
                    };
                    const scan = () => {
                      registeredRoots.forEach((root) => {
                        root.querySelectorAll('bubble-card').forEach(applyStyles);
                        root.querySelectorAll('*').forEach((el) => {
                          if (el.shadowRoot) {
                            registerRoot(el.shadowRoot);
                          }
                        });
                      });
                    };
                    registerRoot(document);
                    registerRoot(document.body);
                    registerRoot(document.documentElement);
                    scan();
                    window.__bubbleForceWhiteInterval = window.setInterval(() => {
                      scan();
                    }, 750);
                }
                ha-markdown {
                  margin: 0;
                  width: 100%;
                  text-align: center;    # drop if you only want vertical centering
                   color: white !important;
                }
          - type: custom:swipe-card
            grid_options:
              columns: full
              rows: 1
            parameters:
              slidesPerView: auto
              spaceBetween: 12
              freeMode: true
              freeModeSticky: false
              mousewheel: true
            style: |
              margin-bottom: 10px !important;
            cards:
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: light.hallway
                name: Lights
                show_state: true
                icon: mdi:lightbulb
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    --lights-color: ${(() => {
                      const light = hass.states[entity];
                      if (!light) {
                        return 'rgba(255, 255, 255, 0.35)';
                      }
                      const state = light.state;
                      if (state === 'off') {
                        return '#1e88e5';
                      }
                      if (state === 'unavailable') {
                        return 'rgba(120, 120, 120, 0.6)';
                      }
                      const attrs = light.attributes || {};
                      const rgb = attrs.rgb_color;
                      if (Array.isArray(rgb) && rgb.length === 3) {
                        const [r, g, b] = rgb;
                        return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                      }
                      const hs = attrs.hs_color;
                      if (Array.isArray(hs) && hs.length === 2) {
                        const hue = hs[0];
                        const sat = (hs[1] || 0) / 100;
                        const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                        const c = brightness * sat;
                        const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                        const m = brightness - c;
                        let r1 = 0;
                        let g1 = 0;
                        let b1 = 0;
                        if (hue >= 0 && hue < 60) {
                          r1 = c;
                          g1 = x;
                        } else if (hue < 120) {
                          r1 = x;
                          g1 = c;
                        } else if (hue < 180) {
                          g1 = c;
                          b1 = x;
                        } else if (hue < 240) {
                          g1 = x;
                          b1 = c;
                        } else if (hue < 300) {
                          r1 = x;
                          b1 = c;
                        } else {
                          r1 = c;
                          b1 = x;
                        }
                        const r = Math.round((r1 + m) * 255);
                        const g = Math.round((g1 + m) * 255);
                        const b = Math.round((b1 + m) * 255);
                        return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                      }
                      const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                      if (temp) {
                        const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                        const kelvin = clamp(temp, 2000, 6500);
                        const t = kelvin / 100;
                        let r;
                        let g;
                        let b;
                        if (t <= 66) {
                          r = 255;
                          g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                        } else {
                          r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                          g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                        }
                        if (t >= 66) {
                          b = 255;
                        } else if (t <= 19) {
                          b = 0;
                        } else {
                          b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                        }
                        return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                      }
                      return 'rgba(255, 255, 255, 0.35)';
                    })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--lights-color) !important;
                  }
                tap_action:
                  action: navigate
                  navigation_path: '#lights-hallway'
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#lights-hallway'
                card_mod:
                  style: >
                    :host {
                      width: auto;
                      max-width: 130px;
                      flex: 0 0 auto;
                      margin-bottom: 10px !important;
                      --bubble-icon-color: white;          # primary icon color
                      --bubble-icon-color-active: white;   # when entity is "on"
                      --bubble-icon-color-disabled: white;
                      --bubble-button-spacing: 0px;   /* no gap between icon and text */
                    }

                    .bubble-main-icon-container {
                      background: none !important;
                      box-shadow: none !important;
                      padding: 0 !important;
                      width: auto !important;
                      height: auto !important;
                      pointer-events: none !important;
                    }

                    .bubble-main-icon-container ha-icon {
                      width: 24px;   /* or any size you need */
                      height: 24px;
                      color: white !important;
                    }

                    .bubble-main-icon-container ha-ripple,

                    .bubble-main-icon-container .bubble-icon-feedback-container
                    {
                      display: none !important;   /* remove ripple/feedback layers */
                    }
              - type: custom:bubble-card
                card_type: button
                button_type: state
                entity: input_text.hallway_climate_range
                icon: mdi:thermometer
                name: Climate
                show_state: true
                modules:
                  - frosted_glass
                  - get_state_attribute
                get_state_attribute:
                  - entity: input_text.hallway_climate_range
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    width: auto;
                    max-width: 180px;
                    flex: 0 0 auto;
                    margin-bottom: 10px !important;
                    --climate-color: ${(() => {
                      const color = hass.states['input_text.hallway_climate_color']?.state?.trim();
                      return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                    })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--climate-color) !important;
                  }

                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#climate-hallway'
                  hold_action:
                    action: none
                icon_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#climate-hallway'
                  hold_action:
                    action: none
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: binary_sensor.hallway_guest_bath_gym_presence_sensor_occupancy
                name: Occupancy
                icon: mdi:motion-sensor
                show_state: true
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    --occupancy-color: ${(() => {
                        const securityEntity = 'alarm_control_panel.aqara_hub_m3_0056_security_system_2';
                        const occState = hass.states[entity]?.state;
                        const securityState = hass.states[securityEntity]?.state;
                        const occupiedStates = ['on', 'detected', 'occupied'];
                        const clearStates = ['off', 'clear', 'standby'];
                        if (clearStates.includes(occState)) {
                          return '#43a047';
                        }
                        if (occupiedStates.includes(occState) && securityState === 'armed_away') {
                          return '#e53935';
                        }
                        if (occupiedStates.includes(occState)) {
                          return '#1e88e5';
                        }
                        if (occState === 'unavailable') {
                          return 'rgba(120, 120, 120, 0.6)';
                        }
                        return '#546e7a';
                      })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--occupancy-color) !important;
                  }
                card_mod:
                  style: >
                    :host {
                      width: auto;
                      max-width: 150px;
                      flex: 0 0 auto;
                      margin-bottom: 10px !important;
                      --bubble-icon-color: white;          # primary icon color
                      --bubble-icon-color-active: white;   # when entity is "on"
                      --bubble-icon-color-disabled: white;    # when unavailable
                    }

                    .bubble-main-icon-container {
                      background: none !important;
                      box-shadow: none !important;
                      padding: 0 !important;
                      width: auto !important;
                      height: auto !important;
                      pointer-events: none !important;
                    }

                    .bubble-main-icon-container ha-icon {
                      width: 24px;   /* or any size you need */
                      height: 24px;
                      color: white !important;
                    }

                    .bubble-main-icon-container ha-ripple,

                    .bubble-main-icon-container .bubble-icon-feedback-container
                    {
                      display: none !important;   /* remove ripple/feedback layers */
                    }
        column_span: 4
      - type: grid
        cards:
          - type: vertical-stack
            grid_options:
              columns: full
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#lights-hallway'
                button_type: name
                show_icon: false
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                  .bubble-pop-up-background {
                    background-color: rgba(25, 36, 54, 0.55) !important;
                    filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.18);
                    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.15),
                        0 15px 40px rgba(0, 0, 0, 0.35);
                  }
              - type: custom:bubble-card
                card_type: separator
                name: Hallway Lights
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button:
                  - entity: light.hallway
                    tap_action:
                      action: toggle
                    icon: ''
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_19
                    name: Entry Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }

                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_1_2
                    name: Gym Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }

                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_22
                    name: Guest Room Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }

                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_21
                    name: Office Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }

                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                columns: 2
        column_span: 4
      - type: grid
        cards:
          - type: vertical-stack
            grid_options:
              columns: full
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#climate-hallway'
                button_type: name
                show_icon: false
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                  .bubble-pop-up-background {
                    background-color: rgba(25, 36, 54, 0.55) !important;
                    filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.18);
                    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.15),
                        0 15px 40px rgba(0, 0, 0, 0.35);
                  }
              - type: custom:bubble-card
                card_type: separator
                name: Hallway Climate
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button: []
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: >-
                      sensor.hallway_entryway_living_room_presence_sensor_temperature
                    name: Entryway
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.entryway_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.hallway_guest_bath_gym_presence_sensor_temperature
                    name: Guest Bath
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.gym_door_guest_bath_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.aqara_presence_multisensor_fp300_temperature
                    name: Office
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.office_door_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.home_current_temperature
                    name: Ecobee
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.hallway_ecobee_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                columns: 2
        column_span: 4
      - type: grid
        cards:
          - type: custom:navbar-card
            layout:
              mobile:
                mode: floating
                show_labels: false
              desktop:
                position: bottom
                show_labels: true
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .navbar-card.mobile {
                padding-bottom: calc(env(safe-area-inset-bottom, 0px));
              }
                          :host {
                            --navbar-background-color: rgba(25, 36, 54, 0.55);
                            --navbar-box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-desktop: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-mobile-floating: 0 24px 55px rgba(0, 0, 0, 0.55);
                          }
                          .navbar-card,
                          .navbar-card.desktop,
                          .navbar-card.mobile,
                          .navbar-card.desktop.bottom,
                          .navbar-card.desktop.top,
                          .navbar-card.desktop.left,
                          .navbar-card.desktop.right,
                          .navbar-card.mobile.floating,
                          ha-card.navbar-card {
                            background: rgba(25, 36, 54, 0.55) !important;
                            border: 1px solid rgba(255, 255, 255, 0.18) !important;
                            backdrop-filter: blur(20px);
                            -webkit-backdrop-filter: blur(20px);
                            box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45) !important;
                          }
            routes:
              - url: /at-a-glance/overview
                icon: mdi:home
                label: Home
                selected: |
                  [[[
                    const path = (location && location.pathname) || '';
                    const direct = ['/at-a-glance/security', '/at-a-glance/shopping-list', '/at-a-glance/chores'];
                    return !direct.some(prefix => path.startsWith(prefix));
                  ]]]
              - url: /at-a-glance/security
                icon: mdi:shield
                label: Security
              - url: /at-a-glance/shopping-list
                icon: mdi:shopping
                label: Shopping List
              - icon: mdi:dots-horizontal
                label: More
                tap_action:
                  action: open-popup
                popup:
                  - icon: mdi:cog
                    url: /config/dashboard
                  - icon: mdi:hammer
                    url: /developer-tools/yaml
                  - icon: mdi:power
                    tap_action:
                      action: call-service
                      service: homeassistant.restart
                      service_data: {}
                      confirmation:
                        text: Are you sure you want to restart Home Assistant?
            media_player: {}
            desktop: {}
    cards: []
  - title: Office
    path: office
    type: sections
    style: |
      :host {
        --view-padding: 0 16px !important;
        --lovelace-view-margin: 0 16px !important;
        position: relative;
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
      }
      bubble-card {
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
        --bubble-icon-opacity: 1 !important;
        --bubble-icon-opacity-active: 1 !important;
        --bubble-icon-opacity-disabled: 1 !important;
      }
      bubble-card .bubble-icon,
      bubble-card .bubble-main-icon-container,
      bubble-card .bubble-main-icon-container ha-icon,
      bubble-card ha-icon,
      bubble-card .is-off .bubble-main-icon,
      bubble-card .is-off .bubble-main-icon-container,
      bubble-card .is-off ha-icon {
        color: white !important;
        fill: white !important;
        opacity: 1 !important;
        filter: none !important;
      }
      bubble-card .is-off .bubble-background,
      bubble-card .is-off .bubble-icon-container {
        background: rgba(255, 255, 255, 0.35) !important;
      }
      :host::before {
        content: "";
        position: fixed;
        inset: 0;
        background-image: url("media-source://image_upload/b9449f15a0e0c05ad7c84ebd806b883c");
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
        filter: blur(18px) saturate(140%);
        transform: scale(1.05);     /* avoids clipping after blur */
        z-index: -2;
      }
      :host::after {
        content: "";
        position: fixed;
        inset: 0;
        background: rgba(12, 18, 28, 0.35);  /* frosted tint */
        backdrop-filter: blur(8px);
        z-index: -1;
      }
      hui-view-header,
      hui-section-heading-row,
      hui-section-heading-tile {
        display: none !important;
      }
    sections:
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: button
            button_type: name
            show_name: false
            show_state: false
            show_icon: true
            icon: mdi:chevron-left
            tap_action:
              action: fire-dom-event
              browser_mod:
                service: browser_mod.javascript
                data:
                  code: history.back()
            button_action:
              tap_action:
                action: fire-dom-event
                browser_mod:
                  service: browser_mod.javascript
                  data:
                    code: history.back()
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .bubble-icon,
              .bubble-main-icon,
              .bubble-main-icon-container ha-icon {
                color: white !important;
                opacity: 1 !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-button-card-container {
                display: flex !important;
                align-items: center !important;
                justify-content: flex-start !important;
                padding: 0 !important;
                border: 0 !important;
                background: transparent !important;
                box-shadow: none !important;
                cursor: pointer;
                margin-left: -16px !important;
              }
              .bubble-button-card-container:hover,
              .bubble-button-card-container:focus,
              .bubble-button-card-container:active {
                background: transparent !important;
                box-shadow: none !important;
                filter: none !important;
              }


              .bubble-icon-container {
                background: transparent !important;
                box-shadow: none !important;
              }

              .bubble-icon {
                --mdc-icon-size: 36px !important;
                padding: 0 !important;
              }
            grid_options:
              columns: 2
              rows: auto
          - type: markdown
            content: '# Office'
            text_only: true
            grid_options:
              columns: 6
              rows: auto
            card_mod:
              style: |
                ha-card {
                  display: flex;
                  align-items: center;   # vertical center
                  justify-content: center;  # optional horizontal center
                  height: 100%;
                  padding: 0;
                  margin-left: -32px !important;
                  --card-mod-script: |
                    if (window.__bubbleForceWhiteInit) {
                      return;
                    }
                    window.__bubbleForceWhiteInit = true;
                    const styleId = 'bubble-force-white-style';
                    const cssLines = [
                      '.bubble-icon,',
                      '.bubble-main-icon,',
                      '.bubble-main-icon-container,',
                      '.bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.is-off .bubble-icon,',
                      '.is-off .bubble-main-icon,',
                      '.is-off .bubble-main-icon-container,',
                      '.is-off .bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.ha-markdown-element {',
                      '  color: white !important',
                      '}',
                    ];
                    const css = cssLines.join('\n');
                    const touchIcons = (root) => {
                      if (!root) {
                        return;
                      }
                      root.querySelectorAll('.bubble-icon, .bubble-main-icon, .bubble-main-icon-container ha-icon').forEach((icon) => {
                        icon.style.setProperty('color', 'white', 'important');
                        icon.style.setProperty('fill', 'white', 'important');
                        icon.style.setProperty('opacity', '1', 'important');
                        icon.style.removeProperty('filter');
                      });
                    };
                    const applyStyles = (card) => {
                      if (!card) {
                        return;
                      }
                      const root = card.shadowRoot || card;
                      if (!root) {
                        return;
                      }
                      if (!root.getElementById(styleId)) {
                        const style = document.createElement('style');
                        style.id = styleId;
                        style.textContent = css;
                        root.appendChild(style);
                      }
                      touchIcons(root);
                    };
                    const registeredRoots = new Set();
                    const registerRoot = (root) => {
                      if (
                        root &&
                        typeof root.querySelectorAll === 'function' &&
                        !registeredRoots.has(root)
                      ) {
                        registeredRoots.add(root);
                      }
                    };
                    const scan = () => {
                      registeredRoots.forEach((root) => {
                        root.querySelectorAll('bubble-card').forEach(applyStyles);
                        root.querySelectorAll('*').forEach((el) => {
                          if (el.shadowRoot) {
                            registerRoot(el.shadowRoot);
                          }
                        });
                      });
                    };
                    registerRoot(document);
                    registerRoot(document.body);
                    registerRoot(document.documentElement);
                    scan();
                    window.__bubbleForceWhiteInterval = window.setInterval(() => {
                      scan();
                    }, 750);
                }
                ha-markdown {
                  margin: 0;
                  width: 100%;
                  text-align: center;    # drop if you only want vertical centering
                   color: white !important;
                }
          - type: custom:swipe-card
            grid_options:
              columns: full
              rows: 1
            parameters:
              slidesPerView: auto
              spaceBetween: 12
              freeMode: true
              freeModeSticky: false
              mousewheel: true
            style: |
              margin-bottom: 10px !important;
            cards:
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: light.office
                name: Light
                show_state: true
                icon: mdi:lightbulb
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    --lights-color: ${(() => {
                      const light = hass.states[entity];
                      if (!light) {
                        return 'rgba(255, 255, 255, 0.35)';
                      }
                      const state = light.state;
                      if (state === 'off') {
                        return '#1e88e5';
                      }
                      if (state === 'unavailable') {
                        return 'rgba(120, 120, 120, 0.6)';
                      }
                      const attrs = light.attributes || {};
                      const rgb = attrs.rgb_color;
                      if (Array.isArray(rgb) && rgb.length === 3) {
                        const [r, g, b] = rgb;
                        return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                      }
                      const hs = attrs.hs_color;
                      if (Array.isArray(hs) && hs.length === 2) {
                        const hue = hs[0];
                        const sat = (hs[1] || 0) / 100;
                        const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                        const c = brightness * sat;
                        const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                        const m = brightness - c;
                        let r1 = 0;
                        let g1 = 0;
                        let b1 = 0;
                        if (hue >= 0 && hue < 60) {
                          r1 = c;
                          g1 = x;
                        } else if (hue < 120) {
                          r1 = x;
                          g1 = c;
                        } else if (hue < 180) {
                          g1 = c;
                          b1 = x;
                        } else if (hue < 240) {
                          g1 = x;
                          b1 = c;
                        } else if (hue < 300) {
                          r1 = x;
                          b1 = c;
                        } else {
                          r1 = c;
                          b1 = x;
                        }
                        const r = Math.round((r1 + m) * 255);
                        const g = Math.round((g1 + m) * 255);
                        const b = Math.round((b1 + m) * 255);
                        return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                      }
                      const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                      if (temp) {
                        const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                        const kelvin = clamp(temp, 2000, 6500);
                        const t = kelvin / 100;
                        let r;
                        let g;
                        let b;
                        if (t <= 66) {
                          r = 255;
                          g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                        } else {
                          r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                          g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                        }
                        if (t >= 66) {
                          b = 255;
                        } else if (t <= 19) {
                          b = 0;
                        } else {
                          b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                        }
                        return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                      }
                      return 'rgba(255, 255, 255, 0.35)';
                    })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--lights-color) !important;
                  }
                tap_action:
                  action: navigate
                  navigation_path: '#lights-office'
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#lights-office'
                card_mod:
                  style: >
                    :host {
                      width: auto;
                      max-width: 130px;
                      flex: 0 0 auto;
                      margin-bottom: 10px !important;
                      --bubble-icon-color: white;          # primary icon color
                      --bubble-icon-color-active: white;   # when entity is "on"
                      --bubble-icon-color-disabled: white;
                      --bubble-button-spacing: 0px;   /* no gap between icon and text */
                    }

                    .bubble-main-icon-container {
                      background: none !important;
                      box-shadow: none !important;
                      padding: 0 !important;
                      width: auto !important;
                      height: auto !important;
                      pointer-events: none !important;
                    }

                    .bubble-main-icon-container ha-icon {
                      width: 24px;   /* or any size you need */
                      height: 24px;
                      color: white !important;
                    }

                    .bubble-main-icon-container ha-ripple,

                    .bubble-main-icon-container .bubble-icon-feedback-container
                    {
                      display: none !important;   /* remove ripple/feedback layers */
                    }
              - type: custom:bubble-card
                card_type: button
                button_type: state
                entity: input_text.office_climate_range
                icon: mdi:thermometer
                name: Climate
                show_state: true
                modules:
                  - frosted_glass
                  - get_state_attribute
                get_state_attribute:
                  - entity: input_text.office_climate_range
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    width: auto;
                    max-width: 180px;
                    flex: 0 0 auto;
                    margin-bottom: 10px !important;
                    --climate-color: ${(() => {
                      const color = hass.states['input_text.office_climate_color']?.state?.trim();
                      return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                    })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--climate-color) !important;
                  }

                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#climate-office'
                  hold_action:
                    action: none
                icon_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#climate-office'
                  hold_action:
                    action: none
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: binary_sensor.office_presence_sensor_occupancy
                name: Occupancy
                icon: mdi:motion-sensor
                show_state: true
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    --occupancy-color: ${(() => {
                        const securityEntity = 'alarm_control_panel.aqara_hub_m3_0056_security_system_2';
                        const occState = hass.states[entity]?.state;
                        const securityState = hass.states[securityEntity]?.state;
                        const occupiedStates = ['on', 'detected', 'occupied'];
                        const clearStates = ['off', 'clear', 'standby'];
                        if (clearStates.includes(occState)) {
                          return '#43a047';
                        }
                        if (occupiedStates.includes(occState) && securityState === 'armed_away') {
                          return '#e53935';
                        }
                        if (occupiedStates.includes(occState)) {
                          return '#1e88e5';
                        }
                        if (occState === 'unavailable') {
                          return 'rgba(120, 120, 120, 0.6)';
                        }
                        return '#546e7a';
                      })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--occupancy-color) !important;
                  }
                card_mod:
                  style: >
                    :host {
                      width: auto;
                      max-width: 150px;
                      flex: 0 0 auto;
                      margin-bottom: 10px !important;
                      --bubble-icon-color: white;          # primary icon color
                      --bubble-icon-color-active: white;   # when entity is "on"
                      --bubble-icon-color-disabled: white;    # when unavailable
                    }

                    .bubble-main-icon-container {
                      background: none !important;
                      box-shadow: none !important;
                      padding: 0 !important;
                      width: auto !important;
                      height: auto !important;
                      pointer-events: none !important;
                    }

                    .bubble-main-icon-container ha-icon {
                      width: 24px;   /* or any size you need */
                      height: 24px;
                      color: white !important;
                    }

                    .bubble-main-icon-container ha-ripple,

                    .bubble-main-icon-container .bubble-icon-feedback-container
                    {
                      display: none !important;   /* remove ripple/feedback layers */
                    }
        column_span: 4
      - type: grid
        cards:
          - type: vertical-stack
            grid_options:
              columns: full
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#lights-office'
                button_type: name
                show_icon: false
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                  .bubble-pop-up-background {
                    background-color: rgba(25, 36, 54, 0.55) !important;
                    filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.18);
                    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.15),
                        0 15px 40px rgba(0, 0, 0, 0.35);
                  }
              - type: custom:bubble-card
                card_type: separator
                name: Office Light
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button:
                  - entity: light.office
                    tap_action:
                      action: toggle
                    icon: mdi:lightbulb
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_10
                    name: Office Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }

                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                columns: 2
        column_span: 4
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: separator
            name: Climate
            card_layout: large
            rows: '01'
            grid_options:
              columns: full
            sub_button: []
          - type: custom:bubble-card
            card_type: button
            button_type: switch
            entity: cover.office_vent_vent
            icon: mdi:air-filter
            tap_action:
              action: perform-action
              perform_action: cover.toggle_cover_tilt
              target:
                entity_id: cover.office_vent_vent
              data: {}
            button_action:
              tap_action:
                action: perform-action
                perform_action: cover.toggle_cover_tilt
                target:
                  entity_id: cover.office_vent_vent
                data: {}
            grid_options:
              columns: 6
              rows: auto
            name: Vent
            show_state: true
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-main-icon-container {
                background: none !important;
                box-shadow: none !important;
                padding: 0 !important;
                width: auto !important;
                height: auto !important;
                pointer-events: none !important;
              }
        column_span: 4
      - type: grid
        cards:
          - type: vertical-stack
            grid_options:
              columns: full
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#climate-office'
                button_type: name
                show_icon: false
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                  .bubble-pop-up-background {
                    background-color: rgba(25, 36, 54, 0.55) !important;
                    filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.18);
                    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.15),
                        0 15px 40px rgba(0, 0, 0, 0.35);
                  }
              - type: custom:bubble-card
                card_type: separator
                name: Office Climate
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button: []
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.office_presence_sensor_temperature
                    name: Office
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.office_presence_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.aqara_presence_multisensor_fp300_temperature
                    name: Office Door
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.office_door_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.office_temperature
                    name: Ecobee
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.office_ecobee_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                columns: 2
        column_span: 4
      - type: grid
        cards:
          - type: custom:navbar-card
            layout:
              mobile:
                mode: floating
                show_labels: false
              desktop:
                position: bottom
                show_labels: true
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .navbar-card.mobile {
                padding-bottom: calc(env(safe-area-inset-bottom, 0px));
              }
                          :host {
                            --navbar-background-color: rgba(25, 36, 54, 0.55);
                            --navbar-box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-desktop: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-mobile-floating: 0 24px 55px rgba(0, 0, 0, 0.55);
                          }
                          .navbar-card,
                          .navbar-card.desktop,
                          .navbar-card.mobile,
                          .navbar-card.desktop.bottom,
                          .navbar-card.desktop.top,
                          .navbar-card.desktop.left,
                          .navbar-card.desktop.right,
                          .navbar-card.mobile.floating,
                          ha-card.navbar-card {
                            background: rgba(25, 36, 54, 0.55) !important;
                            border: 1px solid rgba(255, 255, 255, 0.18) !important;
                            backdrop-filter: blur(20px);
                            -webkit-backdrop-filter: blur(20px);
                            box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45) !important;
                          }
            routes:
              - url: /at-a-glance/overview
                icon: mdi:home
                label: Home
                selected: |
                  [[[
                    const path = (location && location.pathname) || '';
                    const direct = ['/at-a-glance/security', '/at-a-glance/shopping-list', '/at-a-glance/chores'];
                    return !direct.some(prefix => path.startsWith(prefix));
                  ]]]
              - url: /at-a-glance/security
                icon: mdi:shield
                label: Security
              - url: /at-a-glance/shopping-list
                icon: mdi:shopping
                label: Shopping List
              - icon: mdi:dots-horizontal
                label: More
                tap_action:
                  action: open-popup
                popup:
                  - icon: mdi:cog
                    url: /config/dashboard
                  - icon: mdi:hammer
                    url: /developer-tools/yaml
                  - icon: mdi:power
                    tap_action:
                      action: call-service
                      service: homeassistant.restart
                      service_data: {}
                      confirmation:
                        text: Are you sure you want to restart Home Assistant?
            media_player: {}
            desktop: {}
    cards: []
  - title: Kitchen
    path: kitchen
    type: sections
    style: |
      :host {
        --view-padding: 0 16px !important;
        --lovelace-view-margin: 0 16px !important;
        position: relative;
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
      }
      bubble-card {
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
        --bubble-icon-opacity: 1 !important;
        --bubble-icon-opacity-active: 1 !important;
        --bubble-icon-opacity-disabled: 1 !important;
      }
      bubble-card .bubble-icon,
      bubble-card .bubble-main-icon-container,
      bubble-card .bubble-main-icon-container ha-icon,
      bubble-card ha-icon,
      bubble-card .is-off .bubble-main-icon,
      bubble-card .is-off .bubble-main-icon-container,
      bubble-card .is-off ha-icon {
        color: white !important;
        fill: white !important;
        opacity: 1 !important;
        filter: none !important;
      }
      bubble-card .is-off .bubble-background,
      bubble-card .is-off .bubble-icon-container {
        background: rgba(255, 255, 255, 0.35) !important;
      }
      :host::before {
        content: "";
        position: fixed;
        inset: 0;
        background-image: url("media-source://image_upload/b9449f15a0e0c05ad7c84ebd806b883c");
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
        filter: blur(18px) saturate(140%);
        transform: scale(1.05);     /* avoids clipping after blur */
        z-index: -2;
      }
      :host::after {
        content: "";
        position: fixed;
        inset: 0;
        background: rgba(12, 18, 28, 0.35);  /* frosted tint */
        backdrop-filter: blur(8px);
        z-index: -1;
      }
      hui-view-header,
      hui-section-heading-row,
      hui-section-heading-tile {
        display: none !important;
      }
    sections:
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: button
            button_type: name
            show_name: false
            show_state: false
            show_icon: true
            icon: mdi:chevron-left
            tap_action:
              action: fire-dom-event
              browser_mod:
                service: browser_mod.javascript
                data:
                  code: history.back()
            button_action:
              tap_action:
                action: fire-dom-event
                browser_mod:
                  service: browser_mod.javascript
                  data:
                    code: history.back()
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .bubble-icon,
              .bubble-main-icon,
              .bubble-main-icon-container ha-icon {
                color: white !important;
                opacity: 1 !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-button-card-container {
                display: flex !important;
                align-items: center !important;
                justify-content: flex-start !important;
                padding: 0 !important;
                border: 0 !important;
                background: transparent !important;
                box-shadow: none !important;
                cursor: pointer;
                margin-left: -16px !important;
              }
              .bubble-button-card-container:hover,
              .bubble-button-card-container:focus,
              .bubble-button-card-container:active {
                background: transparent !important;
                box-shadow: none !important;
                filter: none !important;
              }


              .bubble-icon-container {
                background: transparent !important;
                box-shadow: none !important;
              }

              .bubble-icon {
                --mdc-icon-size: 36px !important;
                padding: 0 !important;
              }
            grid_options:
              columns: 2
              rows: auto
          - type: markdown
            content: '# Kitchen'
            text_only: true
            grid_options:
              columns: 6
              rows: auto
            card_mod:
              style: |
                ha-card {
                  display: flex;
                  align-items: center;   # vertical center
                  justify-content: center;  # optional horizontal center
                  height: 100%;
                  padding: 0;
                  margin-left: -32px !important;
                  --card-mod-script: |
                    if (window.__bubbleForceWhiteInit) {
                      return;
                    }
                    window.__bubbleForceWhiteInit = true;
                    const styleId = 'bubble-force-white-style';
                    const cssLines = [
                      '.bubble-icon,',
                      '.bubble-main-icon,',
                      '.bubble-main-icon-container,',
                      '.bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.is-off .bubble-icon,',
                      '.is-off .bubble-main-icon,',
                      '.is-off .bubble-main-icon-container,',
                      '.is-off .bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.ha-markdown-element {',
                      '  color: white !important',
                      '}',
                    ];
                    const css = cssLines.join('\n');
                    const touchIcons = (root) => {
                      if (!root) {
                        return;
                      }
                      root.querySelectorAll('.bubble-icon, .bubble-main-icon, .bubble-main-icon-container ha-icon').forEach((icon) => {
                        icon.style.setProperty('color', 'white', 'important');
                        icon.style.setProperty('fill', 'white', 'important');
                        icon.style.setProperty('opacity', '1', 'important');
                        icon.style.removeProperty('filter');
                      });
                    };
                    const applyStyles = (card) => {
                      if (!card) {
                        return;
                      }
                      const root = card.shadowRoot || card;
                      if (!root) {
                        return;
                      }
                      if (!root.getElementById(styleId)) {
                        const style = document.createElement('style');
                        style.id = styleId;
                        style.textContent = css;
                        root.appendChild(style);
                      }
                      touchIcons(root);
                    };
                    const registeredRoots = new Set();
                    const registerRoot = (root) => {
                      if (
                        root &&
                        typeof root.querySelectorAll === 'function' &&
                        !registeredRoots.has(root)
                      ) {
                        registeredRoots.add(root);
                      }
                    };
                    const scan = () => {
                      registeredRoots.forEach((root) => {
                        root.querySelectorAll('bubble-card').forEach(applyStyles);
                        root.querySelectorAll('*').forEach((el) => {
                          if (el.shadowRoot) {
                            registerRoot(el.shadowRoot);
                          }
                        });
                      });
                    };
                    registerRoot(document);
                    registerRoot(document.body);
                    registerRoot(document.documentElement);
                    scan();
                    window.__bubbleForceWhiteInterval = window.setInterval(() => {
                      scan();
                    }, 750);
                }
                ha-markdown {
                  margin: 0;
                  width: 100%;
                  text-align: center;    # drop if you only want vertical centering
                   color: white !important;
                }
          - type: custom:swipe-card
            grid_options:
              columns: full
              rows: 1
            parameters:
              slidesPerView: auto
              spaceBetween: 12
              freeMode: true
              freeModeSticky: false
              mousewheel: true
            style: |
              margin-bottom: 10px !important;
            cards:
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: light.kitchen
                name: Lights
                show_state: true
                icon: mdi:lightbulb
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    --lights-color: ${(() => {
                      const light = hass.states[entity];
                      if (!light) {
                        return 'rgba(255, 255, 255, 0.35)';
                      }
                      const state = light.state;
                      if (state === 'off') {
                        return '#1e88e5';
                      }
                      if (state === 'unavailable') {
                        return 'rgba(120, 120, 120, 0.6)';
                      }
                      const attrs = light.attributes || {};
                      const rgb = attrs.rgb_color;
                      if (Array.isArray(rgb) && rgb.length === 3) {
                        const [r, g, b] = rgb;
                        return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                      }
                      const hs = attrs.hs_color;
                      if (Array.isArray(hs) && hs.length === 2) {
                        const hue = hs[0];
                        const sat = (hs[1] || 0) / 100;
                        const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                        const c = brightness * sat;
                        const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                        const m = brightness - c;
                        let r1 = 0;
                        let g1 = 0;
                        let b1 = 0;
                        if (hue >= 0 && hue < 60) {
                          r1 = c;
                          g1 = x;
                        } else if (hue < 120) {
                          r1 = x;
                          g1 = c;
                        } else if (hue < 180) {
                          g1 = c;
                          b1 = x;
                        } else if (hue < 240) {
                          g1 = x;
                          b1 = c;
                        } else if (hue < 300) {
                          r1 = x;
                          b1 = c;
                        } else {
                          r1 = c;
                          b1 = x;
                        }
                        const r = Math.round((r1 + m) * 255);
                        const g = Math.round((g1 + m) * 255);
                        const b = Math.round((b1 + m) * 255);
                        return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                      }
                      const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                      if (temp) {
                        const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                        const kelvin = clamp(temp, 2000, 6500);
                        const t = kelvin / 100;
                        let r;
                        let g;
                        let b;
                        if (t <= 66) {
                          r = 255;
                          g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                        } else {
                          r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                          g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                        }
                        if (t >= 66) {
                          b = 255;
                        } else if (t <= 19) {
                          b = 0;
                        } else {
                          b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                        }
                        return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                      }
                      return 'rgba(255, 255, 255, 0.35)';
                    })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--lights-color) !important;
                  }
                tap_action:
                  action: navigate
                  navigation_path: '#lights-kitchen'
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#lights-kitchen'
                card_mod:
                  style: >
                    :host {
                      width: auto;
                      max-width: 130px;
                      flex: 0 0 auto;
                      margin-bottom: 10px !important;
                      --bubble-icon-color: white;          # primary icon color
                      --bubble-icon-color-active: white;   # when entity is "on"
                      --bubble-icon-color-disabled: white;
                      --bubble-button-spacing: 0px;   /* no gap between icon and text */
                    }

                    .bubble-main-icon-container {
                      background: none !important;
                      box-shadow: none !important;
                      padding: 0 !important;
                      width: auto !important;
                      height: auto !important;
                      pointer-events: none !important;
                    }

                    .bubble-main-icon-container ha-icon {
                      width: 24px;   /* or any size you need */
                      height: 24px;
                      color: white !important;
                    }

                    .bubble-main-icon-container ha-ripple,

                    .bubble-main-icon-container .bubble-icon-feedback-container
                    {
                      display: none !important;   /* remove ripple/feedback layers */
                    }
              - type: custom:bubble-card
                card_type: button
                button_type: state
                entity: input_text.kitchen_climate_range
                icon: mdi:thermometer
                name: Climate
                show_state: true
                modules:
                  - frosted_glass
                  - get_state_attribute
                get_state_attribute:
                  - entity: input_text.kitchen_climate_range
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    width: auto;
                    max-width: 180px;
                    flex: 0 0 auto;
                    margin-bottom: 10px !important;
                    --climate-color: ${(() => {
                      const color = hass.states['input_text.kitchen_climate_color']?.state?.trim();
                      return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                    })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--climate-color) !important;
                  }

                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#climate-kitchen'
                  hold_action:
                    action: none
                icon_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#climate-kitchen'
                  hold_action:
                    action: none
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: binary_sensor.kitchen_presence_sensor_occupancy
                name: Occupancy
                icon: mdi:motion-sensor
                show_state: true
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    --occupancy-color: ${(() => {
                        const securityEntity = 'alarm_control_panel.aqara_hub_m3_0056_security_system_2';
                        const occState = hass.states[entity]?.state;
                        const securityState = hass.states[securityEntity]?.state;
                        const occupiedStates = ['on', 'detected', 'occupied'];
                        const clearStates = ['off', 'clear', 'standby'];
                        if (clearStates.includes(occState)) {
                          return '#43a047';
                        }
                        if (occupiedStates.includes(occState) && securityState === 'armed_away') {
                          return '#e53935';
                        }
                        if (occupiedStates.includes(occState)) {
                          return '#1e88e5';
                        }
                        if (occState === 'unavailable') {
                          return 'rgba(120, 120, 120, 0.6)';
                        }
                        return '#546e7a';
                      })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--occupancy-color) !important;
                  }
                card_mod:
                  style: >
                    :host {
                      width: auto;
                      max-width: 150px;
                      flex: 0 0 auto;
                      margin-bottom: 10px !important;
                      --bubble-icon-color: white;          # primary icon color
                      --bubble-icon-color-active: white;   # when entity is "on"
                      --bubble-icon-color-disabled: white;    # when unavailable
                    }

                    .bubble-main-icon-container {
                      background: none !important;
                      box-shadow: none !important;
                      padding: 0 !important;
                      width: auto !important;
                      height: auto !important;
                      pointer-events: none !important;
                    }

                    .bubble-main-icon-container ha-icon {
                      width: 24px;   /* or any size you need */
                      height: 24px;
                      color: white !important;
                    }

                    .bubble-main-icon-container ha-ripple,

                    .bubble-main-icon-container .bubble-icon-feedback-container
                    {
                      display: none !important;   /* remove ripple/feedback layers */
                    }
        column_span: 4
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: separator
            name: Appliances
            card_layout: large
            rows: '01'
            grid_options:
              columns: full
            sub_button: []
          - type: custom:bubble-card
            card_type: button
            button_type: switch
            entity: select.dishwasher_active_program
            icon: mdi:dishwasher
            button_action:
              tap_action:
                action: more-info
            grid_options:
              columns: 12
              rows: auto
            name: Dishwasher
            show_state: true
            modules:
              - frosted_glass
              - get_state_attribute
            get_state_attribute:
              - entity: sensor.dishwasher_door
              - entity: select.dishwasher_active_program
              - entity: sensor.dishwasher_operation_state
              - entity: select.dishwasher_selected_program
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-main-icon-container {
                background: none !important;
                box-shadow: none !important;
                padding: 0 !important;
                width: auto !important;
                height: auto !important;
                pointer-events: none !important;
              }
        column_span: 4
      - type: grid
        cards:
          - type: vertical-stack
            grid_options:
              columns: full
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#lights-kitchen'
                button_type: name
                show_icon: false
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                  .bubble-pop-up-background {
                    background-color: rgba(25, 36, 54, 0.55) !important;
                    filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.18);
                    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.15),
                        0 15px 40px rgba(0, 0, 0, 0.35);
                  }
              - type: custom:bubble-card
                card_type: separator
                name: Kitchen Lights
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button:
                  - entity: light.kitchen
                    tap_action:
                      action: toggle
                    icon: ''
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_16
                    name: Table Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }

                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_18
                    name: Door Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }

                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_17
                    name: Counter Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }

                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_32
                    name: Sink Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }

                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                columns: 2
        column_span: 4
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: separator
            name: Climate
            card_layout: large
            rows: '01'
            grid_options:
              columns: full
            sub_button: []
          - type: custom:bubble-card
            card_type: button
            button_type: switch
            entity: cover.kitchen_vent_vent
            icon: mdi:air-filter
            tap_action:
              action: perform-action
              perform_action: cover.toggle_cover_tilt
              target:
                entity_id: cover.kitchen_vent_vent
              data: {}
            button_action:
              tap_action:
                action: perform-action
                perform_action: cover.toggle_cover_tilt
                target:
                  entity_id: cover.kitchen_vent_vent
                data: {}
            grid_options:
              columns: 6
              rows: auto
            name: Vent
            show_state: true
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-main-icon-container {
                background: none !important;
                box-shadow: none !important;
                padding: 0 !important;
                width: auto !important;
                height: auto !important;
                pointer-events: none !important;
              }
        column_span: 4
      - type: grid
        cards:
          - type: vertical-stack
            grid_options:
              columns: full
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#climate-kitchen'
                button_type: name
                show_icon: false
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                  .bubble-pop-up-background {
                    background-color: rgba(25, 36, 54, 0.55) !important;
                    filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.18);
                    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.15),
                        0 15px 40px rgba(0, 0, 0, 0.35);
                  }
              - type: custom:bubble-card
                card_type: separator
                name: Kitchen Climate
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button: []
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.kitchen_presence_sensor_temperature
                    name: Kitchen
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.kitchen_presence_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.kitchen_temperature
                    name: Ecobee
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.kitchen_ecobee_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                columns: 2
        column_span: 4
      - type: grid
        cards:
          - type: custom:navbar-card
            layout:
              mobile:
                mode: floating
                show_labels: false
              desktop:
                position: bottom
                show_labels: true
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .navbar-card.mobile {
                padding-bottom: calc(env(safe-area-inset-bottom, 0px));
              }
                          :host {
                            --navbar-background-color: rgba(25, 36, 54, 0.55);
                            --navbar-box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-desktop: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-mobile-floating: 0 24px 55px rgba(0, 0, 0, 0.55);
                          }
                          .navbar-card,
                          .navbar-card.desktop,
                          .navbar-card.mobile,
                          .navbar-card.desktop.bottom,
                          .navbar-card.desktop.top,
                          .navbar-card.desktop.left,
                          .navbar-card.desktop.right,
                          .navbar-card.mobile.floating,
                          ha-card.navbar-card {
                            background: rgba(25, 36, 54, 0.55) !important;
                            border: 1px solid rgba(255, 255, 255, 0.18) !important;
                            backdrop-filter: blur(20px);
                            -webkit-backdrop-filter: blur(20px);
                            box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45) !important;
                          }
            routes:
              - url: /at-a-glance/overview
                icon: mdi:home
                label: Home
                selected: |
                  [[[
                    const path = (location && location.pathname) || '';
                    const direct = ['/at-a-glance/security', '/at-a-glance/shopping-list', '/at-a-glance/chores'];
                    return !direct.some(prefix => path.startsWith(prefix));
                  ]]]
              - url: /at-a-glance/security
                icon: mdi:shield
                label: Security
              - url: /at-a-glance/shopping-list
                icon: mdi:shopping
                label: Shopping List
              - icon: mdi:dots-horizontal
                label: More
                tap_action:
                  action: open-popup
                popup:
                  - icon: mdi:cog
                    url: /config/dashboard
                  - icon: mdi:hammer
                    url: /developer-tools/yaml
                  - icon: mdi:power
                    tap_action:
                      action: call-service
                      service: homeassistant.restart
                      service_data: {}
                      confirmation:
                        text: Are you sure you want to restart Home Assistant?
            media_player: {}
            desktop: {}
    cards: []
  - title: Dining Room
    path: dining-room
    type: sections
    style: |
      :host {
        --view-padding: 0 16px !important;
        --lovelace-view-margin: 0 16px !important;
        position: relative;
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
      }
      bubble-card {
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
        --bubble-icon-opacity: 1 !important;
        --bubble-icon-opacity-active: 1 !important;
        --bubble-icon-opacity-disabled: 1 !important;
      }
      bubble-card .bubble-icon,
      bubble-card .bubble-main-icon-container,
      bubble-card .bubble-main-icon-container ha-icon,
      bubble-card ha-icon,
      bubble-card .is-off .bubble-main-icon,
      bubble-card .is-off .bubble-main-icon-container,
      bubble-card .is-off ha-icon {
        color: white !important;
        fill: white !important;
        opacity: 1 !important;
        filter: none !important;
      }
      bubble-card .is-off .bubble-background,
      bubble-card .is-off .bubble-icon-container {
        background: rgba(255, 255, 255, 0.35) !important;
      }
      :host::before {
        content: "";
        position: fixed;
        inset: 0;
        background-image: url("media-source://image_upload/b9449f15a0e0c05ad7c84ebd806b883c");
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
        filter: blur(18px) saturate(140%);
        transform: scale(1.05);     /* avoids clipping after blur */
        z-index: -2;
      }
      :host::after {
        content: "";
        position: fixed;
        inset: 0;
        background: rgba(12, 18, 28, 0.35);  /* frosted tint */
        backdrop-filter: blur(8px);
        z-index: -1;
      }
      hui-view-header,
      hui-section-heading-row,
      hui-section-heading-tile {
        display: none !important;
      }
    sections:
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: button
            button_type: name
            show_name: false
            show_state: false
            show_icon: true
            icon: mdi:chevron-left
            tap_action:
              action: fire-dom-event
              browser_mod:
                service: browser_mod.javascript
                data:
                  code: history.back()
            button_action:
              tap_action:
                action: fire-dom-event
                browser_mod:
                  service: browser_mod.javascript
                  data:
                    code: history.back()
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .bubble-icon,
              .bubble-main-icon,
              .bubble-main-icon-container ha-icon {
                color: white !important;
                opacity: 1 !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-button-card-container {
                display: flex !important;
                align-items: center !important;
                justify-content: flex-start !important;
                padding: 0 !important;
                border: 0 !important;
                background: transparent !important;
                box-shadow: none !important;
                cursor: pointer;
                margin-left: -16px !important;
              }
              .bubble-button-card-container:hover,
              .bubble-button-card-container:focus,
              .bubble-button-card-container:active {
                background: transparent !important;
                box-shadow: none !important;
                filter: none !important;
              }


              .bubble-icon-container {
                background: transparent !important;
                box-shadow: none !important;
              }

              .bubble-icon {
                --mdc-icon-size: 36px !important;
                padding: 0 !important;
              }
            grid_options:
              columns: 2
              rows: auto
          - type: markdown
            content: '# Dining Room'
            text_only: true
            grid_options:
              columns: 6
              rows: auto
            card_mod:
              style: |
                ha-card {
                  display: flex;
                  align-items: center;   # vertical center
                  justify-content: center;  # optional horizontal center
                  height: 100%;
                  padding: 0;
                  margin-left: -32px !important;
                  --card-mod-script: |
                    if (window.__bubbleForceWhiteInit) {
                      return;
                    }
                    window.__bubbleForceWhiteInit = true;
                    const styleId = 'bubble-force-white-style';
                    const cssLines = [
                      '.bubble-icon,',
                      '.bubble-main-icon,',
                      '.bubble-main-icon-container,',
                      '.bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.is-off .bubble-icon,',
                      '.is-off .bubble-main-icon,',
                      '.is-off .bubble-main-icon-container,',
                      '.is-off .bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.ha-markdown-element {',
                      '  color: white !important',
                      '}',
                    ];
                    const css = cssLines.join('\n');
                    const touchIcons = (root) => {
                      if (!root) {
                        return;
                      }
                      root.querySelectorAll('.bubble-icon, .bubble-main-icon, .bubble-main-icon-container ha-icon').forEach((icon) => {
                        icon.style.setProperty('color', 'white', 'important');
                        icon.style.setProperty('fill', 'white', 'important');
                        icon.style.setProperty('opacity', '1', 'important');
                        icon.style.removeProperty('filter');
                      });
                    };
                    const applyStyles = (card) => {
                      if (!card) {
                        return;
                      }
                      const root = card.shadowRoot || card;
                      if (!root) {
                        return;
                      }
                      if (!root.getElementById(styleId)) {
                        const style = document.createElement('style');
                        style.id = styleId;
                        style.textContent = css;
                        root.appendChild(style);
                      }
                      touchIcons(root);
                    };
                    const registeredRoots = new Set();
                    const registerRoot = (root) => {
                      if (
                        root &&
                        typeof root.querySelectorAll === 'function' &&
                        !registeredRoots.has(root)
                      ) {
                        registeredRoots.add(root);
                      }
                    };
                    const scan = () => {
                      registeredRoots.forEach((root) => {
                        root.querySelectorAll('bubble-card').forEach(applyStyles);
                        root.querySelectorAll('*').forEach((el) => {
                          if (el.shadowRoot) {
                            registerRoot(el.shadowRoot);
                          }
                        });
                      });
                    };
                    registerRoot(document);
                    registerRoot(document.body);
                    registerRoot(document.documentElement);
                    scan();
                    window.__bubbleForceWhiteInterval = window.setInterval(() => {
                      scan();
                    }, 750);
                }
                ha-markdown {
                  margin: 0;
                  width: 100%;
                  text-align: center;    # drop if you only want vertical centering
                   color: white !important;
                }
          - type: custom:swipe-card
            grid_options:
              columns: full
              rows: 1
            parameters:
              slidesPerView: auto
              spaceBetween: 12
              freeMode: true
              freeModeSticky: false
              mousewheel: true
            style: |
              margin-bottom: 10px !important;
            cards:
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: light.aqara_dimmer_switch_h2_2
                name: Light
                show_state: true
                icon: mdi:lightbulb
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    --lights-color: ${(() => {
                      const light = hass.states[entity];
                      if (!light) {
                        return 'rgba(255, 255, 255, 0.35)';
                      }
                      const state = light.state;
                      if (state === 'off') {
                        return '#1e88e5';
                      }
                      if (state === 'unavailable') {
                        return 'rgba(120, 120, 120, 0.6)';
                      }
                      const attrs = light.attributes || {};
                      const rgb = attrs.rgb_color;
                      if (Array.isArray(rgb) && rgb.length === 3) {
                        const [r, g, b] = rgb;
                        return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                      }
                      const hs = attrs.hs_color;
                      if (Array.isArray(hs) && hs.length === 2) {
                        const hue = hs[0];
                        const sat = (hs[1] || 0) / 100;
                        const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                        const c = brightness * sat;
                        const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                        const m = brightness - c;
                        let r1 = 0;
                        let g1 = 0;
                        let b1 = 0;
                        if (hue >= 0 && hue < 60) {
                          r1 = c;
                          g1 = x;
                        } else if (hue < 120) {
                          r1 = x;
                          g1 = c;
                        } else if (hue < 180) {
                          g1 = c;
                          b1 = x;
                        } else if (hue < 240) {
                          g1 = x;
                          b1 = c;
                        } else if (hue < 300) {
                          r1 = x;
                          b1 = c;
                        } else {
                          r1 = c;
                          b1 = x;
                        }
                        const r = Math.round((r1 + m) * 255);
                        const g = Math.round((g1 + m) * 255);
                        const b = Math.round((b1 + m) * 255);
                        return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                      }
                      const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                      if (temp) {
                        const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                        const kelvin = clamp(temp, 2000, 6500);
                        const t = kelvin / 100;
                        let r;
                        let g;
                        let b;
                        if (t <= 66) {
                          r = 255;
                          g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                        } else {
                          r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                          g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                        }
                        if (t >= 66) {
                          b = 255;
                        } else if (t <= 19) {
                          b = 0;
                        } else {
                          b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                        }
                        return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                      }
                      return 'rgba(255, 255, 255, 0.35)';
                    })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--lights-color) !important;
                  }
                tap_action:
                  action: navigate
                  navigation_path: '#lights-dining-room'
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#lights-dining-room'
                card_mod:
                  style: >
                    :host {
                      width: auto;
                      max-width: 130px;
                      flex: 0 0 auto;
                      margin-bottom: 10px !important;
                      --bubble-icon-color: white;          # primary icon color
                      --bubble-icon-color-active: white;   # when entity is "on"
                      --bubble-icon-color-disabled: white;
                      --bubble-button-spacing: 0px;   /* no gap between icon and text */
                    }

                    .bubble-main-icon-container {
                      background: none !important;
                      box-shadow: none !important;
                      padding: 0 !important;
                      width: auto !important;
                      height: auto !important;
                      pointer-events: none !important;
                    }

                    .bubble-main-icon-container ha-icon {
                      width: 24px;   /* or any size you need */
                      height: 24px;
                      color: white !important;
                    }

                    .bubble-main-icon-container ha-ripple,

                    .bubble-main-icon-container .bubble-icon-feedback-container
                    {
                      display: none !important;   /* remove ripple/feedback layers */
                    }
              - type: custom:bubble-card
                card_type: button
                button_type: state
                entity: input_text.dining_room_climate_range
                icon: mdi:thermometer
                name: Climate
                show_state: true
                modules:
                  - frosted_glass
                  - get_state_attribute
                get_state_attribute:
                  - entity: input_text.dining_room_climate_range
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    width: auto;
                    max-width: 180px;
                    flex: 0 0 auto;
                    margin-bottom: 10px !important;
                    --climate-color: ${(() => {
                      const color = hass.states['input_text.dining_room_climate_color']?.state?.trim();
                      return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                    })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--climate-color) !important;
                  }

                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#climate-dining-room'
                  hold_action:
                    action: none
                icon_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#climate-dining-room'
                  hold_action:
                    action: none
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: binary_sensor.dining_room_presence_sensor_occupancy
                name: Occupancy
                icon: mdi:motion-sensor
                show_state: true
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    --occupancy-color: ${(() => {
                        const securityEntity = 'alarm_control_panel.aqara_hub_m3_0056_security_system_2';
                        const occState = hass.states[entity]?.state;
                        const securityState = hass.states[securityEntity]?.state;
                        const occupiedStates = ['on', 'detected', 'occupied'];
                        const clearStates = ['off', 'clear', 'standby'];
                        if (clearStates.includes(occState)) {
                          return '#43a047';
                        }
                        if (occupiedStates.includes(occState) && securityState === 'armed_away') {
                          return '#e53935';
                        }
                        if (occupiedStates.includes(occState)) {
                          return '#1e88e5';
                        }
                        if (occState === 'unavailable') {
                          return 'rgba(120, 120, 120, 0.6)';
                        }
                        return '#546e7a';
                      })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--occupancy-color) !important;
                  }
                card_mod:
                  style: >
                    :host {
                      width: auto;
                      max-width: 150px;
                      flex: 0 0 auto;
                      margin-bottom: 10px !important;
                      --bubble-icon-color: white;          # primary icon color
                      --bubble-icon-color-active: white;   # when entity is "on"
                      --bubble-icon-color-disabled: white;    # when unavailable
                    }

                    .bubble-main-icon-container {
                      background: none !important;
                      box-shadow: none !important;
                      padding: 0 !important;
                      width: auto !important;
                      height: auto !important;
                      pointer-events: none !important;
                    }

                    .bubble-main-icon-container ha-icon {
                      width: 24px;   /* or any size you need */
                      height: 24px;
                      color: white !important;
                    }

                    .bubble-main-icon-container ha-ripple,

                    .bubble-main-icon-container .bubble-icon-feedback-container
                    {
                      display: none !important;   /* remove ripple/feedback layers */
                    }
        column_span: 4
      - type: grid
        cards:
          - type: vertical-stack
            grid_options:
              columns: full
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#lights-dining-room'
                button_type: name
                show_icon: false
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                  .bubble-pop-up-background {
                    background-color: rgba(25, 36, 54, 0.55) !important;
                    filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.18);
                    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.15),
                        0 15px 40px rgba(0, 0, 0, 0.35);
                  }
              - type: custom:bubble-card
                card_type: separator
                name: Dining Room Light
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button:
                  - entity: light.aqara_dimmer_switch_h2_2
                    tap_action:
                      action: toggle
                    icon: ''
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.aqara_dimmer_switch_h2_2
                    name: Dining Room Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }

                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                columns: 2
        column_span: 4
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: separator
            name: Climate
            card_layout: large
            rows: '01'
            grid_options:
              columns: full
            sub_button: []
          - type: custom:bubble-card
            card_type: button
            button_type: switch
            entity: cover.dining_room_vent_vent
            icon: mdi:air-filter
            tap_action:
              action: perform-action
              perform_action: cover.toggle_cover_tilt
              target:
                entity_id: cover.dining_room_vent_vent
              data: {}
            button_action:
              tap_action:
                action: perform-action
                perform_action: cover.toggle_cover_tilt
                target:
                  entity_id: cover.dining_room_vent_vent
                data: {}
            grid_options:
              columns: 6
              rows: auto
            name: Vent
            show_state: true
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-main-icon-container {
                background: none !important;
                box-shadow: none !important;
                padding: 0 !important;
                width: auto !important;
                height: auto !important;
                pointer-events: none !important;
              }
        column_span: 4
      - type: grid
        cards:
          - type: vertical-stack
            grid_options:
              columns: full
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#climate-dining-room'
                button_type: name
                show_icon: false
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                  .bubble-pop-up-background {
                    background-color: rgba(25, 36, 54, 0.55) !important;
                    filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.18);
                    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.15),
                        0 15px 40px rgba(0, 0, 0, 0.35);
                  }
              - type: custom:bubble-card
                card_type: separator
                name: Dining Room Climate
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button: []
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.dining_room_presence_sensor_temperature
                    name: Dining Room
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.dining_room_presence_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.dining_room_temperature
                    name: Ecobee
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.dining_room_ecobee_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                columns: 2
        column_span: 4
      - type: grid
        cards:
          - type: custom:navbar-card
            layout:
              mobile:
                mode: floating
                show_labels: false
              desktop:
                position: bottom
                show_labels: true
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .navbar-card.mobile {
                padding-bottom: calc(env(safe-area-inset-bottom, 0px));
              }
                          :host {
                            --navbar-background-color: rgba(25, 36, 54, 0.55);
                            --navbar-box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-desktop: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-mobile-floating: 0 24px 55px rgba(0, 0, 0, 0.55);
                          }
                          .navbar-card,
                          .navbar-card.desktop,
                          .navbar-card.mobile,
                          .navbar-card.desktop.bottom,
                          .navbar-card.desktop.top,
                          .navbar-card.desktop.left,
                          .navbar-card.desktop.right,
                          .navbar-card.mobile.floating,
                          ha-card.navbar-card {
                            background: rgba(25, 36, 54, 0.55) !important;
                            border: 1px solid rgba(255, 255, 255, 0.18) !important;
                            backdrop-filter: blur(20px);
                            -webkit-backdrop-filter: blur(20px);
                            box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45) !important;
                          }
            routes:
              - url: /at-a-glance/overview
                icon: mdi:home
                label: Home
                selected: |
                  [[[
                    const path = (location && location.pathname) || '';
                    const direct = ['/at-a-glance/security', '/at-a-glance/shopping-list', '/at-a-glance/chores'];
                    return !direct.some(prefix => path.startsWith(prefix));
                  ]]]
              - url: /at-a-glance/security
                icon: mdi:shield
                label: Security
              - url: /at-a-glance/shopping-list
                icon: mdi:shopping
                label: Shopping List
              - icon: mdi:dots-horizontal
                label: More
                tap_action:
                  action: open-popup
                popup:
                  - icon: mdi:cog
                    url: /config/dashboard
                  - icon: mdi:hammer
                    url: /developer-tools/yaml
                  - icon: mdi:power
                    tap_action:
                      action: call-service
                      service: homeassistant.restart
                      service_data: {}
                      confirmation:
                        text: Are you sure you want to restart Home Assistant?
            media_player: {}
            desktop: {}
    cards: []
  - title: Back Deck
    path: back-deck
    type: sections
    style: |
      :host {
        --view-padding: 0 16px !important;
        --lovelace-view-margin: 0 16px !important;
        position: relative;
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
      }
      bubble-card {
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
        --bubble-icon-opacity: 1 !important;
        --bubble-icon-opacity-active: 1 !important;
        --bubble-icon-opacity-disabled: 1 !important;
      }
      bubble-card .bubble-icon,
      bubble-card .bubble-main-icon-container,
      bubble-card .bubble-main-icon-container ha-icon,
      bubble-card ha-icon,
      bubble-card .is-off .bubble-main-icon,
      bubble-card .is-off .bubble-main-icon-container,
      bubble-card .is-off ha-icon {
        color: white !important;
        fill: white !important;
        opacity: 1 !important;
        filter: none !important;
      }
      bubble-card .is-off .bubble-background,
      bubble-card .is-off .bubble-icon-container {
        background: rgba(255, 255, 255, 0.35) !important;
      }
      :host::before {
        content: "";
        position: fixed;
        inset: 0;
        background-image: url("media-source://image_upload/b9449f15a0e0c05ad7c84ebd806b883c");
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
        filter: blur(18px) saturate(140%);
        transform: scale(1.05);     /* avoids clipping after blur */
        z-index: -2;
      }
      :host::after {
        content: "";
        position: fixed;
        inset: 0;
        background: rgba(12, 18, 28, 0.35);  /* frosted tint */
        backdrop-filter: blur(8px);
        z-index: -1;
      }
      hui-view-header,
      hui-section-heading-row,
      hui-section-heading-tile {
        display: none !important;
      }
    sections:
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: button
            button_type: name
            show_name: false
            show_state: false
            show_icon: true
            icon: mdi:chevron-left
            tap_action:
              action: fire-dom-event
              browser_mod:
                service: browser_mod.javascript
                data:
                  code: history.back()
            button_action:
              tap_action:
                action: fire-dom-event
                browser_mod:
                  service: browser_mod.javascript
                  data:
                    code: history.back()
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .bubble-icon,
              .bubble-main-icon,
              .bubble-main-icon-container ha-icon {
                color: white !important;
                opacity: 1 !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-button-card-container {
                display: flex !important;
                align-items: center !important;
                justify-content: flex-start !important;
                padding: 0 !important;
                border: 0 !important;
                background: transparent !important;
                box-shadow: none !important;
                cursor: pointer;
                margin-left: -16px !important;
              }
              .bubble-button-card-container:hover,
              .bubble-button-card-container:focus,
              .bubble-button-card-container:active {
                background: transparent !important;
                box-shadow: none !important;
                filter: none !important;
              }


              .bubble-icon-container {
                background: transparent !important;
                box-shadow: none !important;
              }

              .bubble-icon {
                --mdc-icon-size: 36px !important;
                padding: 0 !important;
              }
            grid_options:
              columns: 2
              rows: auto
          - type: markdown
            content: '# Back Deck'
            text_only: true
            grid_options:
              columns: 6
              rows: auto
            card_mod:
              style: |
                ha-card {
                  display: flex;
                  align-items: center;   # vertical center
                  justify-content: center;  # optional horizontal center
                  height: 100%;
                  padding: 0;
                  margin-left: -32px !important;
                  --card-mod-script: |
                    if (window.__bubbleForceWhiteInit) {
                      return;
                    }
                    window.__bubbleForceWhiteInit = true;
                    const styleId = 'bubble-force-white-style';
                    const cssLines = [
                      '.bubble-icon,',
                      '.bubble-main-icon,',
                      '.bubble-main-icon-container,',
                      '.bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.is-off .bubble-icon,',
                      '.is-off .bubble-main-icon,',
                      '.is-off .bubble-main-icon-container,',
                      '.is-off .bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.ha-markdown-element {',
                      '  color: white !important',
                      '}',
                    ];
                    const css = cssLines.join('\n');
                    const touchIcons = (root) => {
                      if (!root) {
                        return;
                      }
                      root.querySelectorAll('.bubble-icon, .bubble-main-icon, .bubble-main-icon-container ha-icon').forEach((icon) => {
                        icon.style.setProperty('color', 'white', 'important');
                        icon.style.setProperty('fill', 'white', 'important');
                        icon.style.setProperty('opacity', '1', 'important');
                        icon.style.removeProperty('filter');
                      });
                    };
                    const applyStyles = (card) => {
                      if (!card) {
                        return;
                      }
                      const root = card.shadowRoot || card;
                      if (!root) {
                        return;
                      }
                      if (!root.getElementById(styleId)) {
                        const style = document.createElement('style');
                        style.id = styleId;
                        style.textContent = css;
                        root.appendChild(style);
                      }
                      touchIcons(root);
                    };
                    const registeredRoots = new Set();
                    const registerRoot = (root) => {
                      if (
                        root &&
                        typeof root.querySelectorAll === 'function' &&
                        !registeredRoots.has(root)
                      ) {
                        registeredRoots.add(root);
                      }
                    };
                    const scan = () => {
                      registeredRoots.forEach((root) => {
                        root.querySelectorAll('bubble-card').forEach(applyStyles);
                        root.querySelectorAll('*').forEach((el) => {
                          if (el.shadowRoot) {
                            registerRoot(el.shadowRoot);
                          }
                        });
                      });
                    };
                    registerRoot(document);
                    registerRoot(document.body);
                    registerRoot(document.documentElement);
                    scan();
                    window.__bubbleForceWhiteInterval = window.setInterval(() => {
                      scan();
                    }, 750);
                }
                ha-markdown {
                  margin: 0;
                  width: 100%;
                  text-align: center;    # drop if you only want vertical centering
                   color: white !important;
                }
          - type: custom:swipe-card
            grid_options:
              columns: full
              rows: 1
            parameters:
              slidesPerView: auto
              spaceBetween: 12
              freeMode: true
              freeModeSticky: false
              mousewheel: true
            style: |
              margin-bottom: 10px !important;
            cards:
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: light.back_deck
                name: Lights
                show_state: true
                icon: mdi:lightbulb
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    --lights-color: ${(() => {
                      const light = hass.states[entity];
                      if (!light) {
                        return 'rgba(255, 255, 255, 0.35)';
                      }
                      const state = light.state;
                      if (state === 'off') {
                        return '#1e88e5';
                      }
                      if (state === 'unavailable') {
                        return 'rgba(120, 120, 120, 0.6)';
                      }
                      const attrs = light.attributes || {};
                      const rgb = attrs.rgb_color;
                      if (Array.isArray(rgb) && rgb.length === 3) {
                        const [r, g, b] = rgb;
                        return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                      }
                      const hs = attrs.hs_color;
                      if (Array.isArray(hs) && hs.length === 2) {
                        const hue = hs[0];
                        const sat = (hs[1] || 0) / 100;
                        const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                        const c = brightness * sat;
                        const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                        const m = brightness - c;
                        let r1 = 0;
                        let g1 = 0;
                        let b1 = 0;
                        if (hue >= 0 && hue < 60) {
                          r1 = c;
                          g1 = x;
                        } else if (hue < 120) {
                          r1 = x;
                          g1 = c;
                        } else if (hue < 180) {
                          g1 = c;
                          b1 = x;
                        } else if (hue < 240) {
                          g1 = x;
                          b1 = c;
                        } else if (hue < 300) {
                          r1 = x;
                          b1 = c;
                        } else {
                          r1 = c;
                          b1 = x;
                        }
                        const r = Math.round((r1 + m) * 255);
                        const g = Math.round((g1 + m) * 255);
                        const b = Math.round((b1 + m) * 255);
                        return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                      }
                      const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                      if (temp) {
                        const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                        const kelvin = clamp(temp, 2000, 6500);
                        const t = kelvin / 100;
                        let r;
                        let g;
                        let b;
                        if (t <= 66) {
                          r = 255;
                          g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                        } else {
                          r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                          g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                        }
                        if (t >= 66) {
                          b = 255;
                        } else if (t <= 19) {
                          b = 0;
                        } else {
                          b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                        }
                        return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                      }
                      return 'rgba(255, 255, 255, 0.35)';
                    })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--lights-color) !important;
                  }
                tap_action:
                  action: navigate
                  navigation_path: '#lights-back-deck'
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#lights-back-deck'
                card_mod:
                  style: >
                    :host {
                      width: auto;
                      max-width: 130px;
                      flex: 0 0 auto;
                      margin-bottom: 10px !important;
                      --bubble-icon-color: white;          # primary icon color
                      --bubble-icon-color-active: white;   # when entity is "on"
                      --bubble-icon-color-disabled: white;
                      --bubble-button-spacing: 0px;   /* no gap between icon and text */
                    }

                    .bubble-main-icon-container {
                      background: none !important;
                      box-shadow: none !important;
                      padding: 0 !important;
                      width: auto !important;
                      height: auto !important;
                      pointer-events: none !important;
                    }

                    .bubble-main-icon-container ha-icon {
                      width: 24px;   /* or any size you need */
                      height: 24px;
                      color: white !important;
                    }

                    .bubble-main-icon-container ha-ripple,

                    .bubble-main-icon-container .bubble-icon-feedback-container
                    {
                      display: none !important;   /* remove ripple/feedback layers */
                    }
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: binary_sensor.upper_deck_camera_all_occupancy
                name: Occupancy
                icon: mdi:motion-sensor
                show_state: true
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    --occupancy-color: ${(() => {
                        const securityEntity = 'alarm_control_panel.aqara_hub_m3_0056_security_system_2';
                        const occState = hass.states[entity]?.state;
                        const securityState = hass.states[securityEntity]?.state;
                        const occupiedStates = ['on', 'detected', 'occupied'];
                        const clearStates = ['off', 'clear', 'standby'];
                        if (clearStates.includes(occState)) {
                          return '#43a047';
                        }
                        if (occupiedStates.includes(occState) && securityState === 'armed_away') {
                          return '#e53935';
                        }
                        if (occupiedStates.includes(occState)) {
                          return '#1e88e5';
                        }
                        if (occState === 'unavailable') {
                          return 'rgba(120, 120, 120, 0.6)';
                        }
                        return '#546e7a';
                      })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--occupancy-color) !important;
                  }
                card_mod:
                  style: >
                    :host {
                      width: auto;
                      max-width: 150px;
                      flex: 0 0 auto;
                      margin-bottom: 10px !important;
                      --bubble-icon-color: white;          # primary icon color
                      --bubble-icon-color-active: white;   # when entity is "on"
                      --bubble-icon-color-disabled: white;    # when unavailable
                    }

                    .bubble-main-icon-container {
                      background: none !important;
                      box-shadow: none !important;
                      padding: 0 !important;
                      width: auto !important;
                      height: auto !important;
                      pointer-events: none !important;
                    }

                    .bubble-main-icon-container ha-icon {
                      width: 24px;   /* or any size you need */
                      height: 24px;
                      color: white !important;
                    }

                    .bubble-main-icon-container ha-ripple,

                    .bubble-main-icon-container .bubble-icon-feedback-container
                    {
                      display: none !important;   /* remove ripple/feedback layers */
                    }
        column_span: 4
      - type: grid
        cards:
          - type: vertical-stack
            grid_options:
              columns: full
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#lights-back-deck'
                button_type: name
                show_icon: false
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                  .bubble-pop-up-background {
                    background-color: rgba(25, 36, 54, 0.55) !important;
                    filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.18);
                    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.15),
                        0 15px 40px rgba(0, 0, 0, 0.35);
                  }
              - type: custom:bubble-card
                card_type: separator
                name: Back Deck Lights
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button:
                  - entity: light.back_deck
                    tap_action:
                      action: toggle
                    icon: ''
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.grill_light_3
                    name: Grill Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }

                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.outdoor_dining_room_3
                    name: Couches Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }

                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                columns: 2
        column_span: 4
      - type: grid
        cards:
          - type: custom:navbar-card
            layout:
              mobile:
                mode: floating
                show_labels: false
              desktop:
                position: bottom
                show_labels: true
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .navbar-card.mobile {
                padding-bottom: calc(env(safe-area-inset-bottom, 0px));
              }
                          :host {
                            --navbar-background-color: rgba(25, 36, 54, 0.55);
                            --navbar-box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-desktop: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-mobile-floating: 0 24px 55px rgba(0, 0, 0, 0.55);
                          }
                          .navbar-card,
                          .navbar-card.desktop,
                          .navbar-card.mobile,
                          .navbar-card.desktop.bottom,
                          .navbar-card.desktop.top,
                          .navbar-card.desktop.left,
                          .navbar-card.desktop.right,
                          .navbar-card.mobile.floating,
                          ha-card.navbar-card {
                            background: rgba(25, 36, 54, 0.55) !important;
                            border: 1px solid rgba(255, 255, 255, 0.18) !important;
                            backdrop-filter: blur(20px);
                            -webkit-backdrop-filter: blur(20px);
                            box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45) !important;
                          }
            routes:
              - url: /at-a-glance/overview
                icon: mdi:home
                label: Home
                selected: |
                  [[[
                    const path = (location && location.pathname) || '';
                    const direct = ['/at-a-glance/security', '/at-a-glance/shopping-list', '/at-a-glance/chores'];
                    return !direct.some(prefix => path.startsWith(prefix));
                  ]]]
              - url: /at-a-glance/security
                icon: mdi:shield
                label: Security
              - url: /at-a-glance/shopping-list
                icon: mdi:shopping
                label: Shopping List
              - icon: mdi:dots-horizontal
                label: More
                tap_action:
                  action: open-popup
                popup:
                  - icon: mdi:cog
                    url: /config/dashboard
                  - icon: mdi:hammer
                    url: /developer-tools/yaml
                  - icon: mdi:power
                    tap_action:
                      action: call-service
                      service: homeassistant.restart
                      service_data: {}
                      confirmation:
                        text: Are you sure you want to restart Home Assistant?
            media_player: {}
            desktop: {}
    cards: []
  - title: Music Room
    path: music-room
    type: sections
    style: |
      :host {
        --view-padding: 0 16px !important;
        --lovelace-view-margin: 0 16px !important;
        position: relative;
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
      }
      bubble-card {
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
        --bubble-icon-opacity: 1 !important;
        --bubble-icon-opacity-active: 1 !important;
        --bubble-icon-opacity-disabled: 1 !important;
      }
      bubble-card .bubble-icon,
      bubble-card .bubble-main-icon-container,
      bubble-card .bubble-main-icon-container ha-icon,
      bubble-card ha-icon,
      bubble-card .is-off .bubble-main-icon,
      bubble-card .is-off .bubble-main-icon-container,
      bubble-card .is-off ha-icon {
        color: white !important;
        fill: white !important;
        opacity: 1 !important;
        filter: none !important;
      }
      bubble-card .is-off .bubble-background,
      bubble-card .is-off .bubble-icon-container {
        background: rgba(255, 255, 255, 0.35) !important;
      }
      :host::before {
        content: "";
        position: fixed;
        inset: 0;
        background-image: url("media-source://image_upload/b9449f15a0e0c05ad7c84ebd806b883c");
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
        filter: blur(18px) saturate(140%);
        transform: scale(1.05);     /* avoids clipping after blur */
        z-index: -2;
      }
      :host::after {
        content: "";
        position: fixed;
        inset: 0;
        background: rgba(12, 18, 28, 0.35);  /* frosted tint */
        backdrop-filter: blur(8px);
        z-index: -1;
      }
      hui-view-header,
      hui-section-heading-row,
      hui-section-heading-tile {
        display: none !important;
      }
    sections:
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: button
            button_type: name
            show_name: false
            show_state: false
            show_icon: true
            icon: mdi:chevron-left
            tap_action:
              action: fire-dom-event
              browser_mod:
                service: browser_mod.javascript
                data:
                  code: history.back()
            button_action:
              tap_action:
                action: fire-dom-event
                browser_mod:
                  service: browser_mod.javascript
                  data:
                    code: history.back()
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .bubble-icon,
              .bubble-main-icon,
              .bubble-main-icon-container ha-icon {
                color: white !important;
                opacity: 1 !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-button-card-container {
                display: flex !important;
                align-items: center !important;
                justify-content: flex-start !important;
                padding: 0 !important;
                border: 0 !important;
                background: transparent !important;
                box-shadow: none !important;
                cursor: pointer;
                margin-left: -16px !important;
              }
              .bubble-button-card-container:hover,
              .bubble-button-card-container:focus,
              .bubble-button-card-container:active {
                background: transparent !important;
                box-shadow: none !important;
                filter: none !important;
              }


              .bubble-icon-container {
                background: transparent !important;
                box-shadow: none !important;
              }

              .bubble-icon {
                --mdc-icon-size: 36px !important;
                padding: 0 !important;
              }
            grid_options:
              columns: 2
              rows: auto
          - type: markdown
            content: '# Music Room'
            text_only: true
            card_mod:
              style: |
                ha-card {
                  display: flex;
                  align-items: center;   # vertical center
                  justify-content: center;  # optional horizontal center
                  height: 100%;
                  padding: 0;
                  margin-left: -32px !important;
                  --card-mod-script: |
                    if (window.__bubbleForceWhiteInit) {
                      return;
                    }
                    window.__bubbleForceWhiteInit = true;
                    const styleId = 'bubble-force-white-style';
                    const cssLines = [
                      '.bubble-icon,',
                      '.bubble-main-icon,',
                      '.bubble-main-icon-container,',
                      '.bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.is-off .bubble-icon,',
                      '.is-off .bubble-main-icon,',
                      '.is-off .bubble-main-icon-container,',
                      '.is-off .bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.ha-markdown-element {',
                      '  color: white !important',
                      '}',
                    ];
                    const css = cssLines.join('\n');
                    const touchIcons = (root) => {
                      if (!root) {
                        return;
                      }
                      root.querySelectorAll('.bubble-icon, .bubble-main-icon, .bubble-main-icon-container ha-icon').forEach((icon) => {
                        icon.style.setProperty('color', 'white', 'important');
                        icon.style.setProperty('fill', 'white', 'important');
                        icon.style.setProperty('opacity', '1', 'important');
                        icon.style.removeProperty('filter');
                      });
                    };
                    const applyStyles = (card) => {
                      if (!card) {
                        return;
                      }
                      const root = card.shadowRoot || card;
                      if (!root) {
                        return;
                      }
                      if (!root.getElementById(styleId)) {
                        const style = document.createElement('style');
                        style.id = styleId;
                        style.textContent = css;
                        root.appendChild(style);
                      }
                      touchIcons(root);
                    };
                    const registeredRoots = new Set();
                    const registerRoot = (root) => {
                      if (
                        root &&
                        typeof root.querySelectorAll === 'function' &&
                        !registeredRoots.has(root)
                      ) {
                        registeredRoots.add(root);
                      }
                    };
                    const scan = () => {
                      registeredRoots.forEach((root) => {
                        root.querySelectorAll('bubble-card').forEach(applyStyles);
                        root.querySelectorAll('*').forEach((el) => {
                          if (el.shadowRoot) {
                            registerRoot(el.shadowRoot);
                          }
                        });
                      });
                    };
                    registerRoot(document);
                    registerRoot(document.body);
                    registerRoot(document.documentElement);
                    scan();
                    window.__bubbleForceWhiteInterval = window.setInterval(() => {
                      scan();
                    }, 750);
                }
                ha-markdown {
                  margin: 0;
                  width: 100%;
                  text-align: center;    # drop if you only want vertical centering
                   color: white !important;
                }
            grid_options:
              columns: 6
              rows: auto
          - type: custom:swipe-card
            grid_options:
              columns: full
              rows: 1
            parameters:
              slidesPerView: auto
              spaceBetween: 12
              freeMode: true
              freeModeSticky: false
              mousewheel: true
            style: |
              margin-bottom: 10px !important;
            cards:
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: light.music_room
                name: Lights
                show_state: true
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    --lights-color: ${(() => {
                      const light = hass.states[entity];
                      if (!light) {
                        return 'rgba(255, 255, 255, 0.35)';
                      }
                      const state = light.state;
                      if (state === 'off') {
                        return '#1e88e5';
                      }
                      if (state === 'unavailable') {
                        return 'rgba(120, 120, 120, 0.6)';
                      }
                      const attrs = light.attributes || {};
                      const rgb = attrs.rgb_color;
                      if (Array.isArray(rgb) && rgb.length === 3) {
                        const [r, g, b] = rgb;
                        return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                      }
                      const hs = attrs.hs_color;
                      if (Array.isArray(hs) && hs.length === 2) {
                        const hue = hs[0];
                        const sat = (hs[1] || 0) / 100;
                        const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                        const c = brightness * sat;
                        const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                        const m = brightness - c;
                        let r1 = 0;
                        let g1 = 0;
                        let b1 = 0;
                        if (hue >= 0 && hue < 60) {
                          r1 = c;
                          g1 = x;
                        } else if (hue < 120) {
                          r1 = x;
                          g1 = c;
                        } else if (hue < 180) {
                          g1 = c;
                          b1 = x;
                        } else if (hue < 240) {
                          g1 = x;
                          b1 = c;
                        } else if (hue < 300) {
                          r1 = x;
                          b1 = c;
                        } else {
                          r1 = c;
                          b1 = x;
                        }
                        const r = Math.round((r1 + m) * 255);
                        const g = Math.round((g1 + m) * 255);
                        const b = Math.round((b1 + m) * 255);
                        return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                      }
                      const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                      if (temp) {
                        const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                        const kelvin = clamp(temp, 2000, 6500);
                        const t = kelvin / 100;
                        let r;
                        let g;
                        let b;
                        if (t <= 66) {
                          r = 255;
                          g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                        } else {
                          r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                          g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                        }
                        if (t >= 66) {
                          b = 255;
                        } else if (t <= 19) {
                          b = 0;
                        } else {
                          b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                        }
                        return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                      }
                      return 'rgba(255, 255, 255, 0.35)';
                    })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--lights-color) !important;
                  }
                tap_action:
                  action: navigate
                  navigation_path: '#lights-music-room'
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#lights-music-room'
                card_mod:
                  style: >
                    :host {
                      width: auto;
                      max-width: 130px;
                      flex: 0 0 auto;
                      margin-bottom: 10px !important;
                      --bubble-icon-color: white;          # primary icon color
                      --bubble-icon-color-active: white;   # when entity is "on"
                      --bubble-icon-color-disabled: white;
                      --bubble-button-spacing: 0px;   /* no gap between icon and text */
                    }

                    .bubble-main-icon-container {
                      background: none !important;
                      box-shadow: none !important;
                      padding: 0 !important;
                      width: auto !important;
                      height: auto !important;
                      pointer-events: none !important;
                    }

                    .bubble-main-icon-container ha-icon {
                      width: 24px;   /* or any size you need */
                      height: 24px;
                      color: white !important;
                    }

                    .bubble-main-icon-container ha-ripple,

                    .bubble-main-icon-container .bubble-icon-feedback-container
                    {
                      display: none !important;   /* remove ripple/feedback layers */
                    }
              - type: custom:bubble-card
                card_type: button
                button_type: state
                entity: input_text.music_room_climate_range
                icon: mdi:thermometer
                name: Climate
                show_state: true
                modules:
                  - frosted_glass
                  - get_state_attribute
                get_state_attribute:
                  - entity: input_text.music_room_climate_range
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    width: auto;
                    max-width: 180px;
                    flex: 0 0 auto;
                    margin-bottom: 10px !important;
                    --climate-color: ${(() => {
                      const color = hass.states['input_text.music_room_climate_color']?.state?.trim();
                      return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                    })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--climate-color) !important;
                  }

                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#climate-music-room'
                  hold_action:
                    action: none
                icon_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#climate-music-room'
                  hold_action:
                    action: none
        column_span: 4
      - type: grid
        cards:
          - type: vertical-stack
            grid_options:
              columns: full
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#lights-music-room'
                button_type: name
                show_icon: false
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                  .bubble-pop-up-background {
                    background-color: rgba(25, 36, 54, 0.55) !important;
                    filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.18);
                    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.15),
                        0 15px 40px rgba(0, 0, 0, 0.35);
                  }
              - type: custom:bubble-card
                card_type: separator
                name: Music Room Lights
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button:
                  - entity: light.music_room
                    tap_action:
                      action: toggle
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_color_downlight_2
                    name: Fireplace Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }

                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_color_downlight_4
                    name: Window Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }

                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_color_downlight_1
                    name: Entry Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }

                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_color_downlight_3
                    name: Drums Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }

                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_color_downlight_5
                    name: Bathroom Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }

                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_color_downlight_6
                    name: Couch Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }

                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_color_downlight_8
                    name: Server Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }

                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_color_downlight_7
                    name: TV Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }

                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_play_2
                    name: TV Left Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }

                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_play_1
                    name: TV Right Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }

                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                columns: 2
        column_span: 4
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: separator
            name: Climate
            card_layout: large
            rows: '01'
            grid_options:
              columns: full
            sub_button: []
          - type: custom:bubble-card
            card_type: button
            button_type: switch
            entity: cover.music_room_vent_vent
            icon: mdi:air-filter
            tap_action:
              action: perform-action
              perform_action: cover.toggle_cover_tilt
              target:
                entity_id: cover.music_room_vent_vent
            button_action:
              tap_action:
                action: perform-action
                perform_action: cover.toggle_cover_tilt
                target:
                  entity_id: cover.music_room_vent_vent
            grid_options:
              columns: 6
              rows: auto
            name: Vents
            show_state: true
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-main-icon-container {
                background: none !important;
                box-shadow: none !important;
                padding: 0 !important;
                width: auto !important;
                height: auto !important;
                pointer-events: none !important;
              }
          - type: custom:bubble-card
            card_type: button
            button_type: state
            entity: fan.music_room_purifier
            grid_options:
              columns: 6
              rows: auto
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            name: Air Purifier
            show_attribute: true
            attribute: preset_mode
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-main-icon-container {
                background: none !important;
                box-shadow: none !important;
                padding: 0 !important;
                width: auto !important;
                height: auto !important;
                pointer-events: none !important;
              }
        column_span: 4
      - type: grid
        cards:
          - type: vertical-stack
            grid_options:
              columns: full
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#climate-music-room'
                button_type: name
                show_icon: false
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                  .bubble-pop-up-background {
                    background-color: rgba(25, 36, 54, 0.55) !important;
                    filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.18);
                    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.15),
                        0 15px 40px rgba(0, 0, 0, 0.35);
                  }
              - type: custom:bubble-card
                card_type: separator
                name: Music Room Climate
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button: []
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.music_room_temperature
                    name: Ecobee
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.music_room_ecobee_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                columns: 2
        column_span: 4
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: separator
            name: Media
            card_layout: large
            rows: '01'
            grid_options:
              columns: full
            sub_button: []
        column_span: 4
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: separator
            name: Sonos
            card_layout: large
            rows: '01'
            grid_options:
              columns: full
            sub_button: []
          - type: custom:bubble-card
            card_type: button
            button_type: switch
            entity: media_player.sonos
            show_state: true
            tap_action:
              action: more-info
            button_action:
              tap_action:
                action: more-info
            sub_button:
              - entity: media_player.sonos
                tap_action:
                  action: perform-action
                  perform_action: media_player.volume_mute
                  target:
                    device_id: 4beec4862c4675a9f5d071b1c2a0e2e3
                  data:
                    is_volume_muted: true
                icon: mdi:volume-mute
              - entity: media_player.sonos
                tap_action:
                  action: perform-action
                  perform_action: media_player.volume_down
                  target:
                    device_id: 4beec4862c4675a9f5d071b1c2a0e2e3
                icon: mdi:volume-minus
              - entity: media_player.sonos
                icon: mdi:volume-plus
                tap_action:
                  action: perform-action
                  perform_action: media_player.volume_up
                  target:
                    device_id: 4beec4862c4675a9f5d071b1c2a0e2e3
              - entity: media_player.sonos
                icon: mdi:skip-previous
                tap_action:
                  action: perform-action
                  perform_action: media_player.media_previous_track
                  target: {}
              - entity: media_player.sonos
                icon: mdi:play-pause
                tap_action:
                  action: perform-action
                  perform_action: media_player.media_play_pause
                  target:
                    device_id: 4beec4862c4675a9f5d071b1c2a0e2e3
              - entity: media_player.sonos
                icon: mdi:skip-next
                tap_action:
                  action: perform-action
                  perform_action: media_player.media_next_track
                  target:
                    device_id: 4beec4862c4675a9f5d071b1c2a0e2e3
            grid_options:
              columns: full
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-main-icon-container {
                background: none !important;
                box-shadow: none !important;
                padding: 0 !important;
                width: auto !important;
                height: auto !important;
                pointer-events: none !important;
              }
        column_span: 4
      - type: grid
        cards:
          - type: custom:navbar-card
            layout:
              mobile:
                mode: floating
                show_labels: false
              desktop:
                position: bottom
                show_labels: true
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .navbar-card.mobile {
                padding-bottom: calc(env(safe-area-inset-bottom, 0px));
              }
                          :host {
                            --navbar-background-color: rgba(25, 36, 54, 0.55);
                            --navbar-box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-desktop: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-mobile-floating: 0 24px 55px rgba(0, 0, 0, 0.55);
                          }
                          .navbar-card,
                          .navbar-card.desktop,
                          .navbar-card.mobile,
                          .navbar-card.desktop.bottom,
                          .navbar-card.desktop.top,
                          .navbar-card.desktop.left,
                          .navbar-card.desktop.right,
                          .navbar-card.mobile.floating,
                          ha-card.navbar-card {
                            background: rgba(25, 36, 54, 0.55) !important;
                            border: 1px solid rgba(255, 255, 255, 0.18) !important;
                            backdrop-filter: blur(20px);
                            -webkit-backdrop-filter: blur(20px);
                            box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45) !important;
                          }
            routes:
              - url: /at-a-glance/overview
                icon: mdi:home
                label: Home
                selected: |
                  [[[
                    const path = (location && location.pathname) || '';
                    const direct = ['/at-a-glance/security', '/at-a-glance/shopping-list', '/at-a-glance/chores'];
                    return !direct.some(prefix => path.startsWith(prefix));
                  ]]]
              - url: /at-a-glance/security
                icon: mdi:shield
                label: Security
              - url: /at-a-glance/shopping-list
                icon: mdi:shopping
                label: Shopping List
              - icon: mdi:dots-horizontal
                label: More
                tap_action:
                  action: open-popup
                popup:
                  - icon: mdi:cog
                    url: /config/dashboard
                  - icon: mdi:hammer
                    url: /developer-tools/yaml
                  - icon: mdi:power
                    tap_action:
                      action: call-service
                      service: homeassistant.restart
                      service_data: {}
                      confirmation:
                        text: Are you sure you want to restart Home Assistant?
            media_player: {}
            desktop: {}
    cards: []
  - title: Theater Room
    path: theater-room
    type: sections
    style: |
      :host {
        --view-padding: 0 16px !important;
        --lovelace-view-margin: 0 16px !important;
        position: relative;
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
      }
      bubble-card {
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
        --bubble-icon-opacity: 1 !important;
        --bubble-icon-opacity-active: 1 !important;
        --bubble-icon-opacity-disabled: 1 !important;
      }
      bubble-card .bubble-icon,
      bubble-card .bubble-main-icon-container,
      bubble-card .bubble-main-icon-container ha-icon,
      bubble-card ha-icon,
      bubble-card .is-off .bubble-main-icon,
      bubble-card .is-off .bubble-main-icon-container,
      bubble-card .is-off ha-icon {
        color: white !important;
        fill: white !important;
        opacity: 1 !important;
        filter: none !important;
      }
      bubble-card .is-off .bubble-background,
      bubble-card .is-off .bubble-icon-container {
        background: rgba(255, 255, 255, 0.35) !important;
      }
      :host::before {
        content: "";
        position: fixed;
        inset: 0;
        background-image: url("media-source://image_upload/b9449f15a0e0c05ad7c84ebd806b883c");
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
        filter: blur(18px) saturate(140%);
        transform: scale(1.05);     /* avoids clipping after blur */
        z-index: -2;
      }
      :host::after {
        content: "";
        position: fixed;
        inset: 0;
        background: rgba(12, 18, 28, 0.35);  /* frosted tint */
        backdrop-filter: blur(8px);
        z-index: -1;
      }
      hui-view-header,
      hui-section-heading-row,
      hui-section-heading-tile {
        display: none !important;
      }
    sections:
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: button
            button_type: name
            show_name: false
            show_state: false
            show_icon: true
            icon: mdi:chevron-left
            tap_action:
              action: fire-dom-event
              browser_mod:
                service: browser_mod.javascript
                data:
                  code: history.back()
            button_action:
              tap_action:
                action: fire-dom-event
                browser_mod:
                  service: browser_mod.javascript
                  data:
                    code: history.back()
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .bubble-icon,
              .bubble-main-icon,
              .bubble-main-icon-container ha-icon {
                color: white !important;
                opacity: 1 !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-button-card-container {
                display: flex !important;
                align-items: center !important;
                justify-content: flex-start !important;
                padding: 0 !important;
                border: 0 !important;
                background: transparent !important;
                box-shadow: none !important;
                cursor: pointer;
                margin-left: -16px !important;
              }
              .bubble-button-card-container:hover,
              .bubble-button-card-container:focus,
              .bubble-button-card-container:active {
                background: transparent !important;
                box-shadow: none !important;
                filter: none !important;
              }


              .bubble-icon-container {
                background: transparent !important;
                box-shadow: none !important;
              }

              .bubble-icon {
                --mdc-icon-size: 36px !important;
                padding: 0 !important;
              }
            grid_options:
              columns: 2
              rows: auto
          - type: markdown
            content: '# Theater Room'
            text_only: true
            card_mod:
              style: |
                ha-card {
                  display: flex;
                  align-items: center;   # vertical center
                  justify-content: center;  # optional horizontal center
                  height: 100%;
                  padding: 0;
                  margin-left: -32px !important;
                  --card-mod-script: |
                    if (window.__bubbleForceWhiteInit) {
                      return;
                    }
                    window.__bubbleForceWhiteInit = true;
                    const styleId = 'bubble-force-white-style';
                    const cssLines = [
                      '.bubble-icon,',
                      '.bubble-main-icon,',
                      '.bubble-main-icon-container,',
                      '.bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.is-off .bubble-icon,',
                      '.is-off .bubble-main-icon,',
                      '.is-off .bubble-main-icon-container,',
                      '.is-off .bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.ha-markdown-element {',
                      '  color: white !important',
                      '}',
                    ];
                    const css = cssLines.join('\n');
                    const touchIcons = (root) => {
                      if (!root) {
                        return;
                      }
                      root.querySelectorAll('.bubble-icon, .bubble-main-icon, .bubble-main-icon-container ha-icon').forEach((icon) => {
                        icon.style.setProperty('color', 'white', 'important');
                        icon.style.setProperty('fill', 'white', 'important');
                        icon.style.setProperty('opacity', '1', 'important');
                        icon.style.removeProperty('filter');
                      });
                    };
                    const applyStyles = (card) => {
                      if (!card) {
                        return;
                      }
                      const root = card.shadowRoot || card;
                      if (!root) {
                        return;
                      }
                      if (!root.getElementById(styleId)) {
                        const style = document.createElement('style');
                        style.id = styleId;
                        style.textContent = css;
                        root.appendChild(style);
                      }
                      touchIcons(root);
                    };
                    const registeredRoots = new Set();
                    const registerRoot = (root) => {
                      if (
                        root &&
                        typeof root.querySelectorAll === 'function' &&
                        !registeredRoots.has(root)
                      ) {
                        registeredRoots.add(root);
                      }
                    };
                    const scan = () => {
                      registeredRoots.forEach((root) => {
                        root.querySelectorAll('bubble-card').forEach(applyStyles);
                        root.querySelectorAll('*').forEach((el) => {
                          if (el.shadowRoot) {
                            registerRoot(el.shadowRoot);
                          }
                        });
                      });
                    };
                    registerRoot(document);
                    registerRoot(document.body);
                    registerRoot(document.documentElement);
                    scan();
                    window.__bubbleForceWhiteInterval = window.setInterval(() => {
                      scan();
                    }, 750);
                }
                ha-markdown {
                  margin: 0;
                  width: 100%;
                  text-align: center;    # drop if you only want vertical centering
                   color: white !important;
                }
            grid_options:
              columns: 6
              rows: auto
          - type: custom:swipe-card
            grid_options:
              columns: full
              rows: 1
            parameters:
              slidesPerView: auto
              spaceBetween: 12
              freeMode: true
              freeModeSticky: false
              mousewheel: true
            style: |
              margin-bottom: 10px !important;
            cards:
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: light.theater_room
                name: Lights
                show_state: true
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    --lights-color: ${(() => {
                      const light = hass.states[entity];
                      if (!light) {
                        return 'rgba(255, 255, 255, 0.35)';
                      }
                      const state = light.state;
                      if (state === 'off') {
                        return '#1e88e5';
                      }
                      if (state === 'unavailable') {
                        return 'rgba(120, 120, 120, 0.6)';
                      }
                      const attrs = light.attributes || {};
                      const rgb = attrs.rgb_color;
                      if (Array.isArray(rgb) && rgb.length === 3) {
                        const [r, g, b] = rgb;
                        return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                      }
                      const hs = attrs.hs_color;
                      if (Array.isArray(hs) && hs.length === 2) {
                        const hue = hs[0];
                        const sat = (hs[1] || 0) / 100;
                        const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                        const c = brightness * sat;
                        const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                        const m = brightness - c;
                        let r1 = 0;
                        let g1 = 0;
                        let b1 = 0;
                        if (hue >= 0 && hue < 60) {
                          r1 = c;
                          g1 = x;
                        } else if (hue < 120) {
                          r1 = x;
                          g1 = c;
                        } else if (hue < 180) {
                          g1 = c;
                          b1 = x;
                        } else if (hue < 240) {
                          g1 = x;
                          b1 = c;
                        } else if (hue < 300) {
                          r1 = x;
                          b1 = c;
                        } else {
                          r1 = c;
                          b1 = x;
                        }
                        const r = Math.round((r1 + m) * 255);
                        const g = Math.round((g1 + m) * 255);
                        const b = Math.round((b1 + m) * 255);
                        return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                      }
                      const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                      if (temp) {
                        const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                        const kelvin = clamp(temp, 2000, 6500);
                        const t = kelvin / 100;
                        let r;
                        let g;
                        let b;
                        if (t <= 66) {
                          r = 255;
                          g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                        } else {
                          r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                          g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                        }
                        if (t >= 66) {
                          b = 255;
                        } else if (t <= 19) {
                          b = 0;
                        } else {
                          b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                        }
                        return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                      }
                      return 'rgba(255, 255, 255, 0.35)';
                    })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--lights-color) !important;
                  }
                tap_action:
                  action: navigate
                  navigation_path: '#lights-theater-room'
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#lights-theater-room'
                card_mod:
                  style: >
                    :host {
                      width: auto;
                      max-width: 130px;
                      flex: 0 0 auto;
                      margin-bottom: 10px !important;
                      --bubble-icon-color: white;          # primary icon color
                      --bubble-icon-color-active: white;   # when entity is "on"
                      --bubble-icon-color-disabled: white;
                      --bubble-button-spacing: 0px;   /* no gap between icon and text */
                    }

                    .bubble-main-icon-container {
                      background: none !important;
                      box-shadow: none !important;
                      padding: 0 !important;
                      width: auto !important;
                      height: auto !important;
                      pointer-events: none !important;
                    }

                    .bubble-main-icon-container ha-icon {
                      width: 24px;   /* or any size you need */
                      height: 24px;
                      color: white !important;
                    }

                    .bubble-main-icon-container ha-ripple,

                    .bubble-main-icon-container .bubble-icon-feedback-container
                    {
                      display: none !important;   /* remove ripple/feedback layers */
                    }
              - type: custom:bubble-card
                card_type: button
                button_type: state
                entity: input_text.theater_room_climate_range
                icon: mdi:thermometer
                name: Climate
                show_state: true
                modules:
                  - frosted_glass
                  - get_state_attribute
                get_state_attribute:
                  - entity: input_text.theater_room_climate_range
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    width: auto;
                    max-width: 180px;
                    flex: 0 0 auto;
                    margin-bottom: 10px !important;
                    --climate-color: ${(() => {
                      const color = hass.states['input_text.theater_room_climate_color']?.state?.trim();
                      return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                    })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--climate-color) !important;
                  }

                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#climate-theater-room'
                  hold_action:
                    action: none
                icon_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#climate-theater-room'
                  hold_action:
                    action: none
        column_span: 4
      - type: grid
        cards:
          - type: vertical-stack
            grid_options:
              columns: full
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#lights-theater-room'
                button_type: name
                show_icon: false
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                  .bubble-pop-up-background {
                    background-color: rgba(25, 36, 54, 0.55) !important;
                    filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.18);
                    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.15),
                        0 15px 40px rgba(0, 0, 0, 0.35);
                  }
              - type: custom:bubble-card
                card_type: separator
                name: Theater Room Lights
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button:
                  - entity: light.theater_room
                    tap_action:
                      action: toggle
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_30
                    name: Front Screen Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }

                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_29
                    name: Front Right Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }

                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_27
                    name: Front Back Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }

                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_28
                    name: Rear Front Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }

                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_26
                    name: Rear Back Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }

                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_31
                    name: Rear Right Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }

                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                columns: 2
        column_span: 4
      - type: grid
        cards:
          - type: vertical-stack
            grid_options:
              columns: full
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#climate-theater-room'
                button_type: name
                show_icon: false
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                  .bubble-pop-up-background {
                    background-color: rgba(25, 36, 54, 0.55) !important;
                    filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.18);
                    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.15),
                        0 15px 40px rgba(0, 0, 0, 0.35);
                  }
              - type: custom:bubble-card
                card_type: separator
                name: Theater Room Climate
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button: []
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.theater_room_temperature
                    name: Ecobee
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.theater_room_ecobee_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                columns: 2
        column_span: 4
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: separator
            name: Climate
            card_layout: large
            rows: '01'
            grid_options:
              columns: full
            sub_button: []
          - type: custom:bubble-card
            card_type: button
            button_type: switch
            entity: cover.theater_room_vents
            icon: mdi:air-filter
            tap_action:
              action: perform-action
              perform_action: cover.toggle_cover_tilt
              target:
                entity_id: cover.theater_room_vents
            button_action:
              tap_action:
                action: perform-action
                perform_action: cover.toggle_cover_tilt
                target:
                  entity_id: cover.theater_room_vents
            grid_options:
              columns: 6
              rows: auto
            name: Vents
            show_state: true
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-main-icon-container {
                background: none !important;
                box-shadow: none !important;
                padding: 0 !important;
                width: auto !important;
                height: auto !important;
                pointer-events: none !important;
              }
          - type: custom:bubble-card
            card_type: button
            button_type: state
            entity: fan.theater_purifier
            grid_options:
              columns: 6
              rows: auto
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            name: Air Purifier
            show_attribute: true
            attribute: preset_mode
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-main-icon-container {
                background: none !important;
                box-shadow: none !important;
                padding: 0 !important;
                width: auto !important;
                height: auto !important;
                pointer-events: none !important;
              }
        column_span: 4
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: separator
            name: Media
            card_layout: large
            rows: '01'
            grid_options:
              columns: full
            sub_button: []
        column_span: 4
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: separator
            name: Sonos
            card_layout: large
            rows: '01'
            grid_options:
              columns: full
            sub_button: []
          - type: custom:bubble-card
            card_type: button
            button_type: switch
            entity: media_player.sonos
            show_state: true
            tap_action:
              action: more-info
            button_action:
              tap_action:
                action: more-info
            sub_button:
              - entity: media_player.sonos
                tap_action:
                  action: perform-action
                  perform_action: media_player.volume_mute
                  target:
                    device_id: 4beec4862c4675a9f5d071b1c2a0e2e3
                  data:
                    is_volume_muted: true
                icon: mdi:volume-mute
              - entity: media_player.sonos
                tap_action:
                  action: perform-action
                  perform_action: media_player.volume_down
                  target:
                    device_id: 4beec4862c4675a9f5d071b1c2a0e2e3
                icon: mdi:volume-minus
              - entity: media_player.sonos
                icon: mdi:volume-plus
                tap_action:
                  action: perform-action
                  perform_action: media_player.volume_up
                  target:
                    device_id: 4beec4862c4675a9f5d071b1c2a0e2e3
              - entity: media_player.sonos
                icon: mdi:skip-previous
                tap_action:
                  action: perform-action
                  perform_action: media_player.media_previous_track
                  target: {}
              - entity: media_player.sonos
                icon: mdi:play-pause
                tap_action:
                  action: perform-action
                  perform_action: media_player.media_play_pause
                  target:
                    device_id: 4beec4862c4675a9f5d071b1c2a0e2e3
              - entity: media_player.sonos
                icon: mdi:skip-next
                tap_action:
                  action: perform-action
                  perform_action: media_player.media_next_track
                  target:
                    device_id: 4beec4862c4675a9f5d071b1c2a0e2e3
            grid_options:
              columns: full
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-main-icon-container {
                background: none !important;
                box-shadow: none !important;
                padding: 0 !important;
                width: auto !important;
                height: auto !important;
                pointer-events: none !important;
              }
        column_span: 4
      - type: grid
        cards:
          - type: custom:navbar-card
            layout:
              mobile:
                mode: floating
                show_labels: false
              desktop:
                position: bottom
                show_labels: true
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .navbar-card.mobile {
                padding-bottom: calc(env(safe-area-inset-bottom, 0px));
              }
                          :host {
                            --navbar-background-color: rgba(25, 36, 54, 0.55);
                            --navbar-box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-desktop: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-mobile-floating: 0 24px 55px rgba(0, 0, 0, 0.55);
                          }
                          .navbar-card,
                          .navbar-card.desktop,
                          .navbar-card.mobile,
                          .navbar-card.desktop.bottom,
                          .navbar-card.desktop.top,
                          .navbar-card.desktop.left,
                          .navbar-card.desktop.right,
                          .navbar-card.mobile.floating,
                          ha-card.navbar-card {
                            background: rgba(25, 36, 54, 0.55) !important;
                            border: 1px solid rgba(255, 255, 255, 0.18) !important;
                            backdrop-filter: blur(20px);
                            -webkit-backdrop-filter: blur(20px);
                            box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45) !important;
                          }
            routes:
              - url: /at-a-glance/overview
                icon: mdi:home
                label: Home
                selected: |
                  [[[
                    const path = (location && location.pathname) || '';
                    const direct = ['/at-a-glance/security', '/at-a-glance/shopping-list', '/at-a-glance/chores'];
                    return !direct.some(prefix => path.startsWith(prefix));
                  ]]]
              - url: /at-a-glance/security
                icon: mdi:shield
                label: Security
              - url: /at-a-glance/shopping-list
                icon: mdi:shopping
                label: Shopping List
              - icon: mdi:dots-horizontal
                label: More
                tap_action:
                  action: open-popup
                popup:
                  - icon: mdi:cog
                    url: /config/dashboard
                  - icon: mdi:hammer
                    url: /developer-tools/yaml
                  - icon: mdi:power
                    tap_action:
                      action: call-service
                      service: homeassistant.restart
                      service_data: {}
                      confirmation:
                        text: Are you sure you want to restart Home Assistant?
            media_player: {}
            desktop: {}
    cards: []
  - title: Downstairs Hallway
    path: downstairs-hallway
    type: sections
    style: |
      :host {
        --view-padding: 0 16px !important;
        --lovelace-view-margin: 0 16px !important;
        position: relative;
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
      }
      bubble-card {
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
        --bubble-icon-opacity: 1 !important;
        --bubble-icon-opacity-active: 1 !important;
        --bubble-icon-opacity-disabled: 1 !important;
      }
      bubble-card .bubble-icon,
      bubble-card .bubble-main-icon-container,
      bubble-card .bubble-main-icon-container ha-icon,
      bubble-card ha-icon,
      bubble-card .is-off .bubble-main-icon,
      bubble-card .is-off .bubble-main-icon-container,
      bubble-card .is-off ha-icon {
        color: white !important;
        fill: white !important;
        opacity: 1 !important;
        filter: none !important;
      }
      bubble-card .is-off .bubble-background,
      bubble-card .is-off .bubble-icon-container {
        background: rgba(255, 255, 255, 0.35) !important;
      }
      :host::before {
        content: "";
        position: fixed;
        inset: 0;
        background-image: url("media-source://image_upload/b9449f15a0e0c05ad7c84ebd806b883c");
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
        filter: blur(18px) saturate(140%);
        transform: scale(1.05);     /* avoids clipping after blur */
        z-index: -2;
      }
      :host::after {
        content: "";
        position: fixed;
        inset: 0;
        background: rgba(12, 18, 28, 0.35);  /* frosted tint */
        backdrop-filter: blur(8px);
        z-index: -1;
      }
      hui-view-header,
      hui-section-heading-row,
      hui-section-heading-tile {
        display: none !important;
      }
    sections:
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: button
            button_type: name
            show_name: false
            show_state: false
            show_icon: true
            icon: mdi:chevron-left
            tap_action:
              action: fire-dom-event
              browser_mod:
                service: browser_mod.javascript
                data:
                  code: history.back()
            button_action:
              tap_action:
                action: fire-dom-event
                browser_mod:
                  service: browser_mod.javascript
                  data:
                    code: history.back()
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .bubble-icon,
              .bubble-main-icon,
              .bubble-main-icon-container ha-icon {
                color: white !important;
                opacity: 1 !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-button-card-container {
                display: flex !important;
                align-items: center !important;
                justify-content: flex-start !important;
                padding: 0 !important;
                border: 0 !important;
                background: transparent !important;
                box-shadow: none !important;
                cursor: pointer;
                margin-left: -16px !important;
              }
              .bubble-button-card-container:hover,
              .bubble-button-card-container:focus,
              .bubble-button-card-container:active {
                background: transparent !important;
                box-shadow: none !important;
                filter: none !important;
              }


              .bubble-icon-container {
                background: transparent !important;
                box-shadow: none !important;
              }

              .bubble-icon {
                --mdc-icon-size: 36px !important;
                padding: 0 !important;
              }
            grid_options:
              columns: 2
              rows: auto
          - type: markdown
            content: '# Downstairs Hallway'
            text_only: true
            grid_options:
              columns: 6
              rows: auto
            card_mod:
              style: |
                ha-card {
                  display: flex;
                  align-items: center;   # vertical center
                  justify-content: center;  # optional horizontal center
                  height: 100%;
                  padding: 0;
                  margin-left: -32px !important;
                  --card-mod-script: |
                    if (window.__bubbleForceWhiteInit) {
                      return;
                    }
                    window.__bubbleForceWhiteInit = true;
                    const styleId = 'bubble-force-white-style';
                    const cssLines = [
                      '.bubble-icon,',
                      '.bubble-main-icon,',
                      '.bubble-main-icon-container,',
                      '.bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.is-off .bubble-icon,',
                      '.is-off .bubble-main-icon,',
                      '.is-off .bubble-main-icon-container,',
                      '.is-off .bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.ha-markdown-element {',
                      '  color: white !important',
                      '}',
                    ];
                    const css = cssLines.join('\n');
                    const touchIcons = (root) => {
                      if (!root) {
                        return;
                      }
                      root.querySelectorAll('.bubble-icon, .bubble-main-icon, .bubble-main-icon-container ha-icon').forEach((icon) => {
                        icon.style.setProperty('color', 'white', 'important');
                        icon.style.setProperty('fill', 'white', 'important');
                        icon.style.setProperty('opacity', '1', 'important');
                        icon.style.removeProperty('filter');
                      });
                    };
                    const applyStyles = (card) => {
                      if (!card) {
                        return;
                      }
                      const root = card.shadowRoot || card;
                      if (!root) {
                        return;
                      }
                      if (!root.getElementById(styleId)) {
                        const style = document.createElement('style');
                        style.id = styleId;
                        style.textContent = css;
                        root.appendChild(style);
                      }
                      touchIcons(root);
                    };
                    const registeredRoots = new Set();
                    const registerRoot = (root) => {
                      if (
                        root &&
                        typeof root.querySelectorAll === 'function' &&
                        !registeredRoots.has(root)
                      ) {
                        registeredRoots.add(root);
                      }
                    };
                    const scan = () => {
                      registeredRoots.forEach((root) => {
                        root.querySelectorAll('bubble-card').forEach(applyStyles);
                        root.querySelectorAll('*').forEach((el) => {
                          if (el.shadowRoot) {
                            registerRoot(el.shadowRoot);
                          }
                        });
                      });
                    };
                    registerRoot(document);
                    registerRoot(document.body);
                    registerRoot(document.documentElement);
                    scan();
                    window.__bubbleForceWhiteInterval = window.setInterval(() => {
                      scan();
                    }, 750);
                }
                ha-markdown {
                  margin: 0;
                  width: 100%;
                  text-align: center;    # drop if you only want vertical centering
                   color: white !important;
                }
          - type: custom:swipe-card
            grid_options:
              columns: full
              rows: 1
            parameters:
              slidesPerView: auto
              spaceBetween: 12
              freeMode: true
              freeModeSticky: false
              mousewheel: true
            style: |
              margin-bottom: 10px !important;
            cards:
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: light.downstairs_hallway
                name: Light
                show_state: true
                icon: mdi:lightbulb
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    --lights-color: ${(() => {
                      const light = hass.states[entity];
                      if (!light) {
                        return 'rgba(255, 255, 255, 0.35)';
                      }
                      const state = light.state;
                      if (state === 'off') {
                        return '#1e88e5';
                      }
                      if (state === 'unavailable') {
                        return 'rgba(120, 120, 120, 0.6)';
                      }
                      const attrs = light.attributes || {};
                      const rgb = attrs.rgb_color;
                      if (Array.isArray(rgb) && rgb.length === 3) {
                        const [r, g, b] = rgb;
                        return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                      }
                      const hs = attrs.hs_color;
                      if (Array.isArray(hs) && hs.length === 2) {
                        const hue = hs[0];
                        const sat = (hs[1] || 0) / 100;
                        const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                        const c = brightness * sat;
                        const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                        const m = brightness - c;
                        let r1 = 0;
                        let g1 = 0;
                        let b1 = 0;
                        if (hue >= 0 && hue < 60) {
                          r1 = c;
                          g1 = x;
                        } else if (hue < 120) {
                          r1 = x;
                          g1 = c;
                        } else if (hue < 180) {
                          g1 = c;
                          b1 = x;
                        } else if (hue < 240) {
                          g1 = x;
                          b1 = c;
                        } else if (hue < 300) {
                          r1 = x;
                          b1 = c;
                        } else {
                          r1 = c;
                          b1 = x;
                        }
                        const r = Math.round((r1 + m) * 255);
                        const g = Math.round((g1 + m) * 255);
                        const b = Math.round((b1 + m) * 255);
                        return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                      }
                      const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                      if (temp) {
                        const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                        const kelvin = clamp(temp, 2000, 6500);
                        const t = kelvin / 100;
                        let r;
                        let g;
                        let b;
                        if (t <= 66) {
                          r = 255;
                          g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                        } else {
                          r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                          g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                        }
                        if (t >= 66) {
                          b = 255;
                        } else if (t <= 19) {
                          b = 0;
                        } else {
                          b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                        }
                        return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                      }
                      return 'rgba(255, 255, 255, 0.35)';
                    })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--lights-color) !important;
                  }
                tap_action:
                  action: navigate
                  navigation_path: '#lights-downstairs-hallway'
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#lights-downstairs-hallway'
                card_mod:
                  style: >
                    :host {
                      width: auto;
                      max-width: 130px;
                      flex: 0 0 auto;
                      margin-bottom: 10px !important;
                      --bubble-icon-color: white;          # primary icon color
                      --bubble-icon-color-active: white;   # when entity is "on"
                      --bubble-icon-color-disabled: white;
                      --bubble-button-spacing: 0px;   /* no gap between icon and text */
                    }

                    .bubble-main-icon-container {
                      background: none !important;
                      box-shadow: none !important;
                      padding: 0 !important;
                      width: auto !important;
                      height: auto !important;
                      pointer-events: none !important;
                    }

                    .bubble-main-icon-container ha-icon {
                      width: 24px;   /* or any size you need */
                      height: 24px;
                      color: white !important;
                    }

                    .bubble-main-icon-container ha-ripple,

                    .bubble-main-icon-container .bubble-icon-feedback-container
                    {
                      display: none !important;   /* remove ripple/feedback layers */
                    }
        column_span: 4
      - type: grid
        cards:
          - type: vertical-stack
            grid_options:
              columns: full
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#lights-downstairs-hallway'
                button_type: name
                show_icon: false
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                  .bubble-pop-up-background {
                    background-color: rgba(25, 36, 54, 0.55) !important;
                    filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.18);
                    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.15),
                        0 15px 40px rgba(0, 0, 0, 0.35);
                  }
              - type: custom:bubble-card
                card_type: separator
                name: Downstairs Hallway Light
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button:
                  - entity: light.downstairs_hallway
                    tap_action:
                      action: toggle
                    icon: mdi:lightbulb
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.hue_ambiance_downlight_25
                    name: Downstairs Hallway Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }

                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                columns: 2
        column_span: 4
      - type: grid
        cards:
          - type: custom:navbar-card
            layout:
              mobile:
                mode: floating
                show_labels: false
              desktop:
                position: bottom
                show_labels: true
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .navbar-card.mobile {
                padding-bottom: calc(env(safe-area-inset-bottom, 0px));
              }
                          :host {
                            --navbar-background-color: rgba(25, 36, 54, 0.55);
                            --navbar-box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-desktop: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-mobile-floating: 0 24px 55px rgba(0, 0, 0, 0.55);
                          }
                          .navbar-card,
                          .navbar-card.desktop,
                          .navbar-card.mobile,
                          .navbar-card.desktop.bottom,
                          .navbar-card.desktop.top,
                          .navbar-card.desktop.left,
                          .navbar-card.desktop.right,
                          .navbar-card.mobile.floating,
                          ha-card.navbar-card {
                            background: rgba(25, 36, 54, 0.55) !important;
                            border: 1px solid rgba(255, 255, 255, 0.18) !important;
                            backdrop-filter: blur(20px);
                            -webkit-backdrop-filter: blur(20px);
                            box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45) !important;
                          }
            routes:
              - url: /at-a-glance/overview
                icon: mdi:home
                label: Home
                selected: |
                  [[[
                    const path = (location && location.pathname) || '';
                    const direct = ['/at-a-glance/security', '/at-a-glance/shopping-list', '/at-a-glance/chores'];
                    return !direct.some(prefix => path.startsWith(prefix));
                  ]]]
              - url: /at-a-glance/security
                icon: mdi:shield
                label: Security
              - url: /at-a-glance/shopping-list
                icon: mdi:shopping
                label: Shopping List
              - icon: mdi:dots-horizontal
                label: More
                tap_action:
                  action: open-popup
                popup:
                  - icon: mdi:cog
                    url: /config/dashboard
                  - icon: mdi:hammer
                    url: /developer-tools/yaml
                  - icon: mdi:power
                    tap_action:
                      action: call-service
                      service: homeassistant.restart
                      service_data: {}
                      confirmation:
                        text: Are you sure you want to restart Home Assistant?
            media_player: {}
            desktop: {}
    cards: []
  - title: Garage
    path: garage
    type: sections
    style: |
      :host {
        --view-padding: 0 16px !important;
        --lovelace-view-margin: 0 16px !important;
        position: relative;
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
      }
      bubble-card {
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
        --bubble-icon-opacity: 1 !important;
        --bubble-icon-opacity-active: 1 !important;
        --bubble-icon-opacity-disabled: 1 !important;
      }
      bubble-card .bubble-icon,
      bubble-card .bubble-main-icon-container,
      bubble-card .bubble-main-icon-container ha-icon,
      bubble-card ha-icon,
      bubble-card .is-off .bubble-main-icon,
      bubble-card .is-off .bubble-main-icon-container,
      bubble-card .is-off ha-icon {
        color: white !important;
        fill: white !important;
        opacity: 1 !important;
        filter: none !important;
      }
      bubble-card .is-off .bubble-background,
      bubble-card .is-off .bubble-icon-container {
        background: rgba(255, 255, 255, 0.35) !important;
      }
      :host::before {
        content: "";
        position: fixed;
        inset: 0;
        background-image: url("media-source://image_upload/b9449f15a0e0c05ad7c84ebd806b883c");
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
        filter: blur(18px) saturate(140%);
        transform: scale(1.05);     /* avoids clipping after blur */
        z-index: -2;
      }
      :host::after {
        content: "";
        position: fixed;
        inset: 0;
        background: rgba(12, 18, 28, 0.35);  /* frosted tint */
        backdrop-filter: blur(8px);
        z-index: -1;
      }
      hui-view-header,
      hui-section-heading-row,
      hui-section-heading-tile {
        display: none !important;
      }
    sections:
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: button
            button_type: name
            show_name: false
            show_state: false
            show_icon: true
            icon: mdi:chevron-left
            tap_action:
              action: fire-dom-event
              browser_mod:
                service: browser_mod.javascript
                data:
                  code: history.back()
            button_action:
              tap_action:
                action: fire-dom-event
                browser_mod:
                  service: browser_mod.javascript
                  data:
                    code: history.back()
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .bubble-icon,
              .bubble-main-icon,
              .bubble-main-icon-container ha-icon {
                color: white !important;
                opacity: 1 !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-button-card-container {
                display: flex !important;
                align-items: center !important;
                justify-content: flex-start !important;
                padding: 0 !important;
                border: 0 !important;
                background: transparent !important;
                box-shadow: none !important;
                cursor: pointer;
                margin-left: -16px !important;
              }
              .bubble-button-card-container:hover,
              .bubble-button-card-container:focus,
              .bubble-button-card-container:active {
                background: transparent !important;
                box-shadow: none !important;
                filter: none !important;
              }


              .bubble-icon-container {
                background: transparent !important;
                box-shadow: none !important;
              }

              .bubble-icon {
                --mdc-icon-size: 36px !important;
                padding: 0 !important;
              }
            grid_options:
              columns: 2
              rows: auto
          - type: markdown
            content: '# Garage'
            text_only: true
            grid_options:
              columns: 6
              rows: auto
            card_mod:
              style: |
                ha-card {
                  display: flex;
                  align-items: center;   # vertical center
                  justify-content: center;  # optional horizontal center
                  height: 100%;
                  padding: 0;
                  margin-left: -32px !important;
                  --card-mod-script: |
                    if (window.__bubbleForceWhiteInit) {
                      return;
                    }
                    window.__bubbleForceWhiteInit = true;
                    const styleId = 'bubble-force-white-style';
                    const cssLines = [
                      '.bubble-icon,',
                      '.bubble-main-icon,',
                      '.bubble-main-icon-container,',
                      '.bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.is-off .bubble-icon,',
                      '.is-off .bubble-main-icon,',
                      '.is-off .bubble-main-icon-container,',
                      '.is-off .bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.ha-markdown-element {',
                      '  color: white !important',
                      '}',
                    ];
                    const css = cssLines.join('\n');
                    const touchIcons = (root) => {
                      if (!root) {
                        return;
                      }
                      root.querySelectorAll('.bubble-icon, .bubble-main-icon, .bubble-main-icon-container ha-icon').forEach((icon) => {
                        icon.style.setProperty('color', 'white', 'important');
                        icon.style.setProperty('fill', 'white', 'important');
                        icon.style.setProperty('opacity', '1', 'important');
                        icon.style.removeProperty('filter');
                      });
                    };
                    const applyStyles = (card) => {
                      if (!card) {
                        return;
                      }
                      const root = card.shadowRoot || card;
                      if (!root) {
                        return;
                      }
                      if (!root.getElementById(styleId)) {
                        const style = document.createElement('style');
                        style.id = styleId;
                        style.textContent = css;
                        root.appendChild(style);
                      }
                      touchIcons(root);
                    };
                    const registeredRoots = new Set();
                    const registerRoot = (root) => {
                      if (
                        root &&
                        typeof root.querySelectorAll === 'function' &&
                        !registeredRoots.has(root)
                      ) {
                        registeredRoots.add(root);
                      }
                    };
                    const scan = () => {
                      registeredRoots.forEach((root) => {
                        root.querySelectorAll('bubble-card').forEach(applyStyles);
                        root.querySelectorAll('*').forEach((el) => {
                          if (el.shadowRoot) {
                            registerRoot(el.shadowRoot);
                          }
                        });
                      });
                    };
                    registerRoot(document);
                    registerRoot(document.body);
                    registerRoot(document.documentElement);
                    scan();
                    window.__bubbleForceWhiteInterval = window.setInterval(() => {
                      scan();
                    }, 750);
                }
                ha-markdown {
                  margin: 0;
                  width: 100%;
                  text-align: center;    # drop if you only want vertical centering
                   color: white !important;
                }
        column_span: 4
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: separator
            name: Appliances
            card_layout: large
            rows: '01'
            grid_options:
              columns: full
            sub_button: []
          - type: custom:bubble-card
            card_type: button
            button_type: switch
            entity: input_text.washing_machine_state
            grid_options:
              columns: 6
              rows: 2
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            tap_action:
              action: none
            button_action:
              hold_action:
                action: none
              tap_action:
                action: none
            styles: |
              :host {
                --security-color: ${(() => {
                    const state = hass.states[entity]?.state;
                    if (state === 'Running') {
                      return '#1e88e5';
                    }
                    return '#ffffff59';
                  })()};
              }
              .bubble-main-icon {
                color: white !important;
              }
              .bubble-background {
                background: var(--security-color) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-main-icon-container {
                background: none !important;
                box-shadow: none !important;
                padding: 0 !important;
                width: auto !important;
                height: auto !important;
                pointer-events: none !important;
              }
            name: Washing Machine
            show_state: true
            icon: mdi:washing-machine
          - type: custom:bubble-card
            card_type: button
            button_type: switch
            entity: input_text.dryer_state
            grid_options:
              columns: 6
              rows: 2
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            tap_action:
              action: none
            button_action:
              hold_action:
                action: none
              tap_action:
                action: none
            styles: |
              :host {
                --security-color: ${(() => {
                    const state = hass.states[entity]?.state;
                    if (state === 'Running') {
                      return '#1e88e5';
                    }
                    return '#ffffff59';
                  })()};
              }
              .bubble-main-icon {
                color: white !important;
              }
              .bubble-background {
                background: var(--security-color) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-main-icon-container {
                background: none !important;
                box-shadow: none !important;
                padding: 0 !important;
                width: auto !important;
                height: auto !important;
                pointer-events: none !important;
              }
            name: Dryer
            show_state: true
            icon: mdi:tumble-dryer
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: separator
            name: Garage Doors
            card_layout: large
            rows: '01'
            grid_options:
              columns: full
            sub_button: []
          - type: custom:bubble-card
            card_type: button
            button_type: slider
            entity: cover.left_door
            name: Left Door
            card_layout: large
            grid_options:
              columns: 6
              rows: 2
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            tap_action:
              action: toggle
            button_action: {}
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background {
                background: rgba(67, 160, 71, 0.35) !important;
              }
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-on .bubble-background {
                background: rgba(255, 0, 0, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-main-icon-container {
                background: none !important;
                box-shadow: none !important;
                padding: 0 !important;
                width: auto !important;
                height: auto !important;
                pointer-events: none !important;
              }
            show_state: true
          - type: custom:bubble-card
            card_type: button
            button_type: slider
            entity: cover.right_door
            name: Right Door
            card_layout: large
            grid_options:
              columns: 6
              rows: 2
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            tap_action:
              action: toggle
            button_action: {}
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background {
                background: rgba(67, 160, 71, 0.35) !important;
              }
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-on .bubble-background {
                background: rgba(255, 0, 0, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-main-icon-container {
                background: none !important;
                box-shadow: none !important;
                padding: 0 !important;
                width: auto !important;
                height: auto !important;
                pointer-events: none !important;
              }
            show_state: true
        column_span: 4
      - type: grid
        cards:
          - type: custom:navbar-card
            layout:
              mobile:
                mode: floating
                show_labels: false
              desktop:
                position: bottom
                show_labels: true
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .navbar-card.mobile {
                padding-bottom: calc(env(safe-area-inset-bottom, 0px));
              }
                          :host {
                            --navbar-background-color: rgba(25, 36, 54, 0.55);
                            --navbar-box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-desktop: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-mobile-floating: 0 24px 55px rgba(0, 0, 0, 0.55);
                          }
                          .navbar-card,
                          .navbar-card.desktop,
                          .navbar-card.mobile,
                          .navbar-card.desktop.bottom,
                          .navbar-card.desktop.top,
                          .navbar-card.desktop.left,
                          .navbar-card.desktop.right,
                          .navbar-card.mobile.floating,
                          ha-card.navbar-card {
                            background: rgba(25, 36, 54, 0.55) !important;
                            border: 1px solid rgba(255, 255, 255, 0.18) !important;
                            backdrop-filter: blur(20px);
                            -webkit-backdrop-filter: blur(20px);
                            box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45) !important;
                          }
            routes:
              - url: /at-a-glance/overview
                icon: mdi:home
                label: Home
                selected: |
                  [[[
                    const path = (location && location.pathname) || '';
                    const direct = ['/at-a-glance/security', '/at-a-glance/shopping-list', '/at-a-glance/chores'];
                    return !direct.some(prefix => path.startsWith(prefix));
                  ]]]
              - url: /at-a-glance/security
                icon: mdi:shield
                label: Security
              - url: /at-a-glance/shopping-list
                icon: mdi:shopping
                label: Shopping List
              - icon: mdi:dots-horizontal
                label: More
                tap_action:
                  action: open-popup
                popup:
                  - icon: mdi:cog
                    url: /config/dashboard
                  - icon: mdi:hammer
                    url: /developer-tools/yaml
                  - icon: mdi:power
                    tap_action:
                      action: call-service
                      service: homeassistant.restart
                      service_data: {}
                      confirmation:
                        text: Are you sure you want to restart Home Assistant?
            media_player: {}
            desktop: {}
    cards: []
  - title: Guest Bathroom
    path: guest-bathroom
    type: sections
    style: |
      :host {
        --view-padding: 0 16px !important;
        --lovelace-view-margin: 0 16px !important;
        position: relative;
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
      }
      bubble-card {
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
        --bubble-icon-opacity: 1 !important;
        --bubble-icon-opacity-active: 1 !important;
        --bubble-icon-opacity-disabled: 1 !important;
      }
      bubble-card .bubble-icon,
      bubble-card .bubble-main-icon-container,
      bubble-card .bubble-main-icon-container ha-icon,
      bubble-card ha-icon,
      bubble-card .is-off .bubble-main-icon,
      bubble-card .is-off .bubble-main-icon-container,
      bubble-card .is-off ha-icon {
        color: white !important;
        fill: white !important;
        opacity: 1 !important;
        filter: none !important;
      }
      bubble-card .is-off .bubble-background,
      bubble-card .is-off .bubble-icon-container {
        background: rgba(255, 255, 255, 0.35) !important;
      }
      :host::before {
        content: "";
        position: fixed;
        inset: 0;
        background-image: url("media-source://image_upload/b9449f15a0e0c05ad7c84ebd806b883c");
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
        filter: blur(18px) saturate(140%);
        transform: scale(1.05);     /* avoids clipping after blur */
        z-index: -2;
      }
      :host::after {
        content: "";
        position: fixed;
        inset: 0;
        background: rgba(12, 18, 28, 0.35);  /* frosted tint */
        backdrop-filter: blur(8px);
        z-index: -1;
      }
      hui-view-header,
      hui-section-heading-row,
      hui-section-heading-tile {
        display: none !important;
      }
    sections:
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: button
            button_type: name
            show_name: false
            show_state: false
            show_icon: true
            icon: mdi:chevron-left
            tap_action:
              action: fire-dom-event
              browser_mod:
                service: browser_mod.javascript
                data:
                  code: history.back()
            button_action:
              tap_action:
                action: fire-dom-event
                browser_mod:
                  service: browser_mod.javascript
                  data:
                    code: history.back()
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .bubble-icon,
              .bubble-main-icon,
              .bubble-main-icon-container ha-icon {
                color: white !important;
                opacity: 1 !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-button-card-container {
                display: flex !important;
                align-items: center !important;
                justify-content: flex-start !important;
                padding: 0 !important;
                border: 0 !important;
                background: transparent !important;
                box-shadow: none !important;
                cursor: pointer;
                margin-left: -16px !important;
              }
              .bubble-button-card-container:hover,
              .bubble-button-card-container:focus,
              .bubble-button-card-container:active {
                background: transparent !important;
                box-shadow: none !important;
                filter: none !important;
              }


              .bubble-icon-container {
                background: transparent !important;
                box-shadow: none !important;
              }

              .bubble-icon {
                --mdc-icon-size: 36px !important;
                padding: 0 !important;
              }
            grid_options:
              columns: 2
              rows: auto
          - type: markdown
            content: '# Guest Bathroom'
            text_only: true
            grid_options:
              columns: 6
              rows: auto
            card_mod:
              style: |
                ha-card {
                  display: flex;
                  align-items: center;   # vertical center
                  justify-content: center;  # optional horizontal center
                  height: 100%;
                  padding: 0;
                  margin-left: -32px !important;
                  --card-mod-script: |
                    if (window.__bubbleForceWhiteInit) {
                      return;
                    }
                    window.__bubbleForceWhiteInit = true;
                    const styleId = 'bubble-force-white-style';
                    const cssLines = [
                      '.bubble-icon,',
                      '.bubble-main-icon,',
                      '.bubble-main-icon-container,',
                      '.bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.is-off .bubble-icon,',
                      '.is-off .bubble-main-icon,',
                      '.is-off .bubble-main-icon-container,',
                      '.is-off .bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.ha-markdown-element {',
                      '  color: white !important',
                      '}',
                    ];
                    const css = cssLines.join('\n');
                    const touchIcons = (root) => {
                      if (!root) {
                        return;
                      }
                      root.querySelectorAll('.bubble-icon, .bubble-main-icon, .bubble-main-icon-container ha-icon').forEach((icon) => {
                        icon.style.setProperty('color', 'white', 'important');
                        icon.style.setProperty('fill', 'white', 'important');
                        icon.style.setProperty('opacity', '1', 'important');
                        icon.style.removeProperty('filter');
                      });
                    };
                    const applyStyles = (card) => {
                      if (!card) {
                        return;
                      }
                      const root = card.shadowRoot || card;
                      if (!root) {
                        return;
                      }
                      if (!root.getElementById(styleId)) {
                        const style = document.createElement('style');
                        style.id = styleId;
                        style.textContent = css;
                        root.appendChild(style);
                      }
                      touchIcons(root);
                    };
                    const registeredRoots = new Set();
                    const registerRoot = (root) => {
                      if (
                        root &&
                        typeof root.querySelectorAll === 'function' &&
                        !registeredRoots.has(root)
                      ) {
                        registeredRoots.add(root);
                      }
                    };
                    const scan = () => {
                      registeredRoots.forEach((root) => {
                        root.querySelectorAll('bubble-card').forEach(applyStyles);
                        root.querySelectorAll('*').forEach((el) => {
                          if (el.shadowRoot) {
                            registerRoot(el.shadowRoot);
                          }
                        });
                      });
                    };
                    registerRoot(document);
                    registerRoot(document.body);
                    registerRoot(document.documentElement);
                    scan();
                    window.__bubbleForceWhiteInterval = window.setInterval(() => {
                      scan();
                    }, 750);
                }
                ha-markdown {
                  margin: 0;
                  width: 100%;
                  text-align: center;    # drop if you only want vertical centering
                   color: white !important;
                }
          - type: custom:swipe-card
            grid_options:
              columns: full
              rows: 1
            parameters:
              slidesPerView: auto
              spaceBetween: 12
              freeMode: true
              freeModeSticky: false
              mousewheel: true
            style: |
              margin-bottom: 10px !important;
            cards:
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: light.guest_bathroom_dimmer_switch
                name: Light
                show_state: true
                icon: mdi:lightbulb
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    --lights-color: ${(() => {
                      const light = hass.states[entity];
                      if (!light) {
                        return 'rgba(255, 255, 255, 0.35)';
                      }
                      const state = light.state;
                      if (state === 'off') {
                        return '#1e88e5';
                      }
                      if (state === 'unavailable') {
                        return 'rgba(120, 120, 120, 0.6)';
                      }
                      const attrs = light.attributes || {};
                      const rgb = attrs.rgb_color;
                      if (Array.isArray(rgb) && rgb.length === 3) {
                        const [r, g, b] = rgb;
                        return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                      }
                      const hs = attrs.hs_color;
                      if (Array.isArray(hs) && hs.length === 2) {
                        const hue = hs[0];
                        const sat = (hs[1] || 0) / 100;
                        const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                        const c = brightness * sat;
                        const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                        const m = brightness - c;
                        let r1 = 0;
                        let g1 = 0;
                        let b1 = 0;
                        if (hue >= 0 && hue < 60) {
                          r1 = c;
                          g1 = x;
                        } else if (hue < 120) {
                          r1 = x;
                          g1 = c;
                        } else if (hue < 180) {
                          g1 = c;
                          b1 = x;
                        } else if (hue < 240) {
                          g1 = x;
                          b1 = c;
                        } else if (hue < 300) {
                          r1 = x;
                          b1 = c;
                        } else {
                          r1 = c;
                          b1 = x;
                        }
                        const r = Math.round((r1 + m) * 255);
                        const g = Math.round((g1 + m) * 255);
                        const b = Math.round((b1 + m) * 255);
                        return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                      }
                      const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                      if (temp) {
                        const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                        const kelvin = clamp(temp, 2000, 6500);
                        const t = kelvin / 100;
                        let r;
                        let g;
                        let b;
                        if (t <= 66) {
                          r = 255;
                          g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                        } else {
                          r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                          g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                        }
                        if (t >= 66) {
                          b = 255;
                        } else if (t <= 19) {
                          b = 0;
                        } else {
                          b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                        }
                        return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                      }
                      return 'rgba(255, 255, 255, 0.35)';
                    })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--lights-color) !important;
                  }
                tap_action:
                  action: navigate
                  navigation_path: '#lights-guest-bathroom'
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#lights-guest-bathroom'
                card_mod:
                  style: >
                    :host {
                      width: auto;
                      max-width: 130px;
                      flex: 0 0 auto;
                      margin-bottom: 10px !important;
                      --bubble-icon-color: white;          # primary icon color
                      --bubble-icon-color-active: white;   # when entity is "on"
                      --bubble-icon-color-disabled: white;
                      --bubble-button-spacing: 0px;   /* no gap between icon and text */
                    }

                    .bubble-main-icon-container {
                      background: none !important;
                      box-shadow: none !important;
                      padding: 0 !important;
                      width: auto !important;
                      height: auto !important;
                      pointer-events: none !important;
                    }

                    .bubble-main-icon-container ha-icon {
                      width: 24px;   /* or any size you need */
                      height: 24px;
                      color: white !important;
                    }

                    .bubble-main-icon-container ha-ripple,

                    .bubble-main-icon-container .bubble-icon-feedback-container
                    {
                      display: none !important;   /* remove ripple/feedback layers */
                    }
              - type: custom:bubble-card
                card_type: button
                button_type: state
                entity: input_text.guest_bathroom_climate_range
                icon: mdi:thermometer
                name: Climate
                show_state: true
                modules:
                  - frosted_glass
                  - get_state_attribute
                get_state_attribute:
                  - entity: input_text.guest_bathroom_climate_range
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    width: auto;
                    max-width: 180px;
                    flex: 0 0 auto;
                    margin-bottom: 10px !important;
                    --climate-color: ${(() => {
                      const color = hass.states['input_text.guest_bathroom_climate_color']?.state?.trim();
                      return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                    })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--climate-color) !important;
                  }

                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#climate-guest-bathroom'
                  hold_action:
                    action: none
                icon_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#climate-guest-bathroom'
                  hold_action:
                    action: none
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: binary_sensor.guest_bathroom_presence_sensor_occupancy
                name: Occupancy
                icon: mdi:motion-sensor
                show_state: true
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    --occupancy-color: ${(() => {
                        const securityEntity = 'alarm_control_panel.aqara_hub_m3_0056_security_system_2';
                        const occState = hass.states[entity]?.state;
                        const securityState = hass.states[securityEntity]?.state;
                        const occupiedStates = ['on', 'detected', 'occupied'];
                        const clearStates = ['off', 'clear', 'standby'];
                        if (clearStates.includes(occState)) {
                          return '#43a047';
                        }
                        if (occupiedStates.includes(occState) && securityState === 'armed_away') {
                          return '#e53935';
                        }
                        if (occupiedStates.includes(occState)) {
                          return '#1e88e5';
                        }
                        if (occState === 'unavailable') {
                          return 'rgba(120, 120, 120, 0.6)';
                        }
                        return '#546e7a';
                      })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--occupancy-color) !important;
                  }
                card_mod:
                  style: >
                    :host {
                      width: auto;
                      max-width: 150px;
                      flex: 0 0 auto;
                      margin-bottom: 10px !important;
                      --bubble-icon-color: white;          # primary icon color
                      --bubble-icon-color-active: white;   # when entity is "on"
                      --bubble-icon-color-disabled: white;    # when unavailable
                    }

                    .bubble-main-icon-container {
                      background: none !important;
                      box-shadow: none !important;
                      padding: 0 !important;
                      width: auto !important;
                      height: auto !important;
                      pointer-events: none !important;
                    }

                    .bubble-main-icon-container ha-icon {
                      width: 24px;   /* or any size you need */
                      height: 24px;
                      color: white !important;
                    }

                    .bubble-main-icon-container ha-ripple,

                    .bubble-main-icon-container .bubble-icon-feedback-container
                    {
                      display: none !important;   /* remove ripple/feedback layers */
                    }
        column_span: 4
      - type: grid
        cards:
          - type: vertical-stack
            grid_options:
              columns: full
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#lights-guest-bathroom'
                button_type: name
                show_icon: false
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                  .bubble-pop-up-background {
                    background-color: rgba(25, 36, 54, 0.55) !important;
                    filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.18);
                    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.15),
                        0 15px 40px rgba(0, 0, 0, 0.35);
                  }
              - type: custom:bubble-card
                card_type: separator
                name: Guest Bathroom Light
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button:
                  - entity: light.guest_bathroom_dimmer_switch
                    tap_action:
                      action: toggle
                    icon: mdi:lightbulb
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.guest_bathroom_dimmer_switch
                    name: Guest Bathroom Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }

                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                columns: 2
          - type: vertical-stack
            grid_options:
              columns: full
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#climate-guest-bathroom'
                button_type: name
                show_icon: false
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                  .bubble-pop-up-background {
                    background-color: rgba(25, 36, 54, 0.55) !important;
                    filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.18);
                    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.15),
                        0 15px 40px rgba(0, 0, 0, 0.35);
                  }
              - type: custom:bubble-card
                card_type: separator
                name: Guest Bathroom Climate
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button: []
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.guest_bathroom_presence_sensor_temperature
                    name: Guest Bathroom
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.guest_bathroom_presence_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.guest_bathroom_temperature
                    name: Ecobee
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.guest_bathroom_ecobee_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                columns: 2
        column_span: 4
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: separator
            name: Climate
            card_layout: large
            rows: '01'
            grid_options:
              columns: full
            sub_button: []
          - type: custom:bubble-card
            card_type: button
            button_type: switch
            entity: cover.guest_bathroom_vent_vent
            icon: mdi:air-filter
            tap_action:
              action: perform-action
              perform_action: cover.toggle_cover_tilt
              target:
                entity_id: cover.guest_bathroom_vent_vent
              data: {}
            button_action:
              tap_action:
                action: perform-action
                perform_action: cover.toggle_cover_tilt
                target:
                  entity_id: cover.guest_bathroom_vent_vent
                data: {}
            grid_options:
              columns: 6
              rows: auto
            name: Vent
            show_state: true
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-main-icon-container {
                background: none !important;
                box-shadow: none !important;
                padding: 0 !important;
                width: auto !important;
                height: auto !important;
                pointer-events: none !important;
              }
          - type: custom:bubble-card
            card_type: button
            button_type: switch
            entity: light.aqara_light_switch_h2_us_15
            icon: mdi:fan
            tap_action:
              action: toggle
            button_action:
              tap_action:
                action: toggle
            grid_options:
              columns: 6
              rows: auto
            name: Fan
            show_state: true
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              :host {
                --lights-color: ${(() => {
                  const light = hass.states[entity];
                  if (!light) {
                    return 'rgba(255, 255, 255, 0.35)';
                  }
                  const state = light.state;
                  if (state === 'off') {
                    return '#1e88e5';
                  }
                  if (state === 'unavailable') {
                    return 'rgba(120, 120, 120, 0.6)';
                  }
                  const attrs = light.attributes || {};
                  const rgb = attrs.rgb_color;
                  if (Array.isArray(rgb) && rgb.length === 3) {
                    const [r, g, b] = rgb;
                    return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                  }
                  const hs = attrs.hs_color;
                  if (Array.isArray(hs) && hs.length === 2) {
                    const hue = hs[0];
                    const sat = (hs[1] || 0) / 100;
                    const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                    const c = brightness * sat;
                    const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                    const m = brightness - c;
                    let r1 = 0;
                    let g1 = 0;
                    let b1 = 0;
                    if (hue >= 0 && hue < 60) {
                      r1 = c;
                      g1 = x;
                    } else if (hue < 120) {
                      r1 = x;
                      g1 = c;
                    } else if (hue < 180) {
                      g1 = c;
                      b1 = x;
                    } else if (hue < 240) {
                      g1 = x;
                      b1 = c;
                    } else if (hue < 300) {
                      r1 = x;
                      b1 = c;
                    } else {
                      r1 = c;
                      b1 = x;
                    }
                    const r = Math.round((r1 + m) * 255);
                    const g = Math.round((g1 + m) * 255);
                    const b = Math.round((b1 + m) * 255);
                    return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                  }
                  const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                  if (temp) {
                    const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                    const kelvin = clamp(temp, 2000, 6500);
                    const t = kelvin / 100;
                    let r;
                    let g;
                    let b;
                    if (t <= 66) {
                      r = 255;
                      g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                    } else {
                      r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                      g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                    }
                    if (t >= 66) {
                      b = 255;
                    } else if (t <= 19) {
                      b = 0;
                    } else {
                      b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                    }
                    return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                  }
                  return 'rgba(255, 255, 255, 0.35)';
                })()};
              }
              .bubble-background,
              .bubble-icon-container {
                background: var(--lights-color) !important;
              }
                                .bubble-main-icon-container {
                                  background: none !important;
                                  box-shadow: none !important;
                                  padding: 0 !important;
                                  width: auto !important;
                                  height: auto !important;
                                  pointer-events: none !important;
                                }
          - type: custom:bubble-card
            card_type: button
            button_type: switch
            entity: light.aqara_light_switch_h2_us_16
            icon: mdi:heat-wave
            tap_action:
              action: toggle
            button_action:
              tap_action:
                action: toggle
            grid_options:
              columns: 6
              rows: auto
            name: Towel Rack
            show_state: true
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              :host {
                --lights-color: ${(() => {
                  const light = hass.states[entity];
                  if (!light) {
                    return 'rgba(255, 255, 255, 0.35)';
                  }
                  const state = light.state;
                  if (state === 'off') {
                    return '#1e88e5';
                  }
                  if (state === 'unavailable') {
                    return 'rgba(120, 120, 120, 0.6)';
                  }
                  const attrs = light.attributes || {};
                  const rgb = attrs.rgb_color;
                  if (Array.isArray(rgb) && rgb.length === 3) {
                    const [r, g, b] = rgb;
                    return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                  }
                  const hs = attrs.hs_color;
                  if (Array.isArray(hs) && hs.length === 2) {
                    const hue = hs[0];
                    const sat = (hs[1] || 0) / 100;
                    const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                    const c = brightness * sat;
                    const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                    const m = brightness - c;
                    let r1 = 0;
                    let g1 = 0;
                    let b1 = 0;
                    if (hue >= 0 && hue < 60) {
                      r1 = c;
                      g1 = x;
                    } else if (hue < 120) {
                      r1 = x;
                      g1 = c;
                    } else if (hue < 180) {
                      g1 = c;
                      b1 = x;
                    } else if (hue < 240) {
                      g1 = x;
                      b1 = c;
                    } else if (hue < 300) {
                      r1 = x;
                      b1 = c;
                    } else {
                      r1 = c;
                      b1 = x;
                    }
                    const r = Math.round((r1 + m) * 255);
                    const g = Math.round((g1 + m) * 255);
                    const b = Math.round((b1 + m) * 255);
                    return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                  }
                  const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                  if (temp) {
                    const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                    const kelvin = clamp(temp, 2000, 6500);
                    const t = kelvin / 100;
                    let r;
                    let g;
                    let b;
                    if (t <= 66) {
                      r = 255;
                      g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                    } else {
                      r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                      g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                    }
                    if (t >= 66) {
                      b = 255;
                    } else if (t <= 19) {
                      b = 0;
                    } else {
                      b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                    }
                    return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                  }
                  return 'rgba(255, 255, 255, 0.35)';
                })()};
              }
              .bubble-background,
              .bubble-icon-container {
                background: var(--lights-color) !important;
              }
                                .bubble-main-icon-container {
                                  background: none !important;
                                  box-shadow: none !important;
                                  padding: 0 !important;
                                  width: auto !important;
                                  height: auto !important;
                                  pointer-events: none !important;
                                }
        column_span: 4
      - type: grid
        cards:
          - type: custom:navbar-card
            layout:
              mobile:
                mode: floating
                show_labels: false
              desktop:
                position: bottom
                show_labels: true
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .navbar-card.mobile {
                padding-bottom: calc(env(safe-area-inset-bottom, 0px));
              }
                          :host {
                            --navbar-background-color: rgba(25, 36, 54, 0.55);
                            --navbar-box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-desktop: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-mobile-floating: 0 24px 55px rgba(0, 0, 0, 0.55);
                          }
                          .navbar-card,
                          .navbar-card.desktop,
                          .navbar-card.mobile,
                          .navbar-card.desktop.bottom,
                          .navbar-card.desktop.top,
                          .navbar-card.desktop.left,
                          .navbar-card.desktop.right,
                          .navbar-card.mobile.floating,
                          ha-card.navbar-card {
                            background: rgba(25, 36, 54, 0.55) !important;
                            border: 1px solid rgba(255, 255, 255, 0.18) !important;
                            backdrop-filter: blur(20px);
                            -webkit-backdrop-filter: blur(20px);
                            box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45) !important;
                          }
            routes:
              - url: /at-a-glance/overview
                icon: mdi:home
                label: Home
                selected: |
                  [[[
                    const path = (location && location.pathname) || '';
                    const direct = ['/at-a-glance/security', '/at-a-glance/shopping-list', '/at-a-glance/chores'];
                    return !direct.some(prefix => path.startsWith(prefix));
                  ]]]
              - url: /at-a-glance/security
                icon: mdi:shield
                label: Security
              - url: /at-a-glance/shopping-list
                icon: mdi:shopping
                label: Shopping List
              - icon: mdi:dots-horizontal
                label: More
                tap_action:
                  action: open-popup
                popup:
                  - icon: mdi:cog
                    url: /config/dashboard
                  - icon: mdi:hammer
                    url: /developer-tools/yaml
                  - icon: mdi:power
                    tap_action:
                      action: call-service
                      service: homeassistant.restart
                      service_data: {}
                      confirmation:
                        text: Are you sure you want to restart Home Assistant?
            media_player: {}
            desktop: {}
    cards: []
  - title: Master Bathroom
    path: master-bathroom
    type: sections
    style: |
      :host {
        --view-padding: 0 16px !important;
        --lovelace-view-margin: 0 16px !important;
        position: relative;
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
      }
      bubble-card {
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
        --bubble-icon-opacity: 1 !important;
        --bubble-icon-opacity-active: 1 !important;
        --bubble-icon-opacity-disabled: 1 !important;
      }
      bubble-card .bubble-icon,
      bubble-card .bubble-main-icon-container,
      bubble-card .bubble-main-icon-container ha-icon,
      bubble-card ha-icon,
      bubble-card .is-off .bubble-main-icon,
      bubble-card .is-off .bubble-main-icon-container,
      bubble-card .is-off ha-icon {
        color: white !important;
        fill: white !important;
        opacity: 1 !important;
        filter: none !important;
      }
      bubble-card .is-off .bubble-background,
      bubble-card .is-off .bubble-icon-container {
        background: rgba(255, 255, 255, 0.35) !important;
      }
      :host::before {
        content: "";
        position: fixed;
        inset: 0;
        background-image: url("media-source://image_upload/b9449f15a0e0c05ad7c84ebd806b883c");
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
        filter: blur(18px) saturate(140%);
        transform: scale(1.05);     /* avoids clipping after blur */
        z-index: -2;
      }
      :host::after {
        content: "";
        position: fixed;
        inset: 0;
        background: rgba(12, 18, 28, 0.35);  /* frosted tint */
        backdrop-filter: blur(8px);
        z-index: -1;
      }
      hui-view-header,
      hui-section-heading-row,
      hui-section-heading-tile {
        display: none !important;
      }
    sections:
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: button
            button_type: name
            show_name: false
            show_state: false
            show_icon: true
            icon: mdi:chevron-left
            tap_action:
              action: fire-dom-event
              browser_mod:
                service: browser_mod.javascript
                data:
                  code: history.back()
            button_action:
              tap_action:
                action: fire-dom-event
                browser_mod:
                  service: browser_mod.javascript
                  data:
                    code: history.back()
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .bubble-icon,
              .bubble-main-icon,
              .bubble-main-icon-container ha-icon {
                color: white !important;
                opacity: 1 !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-button-card-container {
                display: flex !important;
                align-items: center !important;
                justify-content: flex-start !important;
                padding: 0 !important;
                border: 0 !important;
                background: transparent !important;
                box-shadow: none !important;
                cursor: pointer;
                margin-left: -16px !important;
              }
              .bubble-button-card-container:hover,
              .bubble-button-card-container:focus,
              .bubble-button-card-container:active {
                background: transparent !important;
                box-shadow: none !important;
                filter: none !important;
              }


              .bubble-icon-container {
                background: transparent !important;
                box-shadow: none !important;
              }

              .bubble-icon {
                --mdc-icon-size: 36px !important;
                padding: 0 !important;
              }
            grid_options:
              columns: 2
              rows: auto
          - type: markdown
            content: '# Master Bathroom'
            text_only: true
            grid_options:
              columns: 9
              rows: auto
            card_mod:
              style: |
                ha-card {
                  display: flex;
                  align-items: center;   # vertical center
                  justify-content: center;  # optional horizontal center
                  height: 100%;
                  padding: 0;
                  margin-left: -32px !important;
                  --card-mod-script: |
                    if (window.__bubbleForceWhiteInit) {
                      return;
                    }
                    window.__bubbleForceWhiteInit = true;
                    const styleId = 'bubble-force-white-style';
                    const cssLines = [
                      '.bubble-icon,',
                      '.bubble-main-icon,',
                      '.bubble-main-icon-container,',
                      '.bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.is-off .bubble-icon,',
                      '.is-off .bubble-main-icon,',
                      '.is-off .bubble-main-icon-container,',
                      '.is-off .bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.ha-markdown-element {',
                      '  color: white !important',
                      '}',
                    ];
                    const css = cssLines.join('\n');
                    const touchIcons = (root) => {
                      if (!root) {
                        return;
                      }
                      root.querySelectorAll('.bubble-icon, .bubble-main-icon, .bubble-main-icon-container ha-icon').forEach((icon) => {
                        icon.style.setProperty('color', 'white', 'important');
                        icon.style.setProperty('fill', 'white', 'important');
                        icon.style.setProperty('opacity', '1', 'important');
                        icon.style.removeProperty('filter');
                      });
                    };
                    const applyStyles = (card) => {
                      if (!card) {
                        return;
                      }
                      const root = card.shadowRoot || card;
                      if (!root) {
                        return;
                      }
                      if (!root.getElementById(styleId)) {
                        const style = document.createElement('style');
                        style.id = styleId;
                        style.textContent = css;
                        root.appendChild(style);
                      }
                      touchIcons(root);
                    };
                    const registeredRoots = new Set();
                    const registerRoot = (root) => {
                      if (
                        root &&
                        typeof root.querySelectorAll === 'function' &&
                        !registeredRoots.has(root)
                      ) {
                        registeredRoots.add(root);
                      }
                    };
                    const scan = () => {
                      registeredRoots.forEach((root) => {
                        root.querySelectorAll('bubble-card').forEach(applyStyles);
                        root.querySelectorAll('*').forEach((el) => {
                          if (el.shadowRoot) {
                            registerRoot(el.shadowRoot);
                          }
                        });
                      });
                    };
                    registerRoot(document);
                    registerRoot(document.body);
                    registerRoot(document.documentElement);
                    scan();
                    window.__bubbleForceWhiteInterval = window.setInterval(() => {
                      scan();
                    }, 750);
                }
                ha-markdown {
                  margin: 0;
                  width: 100%;
                  text-align: center;    # drop if you only want vertical centering
                   color: white !important;
                }
          - type: custom:swipe-card
            grid_options:
              columns: full
              rows: 1
            parameters:
              slidesPerView: auto
              spaceBetween: 12
              freeMode: true
              freeModeSticky: false
              mousewheel: true
            style: |
              margin-bottom: 10px !important;
            cards:
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: light.aqara_dimmer_switch_h2
                name: Lights
                show_state: true
                icon: mdi:lightbulb
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    --lights-color: ${(() => {
                      const light = hass.states[entity];
                      if (!light) {
                        return 'rgba(255, 255, 255, 0.35)';
                      }
                      const state = light.state;
                      if (state === 'off') {
                        return '#1e88e5';
                      }
                      if (state === 'unavailable') {
                        return 'rgba(120, 120, 120, 0.6)';
                      }
                      const attrs = light.attributes || {};
                      const rgb = attrs.rgb_color;
                      if (Array.isArray(rgb) && rgb.length === 3) {
                        const [r, g, b] = rgb;
                        return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                      }
                      const hs = attrs.hs_color;
                      if (Array.isArray(hs) && hs.length === 2) {
                        const hue = hs[0];
                        const sat = (hs[1] || 0) / 100;
                        const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                        const c = brightness * sat;
                        const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                        const m = brightness - c;
                        let r1 = 0;
                        let g1 = 0;
                        let b1 = 0;
                        if (hue >= 0 && hue < 60) {
                          r1 = c;
                          g1 = x;
                        } else if (hue < 120) {
                          r1 = x;
                          g1 = c;
                        } else if (hue < 180) {
                          g1 = c;
                          b1 = x;
                        } else if (hue < 240) {
                          g1 = x;
                          b1 = c;
                        } else if (hue < 300) {
                          r1 = x;
                          b1 = c;
                        } else {
                          r1 = c;
                          b1 = x;
                        }
                        const r = Math.round((r1 + m) * 255);
                        const g = Math.round((g1 + m) * 255);
                        const b = Math.round((b1 + m) * 255);
                        return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                      }
                      const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                      if (temp) {
                        const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                        const kelvin = clamp(temp, 2000, 6500);
                        const t = kelvin / 100;
                        let r;
                        let g;
                        let b;
                        if (t <= 66) {
                          r = 255;
                          g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                        } else {
                          r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                          g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                        }
                        if (t >= 66) {
                          b = 255;
                        } else if (t <= 19) {
                          b = 0;
                        } else {
                          b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                        }
                        return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                      }
                      return 'rgba(255, 255, 255, 0.35)';
                    })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--lights-color) !important;
                  }
                tap_action:
                  action: navigate
                  navigation_path: '#lights-master-bathroom'
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#lights-master-bathroom'
                card_mod:
                  style: >
                    :host {
                      width: auto;
                      max-width: 130px;
                      flex: 0 0 auto;
                      margin-bottom: 10px !important;
                      --bubble-icon-color: white;          # primary icon color
                      --bubble-icon-color-active: white;   # when entity is "on"
                      --bubble-icon-color-disabled: white;
                      --bubble-button-spacing: 0px;   /* no gap between icon and text */
                    }

                    .bubble-main-icon-container {
                      background: none !important;
                      box-shadow: none !important;
                      padding: 0 !important;
                      width: auto !important;
                      height: auto !important;
                      pointer-events: none !important;
                    }

                    .bubble-main-icon-container ha-icon {
                      width: 24px;   /* or any size you need */
                      height: 24px;
                      color: white !important;
                    }

                    .bubble-main-icon-container ha-ripple,

                    .bubble-main-icon-container .bubble-icon-feedback-container
                    {
                      display: none !important;   /* remove ripple/feedback layers */
                    }
              - type: custom:bubble-card
                card_type: button
                button_type: state
                entity: input_text.master_bathroom_climate_range
                icon: mdi:thermometer
                name: Climate
                show_state: true
                modules:
                  - frosted_glass
                  - get_state_attribute
                get_state_attribute:
                  - entity: input_text.master_bathroom_climate_range
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    width: auto;
                    max-width: 180px;
                    flex: 0 0 auto;
                    margin-bottom: 10px !important;
                    --climate-color: ${(() => {
                      const color = hass.states['input_text.master_bathroom_climate_color']?.state?.trim();
                      return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                    })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--climate-color) !important;
                  }

                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#climate-master-bathroom'
                  hold_action:
                    action: none
                icon_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#climate-master-bathroom'
                  hold_action:
                    action: none
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: binary_sensor.master_bathroom_presense_sensor_occupancy
                name: Occupancy
                icon: mdi:motion-sensor
                show_state: true
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    --occupancy-color: ${(() => {
                        const securityEntity = 'alarm_control_panel.aqara_hub_m3_0056_security_system_2';
                        const occState = hass.states[entity]?.state;
                        const securityState = hass.states[securityEntity]?.state;
                        const occupiedStates = ['on', 'detected', 'occupied'];
                        const clearStates = ['off', 'clear', 'standby'];
                        if (clearStates.includes(occState)) {
                          return '#43a047';
                        }
                        if (occupiedStates.includes(occState) && securityState === 'armed_away') {
                          return '#e53935';
                        }
                        if (occupiedStates.includes(occState)) {
                          return '#1e88e5';
                        }
                        if (occState === 'unavailable') {
                          return 'rgba(120, 120, 120, 0.6)';
                        }
                        return '#546e7a';
                      })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--occupancy-color) !important;
                  }
                card_mod:
                  style: >
                    :host {
                      width: auto;
                      max-width: 150px;
                      flex: 0 0 auto;
                      margin-bottom: 10px !important;
                      --bubble-icon-color: white;          # primary icon color
                      --bubble-icon-color-active: white;   # when entity is "on"
                      --bubble-icon-color-disabled: white;    # when unavailable
                    }

                    .bubble-main-icon-container {
                      background: none !important;
                      box-shadow: none !important;
                      padding: 0 !important;
                      width: auto !important;
                      height: auto !important;
                      pointer-events: none !important;
                    }

                    .bubble-main-icon-container ha-icon {
                      width: 24px;   /* or any size you need */
                      height: 24px;
                      color: white !important;
                    }

                    .bubble-main-icon-container ha-ripple,

                    .bubble-main-icon-container .bubble-icon-feedback-container
                    {
                      display: none !important;   /* remove ripple/feedback layers */
                    }
        column_span: 4
      - type: grid
        cards:
          - type: vertical-stack
            grid_options:
              columns: full
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#lights-master-bathroom'
                button_type: name
                show_icon: false
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                  .bubble-pop-up-background {
                    background-color: rgba(25, 36, 54, 0.55) !important;
                    filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.18);
                    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.15),
                        0 15px 40px rgba(0, 0, 0, 0.35);
                  }
              - type: custom:bubble-card
                card_type: separator
                name: Master Bathroom Light
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button:
                  - entity: light.aqara_dimmer_switch_h2
                    tap_action:
                      action: toggle
                    icon: mdi:lightbulb
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.aqara_dimmer_switch_h2
                    name: Master Bathroom Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }

                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                columns: 2
          - type: vertical-stack
            grid_options:
              columns: full
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#climate-master-bathroom'
                button_type: name
                show_icon: false
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                  .bubble-pop-up-background {
                    background-color: rgba(25, 36, 54, 0.55) !important;
                    filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.18);
                    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.15),
                        0 15px 40px rgba(0, 0, 0, 0.35);
                  }
              - type: custom:bubble-card
                card_type: separator
                name: Master Bathroom Climate
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button: []
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.master_bathroom_presense_sensor_temperature
                    name: Master Bathroom
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.master_bathroom_presence_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.master_bathroom_temperature
                    name: Ecobee
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --climate-color: ${(() => {
                          const color = hass.states['input_text.master_bathroom_ecobee_climate_color']?.state?.trim();
                          return color && color !== 'unknown' ? color : 'rgba(128, 128, 128, 0.5)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--climate-color) !important;
                      }


                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                    tap_action:
                      action: none
                    button_action:
                      tap_action:
                        action: none
                columns: 2
        column_span: 4
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: separator
            name: Climate
            card_layout: large
            rows: '01'
            grid_options:
              columns: full
            sub_button: []
          - type: custom:bubble-card
            card_type: button
            button_type: switch
            entity: cover.master_bathroom_vent_vent
            icon: mdi:air-filter
            tap_action:
              action: perform-action
              perform_action: cover.toggle_cover_tilt
              target:
                entity_id: cover.master_bathroom_vent_vent
              data: {}
            button_action:
              tap_action:
                action: perform-action
                perform_action: cover.toggle_cover_tilt
                target:
                  entity_id: cover.master_bathroom_vent_vent
                data: {}
            grid_options:
              columns: 6
              rows: auto
            name: Vent
            show_state: true
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-main-icon-container {
                background: none !important;
                box-shadow: none !important;
                padding: 0 !important;
                width: auto !important;
                height: auto !important;
                pointer-events: none !important;
              }
          - type: custom:bubble-card
            card_type: button
            button_type: switch
            entity: light.aqara_light_switch_h2_us_18
            icon: mdi:fan
            tap_action:
              action: toggle
            button_action:
              tap_action:
                action: toggle
            grid_options:
              columns: 6
              rows: auto
            name: Fan
            show_state: true
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              :host {
                --lights-color: ${(() => {
                  const light = hass.states[entity];
                  if (!light) {
                    return 'rgba(255, 255, 255, 0.35)';
                  }
                  const state = light.state;
                  if (state === 'off') {
                    return '#1e88e5';
                  }
                  if (state === 'unavailable') {
                    return 'rgba(120, 120, 120, 0.6)';
                  }
                  const attrs = light.attributes || {};
                  const rgb = attrs.rgb_color;
                  if (Array.isArray(rgb) && rgb.length === 3) {
                    const [r, g, b] = rgb;
                    return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                  }
                  const hs = attrs.hs_color;
                  if (Array.isArray(hs) && hs.length === 2) {
                    const hue = hs[0];
                    const sat = (hs[1] || 0) / 100;
                    const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                    const c = brightness * sat;
                    const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                    const m = brightness - c;
                    let r1 = 0;
                    let g1 = 0;
                    let b1 = 0;
                    if (hue >= 0 && hue < 60) {
                      r1 = c;
                      g1 = x;
                    } else if (hue < 120) {
                      r1 = x;
                      g1 = c;
                    } else if (hue < 180) {
                      g1 = c;
                      b1 = x;
                    } else if (hue < 240) {
                      g1 = x;
                      b1 = c;
                    } else if (hue < 300) {
                      r1 = x;
                      b1 = c;
                    } else {
                      r1 = c;
                      b1 = x;
                    }
                    const r = Math.round((r1 + m) * 255);
                    const g = Math.round((g1 + m) * 255);
                    const b = Math.round((b1 + m) * 255);
                    return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                  }
                  const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                  if (temp) {
                    const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                    const kelvin = clamp(temp, 2000, 6500);
                    const t = kelvin / 100;
                    let r;
                    let g;
                    let b;
                    if (t <= 66) {
                      r = 255;
                      g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                    } else {
                      r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                      g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                    }
                    if (t >= 66) {
                      b = 255;
                    } else if (t <= 19) {
                      b = 0;
                    } else {
                      b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                    }
                    return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                  }
                  return 'rgba(255, 255, 255, 0.35)';
                })()};
              }
              .bubble-background,
              .bubble-icon-container {
                background: var(--lights-color) !important;
              }
                                .bubble-main-icon-container {
                                  background: none !important;
                                  box-shadow: none !important;
                                  padding: 0 !important;
                                  width: auto !important;
                                  height: auto !important;
                                  pointer-events: none !important;
                                }
          - type: custom:bubble-card
            card_type: button
            button_type: switch
            entity: light.aqara_light_switch_h2_us_17
            icon: mdi:heat-wave
            tap_action:
              action: toggle
            button_action:
              tap_action:
                action: toggle
            grid_options:
              columns: 6
              rows: auto
            name: Towel Rack
            show_state: true
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              :host {
                --lights-color: ${(() => {
                  const light = hass.states[entity];
                  if (!light) {
                    return 'rgba(255, 255, 255, 0.35)';
                  }
                  const state = light.state;
                  if (state === 'off') {
                    return '#1e88e5';
                  }
                  if (state === 'unavailable') {
                    return 'rgba(120, 120, 120, 0.6)';
                  }
                  const attrs = light.attributes || {};
                  const rgb = attrs.rgb_color;
                  if (Array.isArray(rgb) && rgb.length === 3) {
                    const [r, g, b] = rgb;
                    return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                  }
                  const hs = attrs.hs_color;
                  if (Array.isArray(hs) && hs.length === 2) {
                    const hue = hs[0];
                    const sat = (hs[1] || 0) / 100;
                    const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                    const c = brightness * sat;
                    const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                    const m = brightness - c;
                    let r1 = 0;
                    let g1 = 0;
                    let b1 = 0;
                    if (hue >= 0 && hue < 60) {
                      r1 = c;
                      g1 = x;
                    } else if (hue < 120) {
                      r1 = x;
                      g1 = c;
                    } else if (hue < 180) {
                      g1 = c;
                      b1 = x;
                    } else if (hue < 240) {
                      g1 = x;
                      b1 = c;
                    } else if (hue < 300) {
                      r1 = x;
                      b1 = c;
                    } else {
                      r1 = c;
                      b1 = x;
                    }
                    const r = Math.round((r1 + m) * 255);
                    const g = Math.round((g1 + m) * 255);
                    const b = Math.round((b1 + m) * 255);
                    return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                  }
                  const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                  if (temp) {
                    const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                    const kelvin = clamp(temp, 2000, 6500);
                    const t = kelvin / 100;
                    let r;
                    let g;
                    let b;
                    if (t <= 66) {
                      r = 255;
                      g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                    } else {
                      r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                      g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                    }
                    if (t >= 66) {
                      b = 255;
                    } else if (t <= 19) {
                      b = 0;
                    } else {
                      b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                    }
                    return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                  }
                  return 'rgba(255, 255, 255, 0.35)';
                })()};
              }
              .bubble-background,
              .bubble-icon-container {
                background: var(--lights-color) !important;
              }
                                .bubble-main-icon-container {
                                  background: none !important;
                                  box-shadow: none !important;
                                  padding: 0 !important;
                                  width: auto !important;
                                  height: auto !important;
                                  pointer-events: none !important;
                                }
        column_span: 4
      - type: grid
        cards:
          - type: custom:navbar-card
            layout:
              mobile:
                mode: floating
                show_labels: false
              desktop:
                position: bottom
                show_labels: true
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .navbar-card.mobile {
                padding-bottom: calc(env(safe-area-inset-bottom, 0px));
              }
                          :host {
                            --navbar-background-color: rgba(25, 36, 54, 0.55);
                            --navbar-box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-desktop: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-mobile-floating: 0 24px 55px rgba(0, 0, 0, 0.55);
                          }
                          .navbar-card,
                          .navbar-card.desktop,
                          .navbar-card.mobile,
                          .navbar-card.desktop.bottom,
                          .navbar-card.desktop.top,
                          .navbar-card.desktop.left,
                          .navbar-card.desktop.right,
                          .navbar-card.mobile.floating,
                          ha-card.navbar-card {
                            background: rgba(25, 36, 54, 0.55) !important;
                            border: 1px solid rgba(255, 255, 255, 0.18) !important;
                            backdrop-filter: blur(20px);
                            -webkit-backdrop-filter: blur(20px);
                            box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45) !important;
                          }
            routes:
              - url: /at-a-glance/overview
                icon: mdi:home
                label: Home
                selected: |
                  [[[
                    const path = (location && location.pathname) || '';
                    const direct = ['/at-a-glance/security', '/at-a-glance/shopping-list', '/at-a-glance/chores'];
                    return !direct.some(prefix => path.startsWith(prefix));
                  ]]]
              - url: /at-a-glance/security
                icon: mdi:shield
                label: Security
              - url: /at-a-glance/shopping-list
                icon: mdi:shopping
                label: Shopping List
              - icon: mdi:dots-horizontal
                label: More
                tap_action:
                  action: open-popup
                popup:
                  - icon: mdi:cog
                    url: /config/dashboard
                  - icon: mdi:hammer
                    url: /developer-tools/yaml
                  - icon: mdi:power
                    tap_action:
                      action: call-service
                      service: homeassistant.restart
                      service_data: {}
                      confirmation:
                        text: Are you sure you want to restart Home Assistant?
            media_player: {}
            desktop: {}
    cards: []
  - title: Mach-E
    path: mach-e
    type: sections
    style: |
      :host {
        --view-padding: 0 16px !important;   /* left/right margin */
        --lovelace-view-margin: 0 16px !important;  /* fallback for older builds */
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
      }
      bubble-card {
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
        --bubble-icon-opacity: 1 !important;
        --bubble-icon-opacity-active: 1 !important;
        --bubble-icon-opacity-disabled: 1 !important;
      }
      bubble-card .bubble-icon,
      bubble-card .bubble-main-icon-container,
      bubble-card .bubble-main-icon-container ha-icon,
      bubble-card ha-icon,
      bubble-card .is-off .bubble-main-icon,
      bubble-card .is-off .bubble-main-icon-container,
      bubble-card .is-off ha-icon {
        color: white !important;
        fill: white !important;
        opacity: 1 !important;
        filter: none !important;
      }
      bubble-card .is-off .bubble-background,
      bubble-card .is-off .bubble-icon-container {
        background: rgba(255, 255, 255, 0.35) !important;
      }
      hui-view-header,
      hui-section-heading-row,
      hui-section-heading-tile {
        display: none !important;
      }
    sections:
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: button
            button_type: name
            show_name: false
            show_state: false
            show_icon: true
            icon: mdi:chevron-left
            tap_action:
              action: fire-dom-event
              browser_mod:
                service: browser_mod.javascript
                data:
                  code: history.back()
            button_action:
              tap_action:
                action: fire-dom-event
                browser_mod:
                  service: browser_mod.javascript
                  data:
                    code: history.back()
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .bubble-icon,
              .bubble-main-icon,
              .bubble-main-icon-container ha-icon {
                color: white !important;
                opacity: 1 !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-button-card-container {
                display: flex !important;
                align-items: center !important;
                justify-content: flex-start !important;
                padding: 0 !important;
                border: 0 !important;
                background: transparent !important;
                box-shadow: none !important;
                cursor: pointer;
                margin-left: -16px !important;
              }
              .bubble-button-card-container:hover,
              .bubble-button-card-container:focus,
              .bubble-button-card-container:active {
                background: transparent !important;
                box-shadow: none !important;
                filter: none !important;
              }


              .bubble-icon-container {
                background: transparent !important;
                box-shadow: none !important;
              }

              .bubble-icon {
                --mdc-icon-size: 36px !important;
                padding: 0 !important;
              }
            grid_options:
              columns: 2
              rows: auto
          - type: markdown
            content: '# Mach-E'
            text_only: true
            grid_options:
              columns: 3
              rows: 1.25
            card_mod:
              style: |
                ha-card {
                  display: flex;
                  align-items: center;
                  justify-content: flex-end;   /* vertical */
                  padding-bottom: 0;           /* optional */
                  --card-mod-script: |
                    if (window.__bubbleForceWhiteInit) {
                      return;
                    }
                    window.__bubbleForceWhiteInit = true;
                    const styleId = 'bubble-force-white-style';
                    const cssLines = [
                      '.bubble-icon,',
                      '.bubble-main-icon,',
                      '.bubble-main-icon-container,',
                      '.bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.is-off .bubble-icon,',
                      '.is-off .bubble-main-icon,',
                      '.is-off .bubble-main-icon-container,',
                      '.is-off .bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.ha-markdown-element {',
                      '  color: white !important',
                      '}',
                    ];
                    const css = cssLines.join('\n');
                    const touchIcons = (root) => {
                      if (!root) {
                        return;
                      }
                      root.querySelectorAll('.bubble-icon, .bubble-main-icon, .bubble-main-icon-container ha-icon').forEach((icon) => {
                        icon.style.setProperty('color', 'white', 'important');
                        icon.style.setProperty('fill', 'white', 'important');
                        icon.style.setProperty('opacity', '1', 'important');
                        icon.style.removeProperty('filter');
                      });
                    };
                    const applyStyles = (card) => {
                      if (!card) {
                        return;
                      }
                      const root = card.shadowRoot || card;
                      if (!root) {
                        return;
                      }
                      if (!root.getElementById(styleId)) {
                        const style = document.createElement('style');
                        style.id = styleId;
                        style.textContent = css;
                        root.appendChild(style);
                      }
                      touchIcons(root);
                    };
                    const registeredRoots = new Set();
                    const registerRoot = (root) => {
                      if (
                        root &&
                        typeof root.querySelectorAll === 'function' &&
                        !registeredRoots.has(root)
                      ) {
                        registeredRoots.add(root);
                      }
                    };
                    const scan = () => {
                      registeredRoots.forEach((root) => {
                        root.querySelectorAll('bubble-card').forEach(applyStyles);
                        root.querySelectorAll('*').forEach((el) => {
                          if (el.shadowRoot) {
                            registerRoot(el.shadowRoot);
                          }
                        });
                      });
                    };
                    registerRoot(document);
                    registerRoot(document.body);
                    registerRoot(document.documentElement);
                    scan();
                    window.__bubbleForceWhiteInterval = window.setInterval(() => {
                      scan();
                    }, 750);
                }
                ha-markdown {
                  width: 100%;
                  margin: 0;
                   color: white !important;
                }
          - type: custom:swipe-card
            grid_options:
              columns: full
              rows: 1
            parameters:
              slidesPerView: auto
              spaceBetween: 12
              freeMode: true
              freeModeSticky: false
              mousewheel: true
            style: |
              margin-bottom: 10px !important;
            cards:
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: light.downstairs_hallway
                name: Charge
                show_state: true
                icon: mdi:lightbulb
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    --lights-color: ${(() => {
                      const light = hass.states[entity];
                      if (!light) {
                        return 'rgba(255, 255, 255, 0.35)';
                      }
                      const state = light.state;
                      if (state === 'off') {
                        return '#1e88e5';
                      }
                      if (state === 'unavailable') {
                        return 'rgba(120, 120, 120, 0.6)';
                      }
                      const attrs = light.attributes || {};
                      const rgb = attrs.rgb_color;
                      if (Array.isArray(rgb) && rgb.length === 3) {
                        const [r, g, b] = rgb;
                        return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                      }
                      const hs = attrs.hs_color;
                      if (Array.isArray(hs) && hs.length === 2) {
                        const hue = hs[0];
                        const sat = (hs[1] || 0) / 100;
                        const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                        const c = brightness * sat;
                        const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                        const m = brightness - c;
                        let r1 = 0;
                        let g1 = 0;
                        let b1 = 0;
                        if (hue >= 0 && hue < 60) {
                          r1 = c;
                          g1 = x;
                        } else if (hue < 120) {
                          r1 = x;
                          g1 = c;
                        } else if (hue < 180) {
                          g1 = c;
                          b1 = x;
                        } else if (hue < 240) {
                          g1 = x;
                          b1 = c;
                        } else if (hue < 300) {
                          r1 = x;
                          b1 = c;
                        } else {
                          r1 = c;
                          b1 = x;
                        }
                        const r = Math.round((r1 + m) * 255);
                        const g = Math.round((g1 + m) * 255);
                        const b = Math.round((b1 + m) * 255);
                        return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                      }
                      const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                      if (temp) {
                        const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                        const kelvin = clamp(temp, 2000, 6500);
                        const t = kelvin / 100;
                        let r;
                        let g;
                        let b;
                        if (t <= 66) {
                          r = 255;
                          g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                        } else {
                          r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                          g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                        }
                        if (t >= 66) {
                          b = 255;
                        } else if (t <= 19) {
                          b = 0;
                        } else {
                          b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                        }
                        return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                      }
                      return 'rgba(255, 255, 255, 0.35)';
                    })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--lights-color) !important;
                  }
                card_mod:
                  style: >
                    :host {
                      width: auto;
                      max-width: 130px;
                      flex: 0 0 auto;
                      margin-bottom: 10px !important;
                      --bubble-icon-color: white;          # primary icon color
                      --bubble-icon-color-active: white;   # when entity is "on"
                      --bubble-icon-color-disabled: white;
                      --bubble-button-spacing: 0px;   /* no gap between icon and text */
                    }

                    .bubble-main-icon-container {
                      background: none !important;
                      box-shadow: none !important;
                      padding: 0 !important;
                      width: auto !important;
                      height: auto !important;
                      pointer-events: none !important;
                    }

                    .bubble-main-icon-container ha-icon {
                      width: 24px;   /* or any size you need */
                      height: 24px;
                      color: white !important;
                    }

                    .bubble-main-icon-container ha-ripple,

                    .bubble-main-icon-container .bubble-icon-feedback-container
                    {
                      display: none !important;   /* remove ripple/feedback layers */
                    }
          - type: custom:bubble-card
            card_type: button
            button_type: switch
            entity: sensor.fordpass_3fmtk3su5mma09266_elvehcharging
            name: Charge Status
            show_state: false
            show_attribute: false
            styles: >-
              .bubble-main-icon {
                color: white !important;
              } .is-off .bubble-background, .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              } .is-off .bubble-main-icon {
                opacity: 1 !important;
              } .bubble-name, .bubble_name {
                color: white !important;
              } .bubble-state {
                color: white !important;
                opacity: 1 !important;
              } ${card.querySelector('.bubble-state').innerText = + " degC - " +
              + " %"}
        column_span: 4
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: separator
            name: Car Controls
            card_layout: large
            rows: '01'
            grid_options:
              columns: full
          - type: custom:bubble-card
            card_type: button
            button_type: switch
            entity: lock.fordpass_3fmtk3su5mma09266_doorlock
            name: Doors
            show_state: true
            grid_options:
              columns: 6
              rows: auto
            tap_action:
              action: toggle
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            button_action: {}
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-main-icon-container {
                background: none !important;
                box-shadow: none !important;
                padding: 0 !important;
                width: auto !important;
                height: auto !important;
                pointer-events: none !important;
              }
          - type: custom:bubble-card
            card_type: button
            button_type: switch
            entity: select.fordpass_3fmtk3su5mma09266_rccseatfrontleft
            name: Driver's Seat
            show_state: true
            show_attribute: false
            attribute: friendly_name
            tap_action:
              action: none
            button_action:
              tap_action:
                action: none
            sub_button:
              - entity: select.fordpass_3fmtk3su5mma09266_rccseatfrontleft
                show_icon: true
            show_icon: false
            grid_options:
              columns: 6
              rows: auto
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
          - type: custom:bubble-card
            card_type: button
            button_type: switch
            entity: select.fordpass_3fmtk3su5mma09266_rccseatfrontright
            name: Passenger Seat
            show_state: true
            show_attribute: false
            attribute: friendly_name
            tap_action:
              action: none
            button_action:
              tap_action:
                action: none
            sub_button:
              - entity: select.fordpass_3fmtk3su5mma09266_rccseatfrontright
                show_icon: true
            show_icon: false
            grid_options:
              columns: 6
              rows: auto
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
          - type: custom:bubble-card
            card_type: button
            button_type: slider
            entity: number.fordpass_3fmtk3su5mma09266_rcctemperature
            name: Climate
            show_state: true
            modules:
              - frosted_glass
            frosted_glass:
              main_shadow: none
              icon_shadow: none
              blur: 15px
              opacity: 0.6
              border: vision
              icon_background: rgba(255, 255, 255, 0.5)
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-main-icon-container {
                background: none !important;
                box-shadow: none !important;
                padding: 0 !important;
                width: auto !important;
                height: auto !important;
                pointer-events: none !important;
              }
        column_span: 4
      - type: grid
        cards:
          - type: custom:navbar-card
            layout:
              mobile:
                mode: floating
                show_labels: false
              desktop:
                position: bottom
                show_labels: true
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .navbar-card.mobile {
                padding-bottom: calc(env(safe-area-inset-bottom, 0px));
              }
                          :host {
                            --navbar-background-color: rgba(25, 36, 54, 0.55);
                            --navbar-box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-desktop: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-mobile-floating: 0 24px 55px rgba(0, 0, 0, 0.55);
                          }
                          .navbar-card,
                          .navbar-card.desktop,
                          .navbar-card.mobile,
                          .navbar-card.desktop.bottom,
                          .navbar-card.desktop.top,
                          .navbar-card.desktop.left,
                          .navbar-card.desktop.right,
                          .navbar-card.mobile.floating,
                          ha-card.navbar-card {
                            background: rgba(25, 36, 54, 0.55) !important;
                            border: 1px solid rgba(255, 255, 255, 0.18) !important;
                            backdrop-filter: blur(20px);
                            -webkit-backdrop-filter: blur(20px);
                            box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45) !important;
                          }
            routes:
              - url: /at-a-glance/overview
                icon: mdi:home
                label: Home
                selected: |
                  [[[
                    const path = (location && location.pathname) || '';
                    const direct = ['/at-a-glance/security', '/at-a-glance/shopping-list', '/at-a-glance/chores'];
                    return !direct.some(prefix => path.startsWith(prefix));
                  ]]]
              - url: /at-a-glance/security
                icon: mdi:shield
                label: Security
              - url: /at-a-glance/shopping-list
                icon: mdi:shopping
                label: Shopping List
              - icon: mdi:dots-horizontal
                label: More
                tap_action:
                  action: open-popup
                popup:
                  - icon: mdi:cog
                    url: /config/dashboard
                  - icon: mdi:hammer
                    url: /developer-tools/yaml
                  - icon: mdi:power
                    tap_action:
                      action: call-service
                      service: homeassistant.restart
                      service_data: {}
                      confirmation:
                        text: Are you sure you want to restart Home Assistant?
            media_player: {}
            desktop: {}
    cards: []
  - title: Entryway
    path: entryway
    type: sections
    style: |
      :host {
        --view-padding: 0 16px !important;
        --lovelace-view-margin: 0 16px !important;
        position: relative;
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
      }
      bubble-card {
        --bubble-icon-color: white !important;
        --bubble-icon-color-active: white !important;
        --bubble-icon-color-disabled: white !important;
        --bubble-icon-opacity: 1 !important;
        --bubble-icon-opacity-active: 1 !important;
        --bubble-icon-opacity-disabled: 1 !important;
      }
      bubble-card .bubble-icon,
      bubble-card .bubble-main-icon-container,
      bubble-card .bubble-main-icon-container ha-icon,
      bubble-card ha-icon,
      bubble-card .is-off .bubble-main-icon,
      bubble-card .is-off .bubble-main-icon-container,
      bubble-card .is-off ha-icon {
        color: white !important;
        fill: white !important;
        opacity: 1 !important;
        filter: none !important;
      }
      bubble-card .is-off .bubble-background,
      bubble-card .is-off .bubble-icon-container {
        background: rgba(255, 255, 255, 0.35) !important;
      }
      :host::before {
        content: "";
        position: fixed;
        inset: 0;
        background-image: url("media-source://image_upload/b9449f15a0e0c05ad7c84ebd806b883c");
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
        filter: blur(18px) saturate(140%);
        transform: scale(1.05);     /* avoids clipping after blur */
        z-index: -2;
      }
      :host::after {
        content: "";
        position: fixed;
        inset: 0;
        background: rgba(12, 18, 28, 0.35);  /* frosted tint */
        backdrop-filter: blur(8px);
        z-index: -1;
      }
      hui-view-header,
      hui-section-heading-row,
      hui-section-heading-tile {
        display: none !important;
      }
    sections:
      - type: grid
        cards:
          - type: custom:bubble-card
            card_type: button
            button_type: name
            show_name: false
            show_state: false
            show_icon: true
            icon: mdi:chevron-left
            tap_action:
              action: fire-dom-event
              browser_mod:
                service: browser_mod.javascript
                data:
                  code: history.back()
            button_action:
              tap_action:
                action: fire-dom-event
                browser_mod:
                  service: browser_mod.javascript
                  data:
                    code: history.back()
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .bubble-icon,
              .bubble-main-icon,
              .bubble-main-icon-container ha-icon {
                color: white !important;
                opacity: 1 !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .bubble-button-card-container {
                display: flex !important;
                align-items: center !important;
                justify-content: flex-start !important;
                padding: 0 !important;
                border: 0 !important;
                background: transparent !important;
                box-shadow: none !important;
                cursor: pointer;
                margin-left: -16px !important;
              }
              .bubble-button-card-container:hover,
              .bubble-button-card-container:focus,
              .bubble-button-card-container:active {
                background: transparent !important;
                box-shadow: none !important;
                filter: none !important;
              }


              .bubble-icon-container {
                background: transparent !important;
                box-shadow: none !important;
              }

              .bubble-icon {
                --mdc-icon-size: 36px !important;
                padding: 0 !important;
              }
            grid_options:
              columns: 2
              rows: auto
          - type: markdown
            content: '# Entryway'
            text_only: true
            grid_options:
              columns: 6
              rows: auto
            card_mod:
              style: |
                ha-card {
                  display: flex;
                  align-items: center;   # vertical center
                  justify-content: center;  # optional horizontal center
                  height: 100%;
                  padding: 0;
                  margin-left: -32px !important;
                  --card-mod-script: |
                    if (window.__bubbleForceWhiteInit) {
                      return;
                    }
                    window.__bubbleForceWhiteInit = true;
                    const styleId = 'bubble-force-white-style';
                    const cssLines = [
                      '.bubble-icon,',
                      '.bubble-main-icon,',
                      '.bubble-main-icon-container,',
                      '.bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.is-off .bubble-icon,',
                      '.is-off .bubble-main-icon,',
                      '.is-off .bubble-main-icon-container,',
                      '.is-off .bubble-main-icon-container ha-icon {',
                      '  color: white !important;',
                      '  fill: white !important;',
                      '  filter: none !important;',
                      '  opacity: 1 !important;',
                      '}',
                      '.ha-markdown-element {',
                      '  color: white !important',
                      '}',
                    ];
                    const css = cssLines.join('\n');
                    const touchIcons = (root) => {
                      if (!root) {
                        return;
                      }
                      root.querySelectorAll('.bubble-icon, .bubble-main-icon, .bubble-main-icon-container ha-icon').forEach((icon) => {
                        icon.style.setProperty('color', 'white', 'important');
                        icon.style.setProperty('fill', 'white', 'important');
                        icon.style.setProperty('opacity', '1', 'important');
                        icon.style.removeProperty('filter');
                      });
                    };
                    const applyStyles = (card) => {
                      if (!card) {
                        return;
                      }
                      const root = card.shadowRoot || card;
                      if (!root) {
                        return;
                      }
                      if (!root.getElementById(styleId)) {
                        const style = document.createElement('style');
                        style.id = styleId;
                        style.textContent = css;
                        root.appendChild(style);
                      }
                      touchIcons(root);
                    };
                    const registeredRoots = new Set();
                    const registerRoot = (root) => {
                      if (
                        root &&
                        typeof root.querySelectorAll === 'function' &&
                        !registeredRoots.has(root)
                      ) {
                        registeredRoots.add(root);
                      }
                    };
                    const scan = () => {
                      registeredRoots.forEach((root) => {
                        root.querySelectorAll('bubble-card').forEach(applyStyles);
                        root.querySelectorAll('*').forEach((el) => {
                          if (el.shadowRoot) {
                            registerRoot(el.shadowRoot);
                          }
                        });
                      });
                    };
                    registerRoot(document);
                    registerRoot(document.body);
                    registerRoot(document.documentElement);
                    scan();
                    window.__bubbleForceWhiteInterval = window.setInterval(() => {
                      scan();
                    }, 750);
                }
                ha-markdown {
                  margin: 0;
                  width: 100%;
                  text-align: center;    # drop if you only want vertical centering
                   color: white !important;
                }
          - type: custom:swipe-card
            grid_options:
              columns: full
              rows: 1
            parameters:
              slidesPerView: auto
              spaceBetween: 12
              freeMode: true
              freeModeSticky: false
              mousewheel: true
            style: |
              margin-bottom: 10px !important;
            cards:
              - type: custom:bubble-card
                card_type: button
                button_type: switch
                entity: light.aqara_light_switch_h2_us_9
                name: Light
                show_state: true
                icon: mdi:lightbulb
                modules:
                  - frosted_glass
                frosted_glass:
                  main_shadow: none
                  icon_shadow: none
                  blur: 15px
                  opacity: 0.6
                  border: bubble
                  icon_background: rgba(255, 255, 255, 0.5)
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  :host {
                    --lights-color: ${(() => {
                      const light = hass.states[entity];
                      if (!light) {
                        return 'rgba(255, 255, 255, 0.35)';
                      }
                      const state = light.state;
                      if (state === 'off') {
                        return '#1e88e5';
                      }
                      if (state === 'unavailable') {
                        return 'rgba(120, 120, 120, 0.6)';
                      }
                      const attrs = light.attributes || {};
                      const rgb = attrs.rgb_color;
                      if (Array.isArray(rgb) && rgb.length === 3) {
                        const [r, g, b] = rgb;
                        return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                      }
                      const hs = attrs.hs_color;
                      if (Array.isArray(hs) && hs.length === 2) {
                        const hue = hs[0];
                        const sat = (hs[1] || 0) / 100;
                        const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                        const c = brightness * sat;
                        const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                        const m = brightness - c;
                        let r1 = 0;
                        let g1 = 0;
                        let b1 = 0;
                        if (hue >= 0 && hue < 60) {
                          r1 = c;
                          g1 = x;
                        } else if (hue < 120) {
                          r1 = x;
                          g1 = c;
                        } else if (hue < 180) {
                          g1 = c;
                          b1 = x;
                        } else if (hue < 240) {
                          g1 = x;
                          b1 = c;
                        } else if (hue < 300) {
                          r1 = x;
                          b1 = c;
                        } else {
                          r1 = c;
                          b1 = x;
                        }
                        const r = Math.round((r1 + m) * 255);
                        const g = Math.round((g1 + m) * 255);
                        const b = Math.round((b1 + m) * 255);
                        return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                      }
                      const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                      if (temp) {
                        const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                        const kelvin = clamp(temp, 2000, 6500);
                        const t = kelvin / 100;
                        let r;
                        let g;
                        let b;
                        if (t <= 66) {
                          r = 255;
                          g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                        } else {
                          r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                          g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                        }
                        if (t >= 66) {
                          b = 255;
                        } else if (t <= 19) {
                          b = 0;
                        } else {
                          b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                        }
                        return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                      }
                      return 'rgba(255, 255, 255, 0.35)';
                    })()};
                  }
                  .bubble-background,
                  .bubble-icon-container {
                    background: var(--lights-color) !important;
                  }
                tap_action:
                  action: navigate
                  navigation_path: '#lights-entryway'
                button_action:
                  tap_action:
                    action: navigate
                    navigation_path: '#lights-entryway'
                card_mod:
                  style: >
                    :host {
                      width: auto;
                      max-width: 130px;
                      flex: 0 0 auto;
                      margin-bottom: 10px !important;
                      --bubble-icon-color: white;          # primary icon color
                      --bubble-icon-color-active: white;   # when entity is "on"
                      --bubble-icon-color-disabled: white;
                      --bubble-button-spacing: 0px;   /* no gap between icon and text */
                    }

                    .bubble-main-icon-container {
                      background: none !important;
                      box-shadow: none !important;
                      padding: 0 !important;
                      width: auto !important;
                      height: auto !important;
                      pointer-events: none !important;
                    }

                    .bubble-main-icon-container ha-icon {
                      width: 24px;   /* or any size you need */
                      height: 24px;
                      color: white !important;
                    }

                    .bubble-main-icon-container ha-ripple,

                    .bubble-main-icon-container .bubble-icon-feedback-container
                    {
                      display: none !important;   /* remove ripple/feedback layers */
                    }
        column_span: 4
      - type: grid
        cards:
          - type: vertical-stack
            grid_options:
              columns: full
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#lights-entryway'
                button_type: name
                show_icon: false
                styles: |
                  .bubble-main-icon {
                    color: white !important;
                  }
                  .is-off .bubble-background,
                  .is-unavailable .bubble-background {
                    background: rgba(255, 255, 255, 0.35) !important;
                  }
                  .is-off .bubble-main-icon {
                    opacity: 1 !important;
                  }
                  .bubble-name,
                  .bubble_name {
                    color: white !important;
                  }
                  .bubble-state {
                    color: white !important;
                    opacity: 1 !important;
                  }
                  .bubble-main-icon-container ha-ripple,
                  .bubble-main-icon-container .bubble-icon-feedback-container {
                    display: none !important;
                  }
                  .bubble-main-icon-container {
                    background: none !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    width: auto !important;
                    height: auto !important;
                    pointer-events: none !important;
                  }
                  .bubble-pop-up-background {
                    background-color: rgba(25, 36, 54, 0.55) !important;
                    filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.18);
                    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.15),
                        0 15px 40px rgba(0, 0, 0, 0.35);
                  }
              - type: custom:bubble-card
                card_type: separator
                name: Entryway Light
                card_layout: large
                rows: '01'
                grid_options:
                  columns: full
                sub_button:
                  - entity: light.downstairs_hallway
                    tap_action:
                      action: toggle
                    icon: mdi:lightbulb
              - square: false
                type: grid
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: slider
                    entity: light.aqara_light_switch_h2_us_9
                    name: Entryway Light
                    card_layout: large
                    grid_options:
                      columns: 6
                      rows: auto
                    modules:
                      - frosted_glass
                    frosted_glass:
                      main_shadow: none
                      icon_shadow: none
                      blur: 15px
                      opacity: 0.6
                      border: bubble
                      icon_background: rgba(255, 255, 255, 0.5)
                    styles: >
                      .bubble-main-icon {
                        color: white !important;
                      } .is-off .bubble-background, .is-unavailable
                      .bubble-background {
                        background: rgba(255, 255, 255, 0.35) !important;
                      } .is-off .bubble-main-icon {
                        opacity: 1 !important;
                      } .bubble-name, .bubble_name {
                        color: white !important;
                      } .bubble-state {
                        color: white !important;
                        opacity: 1 !important;
                      } :host {
                        --lights-color: ${(() => {
                          const light = hass.states[entity];
                          if (!light) {
                            return 'rgba(255, 255, 255, 0.35)';
                          }
                          const state = light.state;
                          if (state === 'off') {
                            return '#1e88e5';
                          }
                          if (state === 'unavailable') {
                            return 'rgba(120, 120, 120, 0.6)';
                          }
                          const attrs = light.attributes || {};
                          const rgb = attrs.rgb_color;
                          if (Array.isArray(rgb) && rgb.length === 3) {
                            const [r, g, b] = rgb;
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const hs = attrs.hs_color;
                          if (Array.isArray(hs) && hs.length === 2) {
                            const hue = hs[0];
                            const sat = (hs[1] || 0) / 100;
                            const brightness = attrs.brightness !== undefined ? attrs.brightness / 255 : 1;
                            const c = brightness * sat;
                            const x = c * (1 - Math.abs(((hue / 60) % 2) - 1));
                            const m = brightness - c;
                            let r1 = 0;
                            let g1 = 0;
                            let b1 = 0;
                            if (hue >= 0 && hue < 60) {
                              r1 = c;
                              g1 = x;
                            } else if (hue < 120) {
                              r1 = x;
                              g1 = c;
                            } else if (hue < 180) {
                              g1 = c;
                              b1 = x;
                            } else if (hue < 240) {
                              g1 = x;
                              b1 = c;
                            } else if (hue < 300) {
                              r1 = x;
                              b1 = c;
                            } else {
                              r1 = c;
                              b1 = x;
                            }
                            const r = Math.round((r1 + m) * 255);
                            const g = Math.round((g1 + m) * 255);
                            const b = Math.round((b1 + m) * 255);
                            return 'rgba(' + r + ', ' + g + ', ' + b + ', 0.9)';
                          }
                          const temp = attrs.color_temp_kelvin || (attrs.color_temp ? 1000000 / attrs.color_temp : null);
                          if (temp) {
                            const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
                            const kelvin = clamp(temp, 2000, 6500);
                            const t = kelvin / 100;
                            let r;
                            let g;
                            let b;
                            if (t <= 66) {
                              r = 255;
                              g = clamp(99.4708025861 * Math.log(t) - 161.1195681661, 0, 255);
                            } else {
                              r = clamp(329.698727446 * Math.pow(t - 60, -0.1332047592), 0, 255);
                              g = clamp(288.1221695283 * Math.pow(t - 60, -0.0755148492), 0, 255);
                            }
                            if (t >= 66) {
                              b = 255;
                            } else if (t <= 19) {
                              b = 0;
                            } else {
                              b = clamp(138.5177312231 * Math.log(t - 10) - 305.0447927307, 0, 255);
                            }
                            return 'rgba(' + Math.round(r) + ', ' + Math.round(g) + ', ' + Math.round(b) + ', 0.9)';
                          }
                          return 'rgba(255, 255, 255, 0.35)';
                        })()};
                      }

                      .bubble-background,

                      .bubble-icon-container {
                        background: var(--lights-color) !important;
                      }

                      .bubble-main-icon-container ha-ripple,

                      .bubble-main-icon-container
                      .bubble-icon-feedback-container {
                        display: none !important;
                      }

                      .bubble-main-icon-container {
                        background: none !important;
                        box-shadow: none !important;
                        padding: 0 !important;
                        width: auto !important;
                        height: auto !important;
                        pointer-events: none !important;
                      }
                columns: 2
        column_span: 4
      - type: grid
        cards:
          - type: custom:navbar-card
            layout:
              mobile:
                mode: floating
                show_labels: false
              desktop:
                position: bottom
                show_labels: true
            styles: |
              .bubble-main-icon {
                color: white !important;
              }
              .is-off .bubble-background,
              .is-unavailable .bubble-background {
                background: rgba(255, 255, 255, 0.35) !important;
              }
              .is-off .bubble-main-icon {
                opacity: 1 !important;
              }
              .bubble-name,
              .bubble_name {
                color: white !important;
              }
              .bubble-state {
                color: white !important;
                opacity: 1 !important;
              }
              .navbar-card.mobile {
                padding-bottom: calc(env(safe-area-inset-bottom, 0px));
              }
                          :host {
                            --navbar-background-color: rgba(25, 36, 54, 0.55);
                            --navbar-box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-desktop: 0 20px 45px rgba(0, 0, 0, 0.45);
                            --navbar-box-shadow-mobile-floating: 0 24px 55px rgba(0, 0, 0, 0.55);
                          }
                          .navbar-card,
                          .navbar-card.desktop,
                          .navbar-card.mobile,
                          .navbar-card.desktop.bottom,
                          .navbar-card.desktop.top,
                          .navbar-card.desktop.left,
                          .navbar-card.desktop.right,
                          .navbar-card.mobile.floating,
                          ha-card.navbar-card {
                            background: rgba(25, 36, 54, 0.55) !important;
                            border: 1px solid rgba(255, 255, 255, 0.18) !important;
                            backdrop-filter: blur(20px);
                            -webkit-backdrop-filter: blur(20px);
                            box-shadow: 0 20px 45px rgba(0, 0, 0, 0.45) !important;
                          }
            routes:
              - url: /at-a-glance/overview
                icon: mdi:home
                label: Home
                selected: |
                  [[[
                    const path = (location && location.pathname) || '';
                    const direct = ['/at-a-glance/security', '/at-a-glance/shopping-list', '/at-a-glance/chores'];
                    return !direct.some(prefix => path.startsWith(prefix));
                  ]]]
              - url: /at-a-glance/security
                icon: mdi:shield
                label: Security
              - url: /at-a-glance/shopping-list
                icon: mdi:shopping
                label: Shopping List
              - icon: mdi:dots-horizontal
                label: More
                tap_action:
                  action: open-popup
                popup:
                  - icon: mdi:cog
                    url: /config/dashboard
                  - icon: mdi:hammer
                    url: /developer-tools/yaml
                  - icon: mdi:power
                    tap_action:
                      action: call-service
                      service: homeassistant.restart
                      service_data: {}
                      confirmation:
                        text: Are you sure you want to restart Home Assistant?
            media_player: {}
            desktop: {}
    cards: []
